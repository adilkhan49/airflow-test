[0m13:29:34.348866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119318590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a547890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a547b10>]}


============================== 13:29:34.351771 | 413312f8-9a97-4024-94cf-8b3c6e408c2c ==============================
[0m13:29:34.351771 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:29:34.352085 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'no_print': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'version_check': 'True', 'profiles_dir': '/Users/adil/.dbt', 'printer_width': '80', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'empty': 'None', 'log_format': 'default', 'debug': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt/dbt_test/logs', 'warn_error': 'None', 'quiet': 'False', 'indirect_selection': 'eager'}
[0m13:29:34.363395 [info ] [MainThread]: dbt version: 1.10.15
[0m13:29:34.363626 [info ] [MainThread]: python version: 3.13.7
[0m13:29:34.363775 [info ] [MainThread]: python path: /Users/adil/repos/airflow-test/.venv/bin/python
[0m13:29:34.363920 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m13:29:34.407072 [info ] [MainThread]: Using profiles dir at /Users/adil/.dbt
[0m13:29:34.407328 [info ] [MainThread]: Using profiles.yml file at /Users/adil/.dbt/profiles.yml
[0m13:29:34.407482 [info ] [MainThread]: Using dbt_project.yml file at /Users/adil/repos/airflow-test/dbt/dbt_test/dbt_project.yml
[0m13:29:34.407858 [info ] [MainThread]: adapter type: postgres
[0m13:29:34.407996 [info ] [MainThread]: adapter version: 1.9.1
[0m13:29:34.455211 [info ] [MainThread]: Configuration:
[0m13:29:34.455484 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:29:34.455643 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:29:34.455791 [info ] [MainThread]: Required dependencies:
[0m13:29:34.455978 [debug] [MainThread]: Executing "git --help"
[0m13:29:34.469962 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:29:34.470584 [debug] [MainThread]: STDERR: "b''"
[0m13:29:34.470783 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:29:34.470950 [info ] [MainThread]: Connection:
[0m13:29:34.471109 [info ] [MainThread]:   host: localhost
[0m13:29:34.471242 [info ] [MainThread]:   port: 5433
[0m13:29:34.471365 [info ] [MainThread]:   user: postgres
[0m13:29:34.471483 [info ] [MainThread]:   database: dbt_test
[0m13:29:34.471610 [info ] [MainThread]:   schema: public
[0m13:29:34.471729 [info ] [MainThread]:   connect_timeout: 10
[0m13:29:34.471850 [info ] [MainThread]:   role: None
[0m13:29:34.471967 [info ] [MainThread]:   search_path: None
[0m13:29:34.472084 [info ] [MainThread]:   keepalives_idle: 0
[0m13:29:34.472203 [info ] [MainThread]:   sslmode: None
[0m13:29:34.472318 [info ] [MainThread]:   sslcert: None
[0m13:29:34.472434 [info ] [MainThread]:   sslkey: None
[0m13:29:34.472548 [info ] [MainThread]:   sslrootcert: None
[0m13:29:34.472665 [info ] [MainThread]:   application_name: dbt
[0m13:29:34.472781 [info ] [MainThread]:   retries: 1
[0m13:29:34.473107 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:29:34.517703 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:29:34.550056 [debug] [MainThread]: Using postgres connection "debug"
[0m13:29:34.550257 [debug] [MainThread]: On debug: select 1 as id
[0m13:29:34.550395 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:34.621977 [debug] [MainThread]: SQL status: SELECT 1 in 0.072 seconds
[0m13:29:34.622638 [debug] [MainThread]: On debug: Close
[0m13:29:34.622853 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:29:34.623101 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:29:34.624935 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.31195804, "process_in_blocks": "0", "process_kernel_time": 0.165238, "process_mem_max_rss": "120864768", "process_out_blocks": "0", "process_user_time": 0.837387}
[0m13:29:34.625301 [debug] [MainThread]: Command `dbt debug` succeeded at 13:29:34.625218 after 0.31 seconds
[0m13:29:34.625508 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:29:34.625715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac9b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2e16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a606ad0>]}
[0m13:29:34.625993 [debug] [MainThread]: Flushing usage events
[0m13:29:35.750332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:09.254233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d48590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107247890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107247b10>]}


============================== 13:46:09.257578 | b0f7fe7e-b37c-407d-9a27-e61ed4a4794f ==============================
[0m13:46:09.257578 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:46:09.257942 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'fail_fast': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'profiles_dir': '/Users/adil/.dbt', 'version_check': 'True', 'debug': 'False', 'empty': 'None', 'printer_width': '80', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'log_cache_events': 'False', 'invocation_command': 'dbt debug --profile profiles.yaml', 'use_colors': 'True'}
[0m13:46:09.270909 [info ] [MainThread]: dbt version: 1.10.15
[0m13:46:09.271128 [info ] [MainThread]: python version: 3.13.7
[0m13:46:09.271273 [info ] [MainThread]: python path: /Users/adil/repos/airflow-test/.venv/bin/python
[0m13:46:09.271408 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m13:46:09.273460 [info ] [MainThread]: Using profiles dir at /Users/adil/.dbt
[0m13:46:09.273675 [info ] [MainThread]: Using profiles.yml file at /Users/adil/.dbt/profiles.yml
[0m13:46:09.273817 [info ] [MainThread]: Using dbt_project.yml file at /Users/adil/repos/airflow-test/dbt_test/dbt_project.yml
[0m13:46:09.320388 [info ] [MainThread]: Configuration:
[0m13:46:09.320627 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m13:46:09.320774 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:46:09.320912 [info ] [MainThread]: Required dependencies:
[0m13:46:09.321085 [debug] [MainThread]: Executing "git --help"
[0m13:46:09.327324 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:46:09.327844 [debug] [MainThread]: STDERR: "b''"
[0m13:46:09.328019 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:46:09.328169 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:46:09.328333 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:46:09.328464 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'profiles.yaml'


[0m13:46:09.329991 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.1145965, "process_in_blocks": "0", "process_kernel_time": 0.115007, "process_mem_max_rss": "107413504", "process_out_blocks": "0", "process_user_time": 0.70649}
[0m13:46:09.330238 [debug] [MainThread]: Command `dbt debug` failed at 13:46:09.330189 after 0.11 seconds
[0m13:46:09.330460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e69e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107410710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fef8a0>]}
[0m13:46:09.330668 [debug] [MainThread]: Flushing usage events
[0m13:46:09.742348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:18.659452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108480590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092af890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092afb10>]}


============================== 13:46:18.662032 | 24dea41e-03b3-4323-8c6f-1c71343ba8af ==============================
[0m13:46:18.662032 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:46:18.662351 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/adil/.dbt', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'use_colors': 'True', 'invocation_command': 'dbt debug --profile profiles.yaml', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'write_json': 'True', 'static_parser': 'True'}
[0m13:46:18.673668 [info ] [MainThread]: dbt version: 1.10.15
[0m13:46:18.673920 [info ] [MainThread]: python version: 3.13.7
[0m13:46:18.674066 [info ] [MainThread]: python path: /Users/adil/repos/airflow-test/.venv/bin/python
[0m13:46:18.674208 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m13:46:18.675961 [info ] [MainThread]: Using profiles dir at /Users/adil/.dbt
[0m13:46:18.676124 [info ] [MainThread]: Using profiles.yml file at /Users/adil/.dbt/profiles.yml
[0m13:46:18.676259 [info ] [MainThread]: Using dbt_project.yml file at /Users/adil/repos/airflow-test/dbt_test/dbt_project.yml
[0m13:46:18.722611 [info ] [MainThread]: Configuration:
[0m13:46:18.722867 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m13:46:18.723022 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:46:18.723163 [info ] [MainThread]: Required dependencies:
[0m13:46:18.723340 [debug] [MainThread]: Executing "git --help"
[0m13:46:18.734284 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:46:18.734766 [debug] [MainThread]: STDERR: "b''"
[0m13:46:18.734948 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:46:18.735110 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:46:18.735257 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:46:18.735392 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'profiles.yaml'


[0m13:46:18.736960 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.11097763, "process_in_blocks": "0", "process_kernel_time": 0.093169, "process_mem_max_rss": "107282432", "process_out_blocks": "0", "process_user_time": 0.686268}
[0m13:46:18.737257 [debug] [MainThread]: Command `dbt debug` failed at 13:46:18.737199 after 0.11 seconds
[0m13:46:18.737613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a1e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109478710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10915b8a0>]}
[0m13:46:18.737890 [debug] [MainThread]: Flushing usage events
[0m13:46:19.175805 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:19.735802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f18590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113247890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113247b10>]}


============================== 13:48:19.738879 | 6cb439c5-9338-4a10-8283-6dbe1717ad42 ==============================
[0m13:48:19.738879 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:48:19.739217 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'quiet': 'False', 'invocation_command': 'dbt debug', 'empty': 'None', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/adil/.dbt', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'version_check': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True'}
[0m13:48:19.751712 [info ] [MainThread]: dbt version: 1.10.15
[0m13:48:19.751929 [info ] [MainThread]: python version: 3.13.7
[0m13:48:19.752070 [info ] [MainThread]: python path: /Users/adil/repos/airflow-test/.venv/bin/python
[0m13:48:19.752203 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m13:48:19.807873 [info ] [MainThread]: Using profiles dir at /Users/adil/.dbt
[0m13:48:19.808140 [info ] [MainThread]: Using profiles.yml file at /Users/adil/.dbt/profiles.yml
[0m13:48:19.808288 [info ] [MainThread]: Using dbt_project.yml file at /Users/adil/repos/airflow-test/dbt_test/dbt_project.yml
[0m13:48:19.808685 [info ] [MainThread]: adapter type: postgres
[0m13:48:19.808863 [info ] [MainThread]: adapter version: 1.9.1
[0m13:48:19.855608 [info ] [MainThread]: Configuration:
[0m13:48:19.855839 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:48:19.855987 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:48:19.856124 [info ] [MainThread]: Required dependencies:
[0m13:48:19.856301 [debug] [MainThread]: Executing "git --help"
[0m13:48:19.868728 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:48:19.869192 [debug] [MainThread]: STDERR: "b''"
[0m13:48:19.869358 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:48:19.869598 [info ] [MainThread]: Connection:
[0m13:48:19.869788 [info ] [MainThread]:   host: localhost
[0m13:48:19.869928 [info ] [MainThread]:   port: 5433
[0m13:48:19.870056 [info ] [MainThread]:   user: postgres
[0m13:48:19.870179 [info ] [MainThread]:   database: dbt_test
[0m13:48:19.870301 [info ] [MainThread]:   schema: public
[0m13:48:19.870423 [info ] [MainThread]:   connect_timeout: 10
[0m13:48:19.870549 [info ] [MainThread]:   role: None
[0m13:48:19.870671 [info ] [MainThread]:   search_path: None
[0m13:48:19.870788 [info ] [MainThread]:   keepalives_idle: 0
[0m13:48:19.870906 [info ] [MainThread]:   sslmode: None
[0m13:48:19.871023 [info ] [MainThread]:   sslcert: None
[0m13:48:19.871142 [info ] [MainThread]:   sslkey: None
[0m13:48:19.871258 [info ] [MainThread]:   sslrootcert: None
[0m13:48:19.871373 [info ] [MainThread]:   application_name: dbt
[0m13:48:19.871491 [info ] [MainThread]:   retries: 1
[0m13:48:19.871848 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:48:19.917646 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:48:19.954740 [debug] [MainThread]: Using postgres connection "debug"
[0m13:48:19.954981 [debug] [MainThread]: On debug: select 1 as id
[0m13:48:19.955142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:20.010638 [debug] [MainThread]: SQL status: SELECT 1 in 0.055 seconds
[0m13:48:20.011301 [debug] [MainThread]: On debug: Close
[0m13:48:20.011543 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:48:20.011844 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:48:20.013841 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.31416592, "process_in_blocks": "0", "process_kernel_time": 0.158372, "process_mem_max_rss": "121044992", "process_out_blocks": "0", "process_user_time": 0.760535}
[0m13:48:20.014156 [debug] [MainThread]: Command `dbt debug` succeeded at 13:48:20.014097 after 0.31 seconds
[0m13:48:20.014330 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:48:20.014524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a6b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b316d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113406ad0>]}
[0m13:48:20.014768 [debug] [MainThread]: Flushing usage events
[0m13:48:20.664728 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:22:48.471589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1bb10>]}


============================== 20:22:48.475046 | cc1a1f50-abd3-4781-9151-04b1e0eee06a ==============================
[0m20:22:48.475046 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:22:48.475376 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'write_json': 'True', 'profiles_dir': '/Users/adil/.dbt', 'empty': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'debug': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'version_check': 'True', 'target_path': 'None'}
[0m20:22:48.489013 [info ] [MainThread]: dbt version: 1.10.15
[0m20:22:48.489238 [info ] [MainThread]: python version: 3.13.7
[0m20:22:48.489383 [info ] [MainThread]: python path: /Users/adil/repos/airflow-test/.venv/bin/python
[0m20:22:48.489522 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m20:22:48.559915 [info ] [MainThread]: Using profiles dir at /Users/adil/.dbt
[0m20:22:48.560167 [info ] [MainThread]: Using profiles.yml file at /Users/adil/.dbt/profiles.yml
[0m20:22:48.560312 [info ] [MainThread]: Using dbt_project.yml file at /Users/adil/repos/airflow-test/dbt_test/dbt_project.yml
[0m20:22:48.560711 [info ] [MainThread]: adapter type: postgres
[0m20:22:48.560889 [info ] [MainThread]: adapter version: 1.9.1
[0m20:22:48.607859 [info ] [MainThread]: Configuration:
[0m20:22:48.608097 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:22:48.608256 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:22:48.608414 [info ] [MainThread]: Required dependencies:
[0m20:22:48.608614 [debug] [MainThread]: Executing "git --help"
[0m20:22:48.622252 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:22:48.622746 [debug] [MainThread]: STDERR: "b''"
[0m20:22:48.622923 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:22:48.623087 [info ] [MainThread]: Connection:
[0m20:22:48.623246 [info ] [MainThread]:   host: localhost
[0m20:22:48.623378 [info ] [MainThread]:   port: 5433
[0m20:22:48.623500 [info ] [MainThread]:   user: postgres
[0m20:22:48.623620 [info ] [MainThread]:   database: dbt_test
[0m20:22:48.623750 [info ] [MainThread]:   schema: public
[0m20:22:48.623868 [info ] [MainThread]:   connect_timeout: 10
[0m20:22:48.623993 [info ] [MainThread]:   role: None
[0m20:22:48.624108 [info ] [MainThread]:   search_path: None
[0m20:22:48.624225 [info ] [MainThread]:   keepalives_idle: 0
[0m20:22:48.624340 [info ] [MainThread]:   sslmode: None
[0m20:22:48.624455 [info ] [MainThread]:   sslcert: None
[0m20:22:48.624572 [info ] [MainThread]:   sslkey: None
[0m20:22:48.624686 [info ] [MainThread]:   sslrootcert: None
[0m20:22:48.624805 [info ] [MainThread]:   application_name: dbt
[0m20:22:48.624922 [info ] [MainThread]:   retries: 1
[0m20:22:48.625312 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:22:48.674204 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:22:48.712087 [debug] [MainThread]: Using postgres connection "debug"
[0m20:22:48.712273 [debug] [MainThread]: On debug: select 1 as id
[0m20:22:48.712415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:22:48.774556 [debug] [MainThread]: SQL status: SELECT 1 in 0.062 seconds
[0m20:22:48.775166 [debug] [MainThread]: On debug: Close
[0m20:22:48.775371 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:22:48.775549 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:22:48.777513 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.3451487, "process_in_blocks": "0", "process_kernel_time": 0.16552, "process_mem_max_rss": "122142720", "process_out_blocks": "0", "process_user_time": 0.767268}
[0m20:22:48.777818 [debug] [MainThread]: Command `dbt debug` succeeded at 20:22:48.777762 after 0.35 seconds
[0m20:22:48.777995 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:22:48.778187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a616d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdaad0>]}
[0m20:22:48.778412 [debug] [MainThread]: Flushing usage events
[0m20:22:49.276475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:23.012262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10917fb10>]}


============================== 20:41:23.015404 | 68424ff4-20cd-4ab7-91ce-eb89a4b76b59 ==============================
[0m20:41:23.015404 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:41:23.015761 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'profiles_dir': '/Users/adil/.dbt', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'fail_fast': 'False', 'quiet': 'False', 'use_colors': 'True', 'write_json': 'True', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'debug': 'False', 'introspect': 'True', 'use_experimental_parser': 'False'}
[0m20:41:23.031303 [info ] [MainThread]: dbt version: 1.10.15
[0m20:41:23.031555 [info ] [MainThread]: python version: 3.13.7
[0m20:41:23.031703 [info ] [MainThread]: python path: /Users/adil/repos/airflow-test/.venv/bin/python
[0m20:41:23.031841 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit-Mach-O
[0m20:41:23.077402 [info ] [MainThread]: Using profiles dir at /Users/adil/.dbt
[0m20:41:23.077661 [info ] [MainThread]: Using profiles.yml file at /Users/adil/.dbt/profiles.yml
[0m20:41:23.077806 [info ] [MainThread]: Using dbt_project.yml file at /Users/adil/repos/airflow-test/dbt_test/dbt_project.yml
[0m20:41:23.078210 [info ] [MainThread]: adapter type: postgres
[0m20:41:23.078392 [info ] [MainThread]: adapter version: 1.9.1
[0m20:41:23.124654 [info ] [MainThread]: Configuration:
[0m20:41:23.124896 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:41:23.125059 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:41:23.125205 [info ] [MainThread]: Required dependencies:
[0m20:41:23.125397 [debug] [MainThread]: Executing "git --help"
[0m20:41:23.140393 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:41:23.140826 [debug] [MainThread]: STDERR: "b''"
[0m20:41:23.140989 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:41:23.141146 [info ] [MainThread]: Connection:
[0m20:41:23.141305 [info ] [MainThread]:   host: localhost
[0m20:41:23.141435 [info ] [MainThread]:   port: 5433
[0m20:41:23.141555 [info ] [MainThread]:   user: postgres
[0m20:41:23.141671 [info ] [MainThread]:   database: dbt_test
[0m20:41:23.141785 [info ] [MainThread]:   schema: analytics
[0m20:41:23.141904 [info ] [MainThread]:   connect_timeout: 10
[0m20:41:23.142023 [info ] [MainThread]:   role: None
[0m20:41:23.142135 [info ] [MainThread]:   search_path: None
[0m20:41:23.142250 [info ] [MainThread]:   keepalives_idle: 0
[0m20:41:23.142364 [info ] [MainThread]:   sslmode: None
[0m20:41:23.142477 [info ] [MainThread]:   sslcert: None
[0m20:41:23.142592 [info ] [MainThread]:   sslkey: None
[0m20:41:23.142704 [info ] [MainThread]:   sslrootcert: None
[0m20:41:23.142819 [info ] [MainThread]:   application_name: dbt
[0m20:41:23.142943 [info ] [MainThread]:   retries: 1
[0m20:41:23.143251 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:41:23.187789 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:41:23.225163 [debug] [MainThread]: Using postgres connection "debug"
[0m20:41:23.225351 [debug] [MainThread]: On debug: select 1 as id
[0m20:41:23.225488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:23.289007 [debug] [MainThread]: SQL status: SELECT 1 in 0.063 seconds
[0m20:41:23.289640 [debug] [MainThread]: On debug: Close
[0m20:41:23.289833 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:41:23.290018 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:41:23.291776 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.31693247, "process_in_blocks": "0", "process_kernel_time": 0.158451, "process_mem_max_rss": "121257984", "process_out_blocks": "0", "process_user_time": 0.749885}
[0m20:41:23.292062 [debug] [MainThread]: Command `dbt debug` succeeded at 20:41:23.292005 after 0.32 seconds
[0m20:41:23.292246 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:41:23.292431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10923aad0>]}
[0m20:41:23.292665 [debug] [MainThread]: Flushing usage events
[0m20:41:24.395125 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:44:29.476214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104418590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4bb10>]}


============================== 20:44:29.479301 | 97a965f5-2f71-4503-b6b1-41a7890b7275 ==============================
[0m20:44:29.479301 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:44:29.479626 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'invocation_command': 'dbt run', 'debug': 'False', 'target_path': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adil/.dbt', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'use_colors': 'True', 'no_print': 'None', 'write_json': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'empty': 'False'}
[0m20:44:29.583242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97a965f5-2f71-4503-b6b1-41a7890b7275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c09d0>]}
[0m20:44:29.610773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97a965f5-2f71-4503-b6b1-41a7890b7275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf3790>]}
[0m20:44:29.611377 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:44:29.659571 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:44:29.660011 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:44:29.660215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '97a965f5-2f71-4503-b6b1-41a7890b7275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cff950>]}
[0m20:44:30.214502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97a965f5-2f71-4503-b6b1-41a7890b7275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f26c60>]}
[0m20:44:30.250481 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m20:44:30.251576 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m20:44:30.276107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97a965f5-2f71-4503-b6b1-41a7890b7275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f9faf0>]}
[0m20:44:30.276345 [info ] [MainThread]: Found 2 models, 4 data tests, 459 macros
[0m20:44:30.276521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97a965f5-2f71-4503-b6b1-41a7890b7275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6d710>]}
[0m20:44:30.277287 [info ] [MainThread]: 
[0m20:44:30.277455 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:44:30.277588 [info ] [MainThread]: 
[0m20:44:30.277808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:44:30.279480 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m20:44:30.323365 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m20:44:30.323576 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m20:44:30.323715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:30.380274 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.057 seconds
[0m20:44:30.381073 [debug] [ThreadPool]: On list_dbt_test: Close
[0m20:44:30.381541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now create_dbt_test_analytics)
[0m20:44:30.381815 [debug] [ThreadPool]: Creating schema "database: "dbt_test"
schema: "analytics"
"
[0m20:44:30.384608 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics"
[0m20:44:30.384785 [debug] [ThreadPool]: On create_dbt_test_analytics: BEGIN
[0m20:44:30.384920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:30.398617 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m20:44:30.398804 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics"
[0m20:44:30.398953 [debug] [ThreadPool]: On create_dbt_test_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "create_dbt_test_analytics"} */
create schema if not exists "analytics"
[0m20:44:30.400687 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m20:44:30.401226 [debug] [ThreadPool]: On create_dbt_test_analytics: COMMIT
[0m20:44:30.401398 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics"
[0m20:44:30.401536 [debug] [ThreadPool]: On create_dbt_test_analytics: COMMIT
[0m20:44:30.403079 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m20:44:30.403225 [debug] [ThreadPool]: On create_dbt_test_analytics: Close
[0m20:44:30.404189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_test_analytics, now list_dbt_test_analytics)
[0m20:44:30.407882 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m20:44:30.408064 [debug] [ThreadPool]: On list_dbt_test_analytics: BEGIN
[0m20:44:30.408227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:30.422557 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m20:44:30.422833 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m20:44:30.423010 [debug] [ThreadPool]: On list_dbt_test_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:44:30.430113 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m20:44:30.430965 [debug] [ThreadPool]: On list_dbt_test_analytics: ROLLBACK
[0m20:44:30.431779 [debug] [ThreadPool]: On list_dbt_test_analytics: Close
[0m20:44:30.434760 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:30.434942 [debug] [MainThread]: On master: BEGIN
[0m20:44:30.435083 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:44:30.447447 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:44:30.447703 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:30.447905 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:44:30.454234 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m20:44:30.454921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97a965f5-2f71-4503-b6b1-41a7890b7275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711a450>]}
[0m20:44:30.455166 [debug] [MainThread]: On master: ROLLBACK
[0m20:44:30.455684 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:30.455825 [debug] [MainThread]: On master: BEGIN
[0m20:44:30.456583 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:44:30.456719 [debug] [MainThread]: On master: COMMIT
[0m20:44:30.456847 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:30.456968 [debug] [MainThread]: On master: COMMIT
[0m20:44:30.457399 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:44:30.457532 [debug] [MainThread]: On master: Close
[0m20:44:30.460795 [debug] [Thread-1 (]: Began running node model.dbt_test.my_first_dbt_model
[0m20:44:30.461104 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m20:44:30.461372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics, now model.dbt_test.my_first_dbt_model)
[0m20:44:30.461564 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_first_dbt_model
[0m20:44:30.465344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m20:44:30.465885 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_first_dbt_model
[0m20:44:30.486266 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m20:44:30.486853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m20:44:30.487021 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m20:44:30.487167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:30.499872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m20:44:30.500086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m20:44:30.500280 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:44:30.504121 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m20:44:30.508985 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m20:44:30.509166 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:44:30.509934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:44:30.516899 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m20:44:30.517093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m20:44:30.517251 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m20:44:30.518378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:44:30.521150 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_first_dbt_model__dbt_backup"
[0m20:44:30.523299 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m20:44:30.523468 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_test"."analytics"."my_first_dbt_model__dbt_backup" cascade
[0m20:44:30.524077 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m20:44:30.525245 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: Close
[0m20:44:30.526497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97a965f5-2f71-4503-b6b1-41a7890b7275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075fdbd0>]}
[0m20:44:30.526841 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.06s]
[0m20:44:30.527369 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_first_dbt_model
[0m20:44:30.527746 [debug] [Thread-2 (]: Began running node model.dbt_test.my_second_dbt_model
[0m20:44:30.528008 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m20:44:30.528295 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_test.my_second_dbt_model'
[0m20:44:30.528474 [debug] [Thread-2 (]: Began compiling node model.dbt_test.my_second_dbt_model
[0m20:44:30.529936 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m20:44:30.530249 [debug] [Thread-2 (]: Began executing node model.dbt_test.my_second_dbt_model
[0m20:44:30.538837 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m20:44:30.539206 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m20:44:30.539377 [debug] [Thread-2 (]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m20:44:30.539532 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:44:30.556604 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m20:44:30.556892 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m20:44:30.557106 [debug] [Thread-2 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_test"."analytics"."my_first_dbt_model"
where id = 1
  );
[0m20:44:30.560881 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:44:30.563025 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m20:44:30.563231 [debug] [Thread-2 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:44:30.564353 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:44:30.565102 [debug] [Thread-2 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m20:44:30.565291 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m20:44:30.565450 [debug] [Thread-2 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m20:44:30.566202 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m20:44:30.567271 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."analytics"."my_second_dbt_model__dbt_backup"
[0m20:44:30.568778 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m20:44:30.568960 [debug] [Thread-2 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_test"."analytics"."my_second_dbt_model__dbt_backup" cascade
[0m20:44:30.569527 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:44:30.570171 [debug] [Thread-2 (]: On model.dbt_test.my_second_dbt_model: Close
[0m20:44:30.570469 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97a965f5-2f71-4503-b6b1-41a7890b7275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd7cf0>]}
[0m20:44:30.570804 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.04s]
[0m20:44:30.571072 [debug] [Thread-2 (]: Finished running node model.dbt_test.my_second_dbt_model
[0m20:44:30.571679 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:30.571822 [debug] [MainThread]: On master: BEGIN
[0m20:44:30.571950 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:44:30.586130 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m20:44:30.586427 [debug] [MainThread]: On master: COMMIT
[0m20:44:30.586638 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:30.586809 [debug] [MainThread]: On master: COMMIT
[0m20:44:30.587315 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:44:30.587525 [debug] [MainThread]: On master: Close
[0m20:44:30.587781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:30.587923 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m20:44:30.588050 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m20:44:30.588200 [info ] [MainThread]: 
[0m20:44:30.588357 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m20:44:30.588749 [debug] [MainThread]: Command end result
[0m20:44:30.602935 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m20:44:30.603905 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m20:44:30.607061 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m20:44:30.607235 [info ] [MainThread]: 
[0m20:44:30.607426 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:44:30.607570 [info ] [MainThread]: 
[0m20:44:30.607725 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m20:44:30.609336 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1694133, "process_in_blocks": "0", "process_kernel_time": 0.172903, "process_mem_max_rss": "136331264", "process_out_blocks": "0", "process_user_time": 1.471909}
[0m20:44:30.609578 [debug] [MainThread]: Command `dbt run` succeeded at 20:44:30.609535 after 1.17 seconds
[0m20:44:30.609765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec47c0>]}
[0m20:44:30.610072 [debug] [MainThread]: Flushing usage events
[0m20:44:31.303959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:06.054761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c94590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac3b10>]}


============================== 20:49:06.058367 | be7a2961-d99c-4a95-bd06-0ae1f890e078 ==============================
[0m20:49:06.058367 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:49:06.058696 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'static_parser': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'profiles_dir': '/Users/adil/.dbt', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'invocation_command': 'dbt run', 'write_json': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'printer_width': '80'}
[0m20:49:06.170691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be7a2961-d99c-4a95-bd06-0ae1f890e078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e409d0>]}
[0m20:49:06.200617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be7a2961-d99c-4a95-bd06-0ae1f890e078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696f790>]}
[0m20:49:06.201262 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:49:06.254456 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:49:06.333823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:49:06.334242 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/source.yml
[0m20:49:06.434150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be7a2961-d99c-4a95-bd06-0ae1f890e078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0ee50>]}
[0m20:49:06.474046 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m20:49:06.475363 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m20:49:06.488451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be7a2961-d99c-4a95-bd06-0ae1f890e078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693fd40>]}
[0m20:49:06.488692 [info ] [MainThread]: Found 2 models, 4 data tests, 3 sources, 459 macros
[0m20:49:06.488863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be7a2961-d99c-4a95-bd06-0ae1f890e078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cbf770>]}
[0m20:49:06.489711 [info ] [MainThread]: 
[0m20:49:06.489900 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:49:06.490041 [info ] [MainThread]: 
[0m20:49:06.490276 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:49:06.492065 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m20:49:06.572008 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m20:49:06.572246 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m20:49:06.572394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:06.620027 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.048 seconds
[0m20:49:06.620840 [debug] [ThreadPool]: On list_dbt_test: Close
[0m20:49:06.621509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics)
[0m20:49:06.624387 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m20:49:06.624560 [debug] [ThreadPool]: On list_dbt_test_analytics: BEGIN
[0m20:49:06.624694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:06.635315 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m20:49:06.635550 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m20:49:06.635739 [debug] [ThreadPool]: On list_dbt_test_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m20:49:06.640743 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m20:49:06.641487 [debug] [ThreadPool]: On list_dbt_test_analytics: ROLLBACK
[0m20:49:06.642400 [debug] [ThreadPool]: On list_dbt_test_analytics: Close
[0m20:49:06.645141 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:06.645317 [debug] [MainThread]: On master: BEGIN
[0m20:49:06.645452 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:06.656947 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:49:06.657159 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:06.657366 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:49:06.661279 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m20:49:06.662043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be7a2961-d99c-4a95-bd06-0ae1f890e078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108098050>]}
[0m20:49:06.662261 [debug] [MainThread]: On master: ROLLBACK
[0m20:49:06.662855 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:06.663023 [debug] [MainThread]: On master: BEGIN
[0m20:49:06.663816 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:49:06.663998 [debug] [MainThread]: On master: COMMIT
[0m20:49:06.664169 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:06.664317 [debug] [MainThread]: On master: COMMIT
[0m20:49:06.664810 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:49:06.664978 [debug] [MainThread]: On master: Close
[0m20:49:06.667421 [debug] [Thread-1 (]: Began running node model.dbt_test.my_first_dbt_model
[0m20:49:06.667696 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m20:49:06.667928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics, now model.dbt_test.my_first_dbt_model)
[0m20:49:06.668121 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_first_dbt_model
[0m20:49:06.671999 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m20:49:06.672370 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_first_dbt_model
[0m20:49:06.692425 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m20:49:06.693012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m20:49:06.693177 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m20:49:06.693409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:06.704555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:49:06.704752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m20:49:06.704922 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m20:49:06.712063 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.007 seconds
[0m20:49:06.717034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m20:49:06.717233 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:49:06.718884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:49:06.720704 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m20:49:06.720894 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:49:06.721927 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:49:06.731139 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m20:49:06.731413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m20:49:06.731594 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m20:49:06.733721 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:49:06.737132 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_first_dbt_model__dbt_backup"
[0m20:49:06.739509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m20:49:06.739690 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_test"."analytics"."my_first_dbt_model__dbt_backup" cascade
[0m20:49:06.744223 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:49:06.745458 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: Close
[0m20:49:06.746505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7a2961-d99c-4a95-bd06-0ae1f890e078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3f650>]}
[0m20:49:06.746833 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.08s]
[0m20:49:06.747116 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_first_dbt_model
[0m20:49:06.747486 [debug] [Thread-2 (]: Began running node model.dbt_test.my_second_dbt_model
[0m20:49:06.747762 [info ] [Thread-2 (]: 2 of 2 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m20:49:06.748025 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_test.my_second_dbt_model'
[0m20:49:06.748199 [debug] [Thread-2 (]: Began compiling node model.dbt_test.my_second_dbt_model
[0m20:49:06.749446 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m20:49:06.749814 [debug] [Thread-2 (]: Began executing node model.dbt_test.my_second_dbt_model
[0m20:49:06.759246 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m20:49:06.759783 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m20:49:06.759999 [debug] [Thread-2 (]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m20:49:06.760173 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:49:06.770962 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m20:49:06.771149 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m20:49:06.771310 [debug] [Thread-2 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_test"."analytics"."my_first_dbt_model"
where id = 1
  );
[0m20:49:06.773836 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:49:06.775263 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m20:49:06.775429 [debug] [Thread-2 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:49:06.776131 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:49:06.776891 [debug] [Thread-2 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m20:49:06.777059 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m20:49:06.777230 [debug] [Thread-2 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m20:49:06.778324 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m20:49:06.779381 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."analytics"."my_second_dbt_model__dbt_backup"
[0m20:49:06.780857 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m20:49:06.781052 [debug] [Thread-2 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_test"."analytics"."my_second_dbt_model__dbt_backup" cascade
[0m20:49:06.781600 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:49:06.782224 [debug] [Thread-2 (]: On model.dbt_test.my_second_dbt_model: Close
[0m20:49:06.782522 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7a2961-d99c-4a95-bd06-0ae1f890e078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d838b0>]}
[0m20:49:06.782873 [info ] [Thread-2 (]: 2 of 2 OK created sql view model analytics.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.03s]
[0m20:49:06.783176 [debug] [Thread-2 (]: Finished running node model.dbt_test.my_second_dbt_model
[0m20:49:06.783803 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:06.783945 [debug] [MainThread]: On master: BEGIN
[0m20:49:06.784070 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:06.795680 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:49:06.795907 [debug] [MainThread]: On master: COMMIT
[0m20:49:06.796056 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:06.796188 [debug] [MainThread]: On master: COMMIT
[0m20:49:06.796688 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:49:06.796858 [debug] [MainThread]: On master: Close
[0m20:49:06.797081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:06.797243 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m20:49:06.797365 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m20:49:06.797514 [info ] [MainThread]: 
[0m20:49:06.797673 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m20:49:06.798042 [debug] [MainThread]: Command end result
[0m20:49:06.810542 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m20:49:06.811569 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m20:49:06.815037 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m20:49:06.815204 [info ] [MainThread]: 
[0m20:49:06.815400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:49:06.815543 [info ] [MainThread]: 
[0m20:49:06.815703 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m20:49:06.817372 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8074948, "process_in_blocks": "0", "process_kernel_time": 0.192937, "process_mem_max_rss": "128942080", "process_out_blocks": "0", "process_user_time": 1.188951}
[0m20:49:06.817622 [debug] [MainThread]: Command `dbt run` succeeded at 20:49:06.817576 after 0.81 seconds
[0m20:49:06.817805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd2e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dbfad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4aad0>]}
[0m20:49:06.817985 [debug] [MainThread]: Flushing usage events
[0m20:49:07.259239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:26:29.529237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c18590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d4b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d4bb10>]}


============================== 21:26:29.532845 | bf8af856-2b9c-4aef-9d91-2fd6ef577561 ==============================
[0m21:26:29.532845 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:26:29.533187 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/adil/.dbt', 'version_check': 'True', 'introspect': 'True', 'warn_error': 'None', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'log_format': 'default', 'fail_fast': 'False', 'partial_parse': 'True', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False'}
[0m21:26:29.636513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf8af856-2b9c-4aef-9d91-2fd6ef577561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ec09d0>]}
[0m21:26:29.666216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf8af856-2b9c-4aef-9d91-2fd6ef577561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bf7790>]}
[0m21:26:29.666954 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:26:29.720574 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:26:29.771511 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:26:29.771823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf8af856-2b9c-4aef-9d91-2fd6ef577561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114be2850>]}
[0m21:26:30.390881 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_test.marts
- models.dbt_test.intermediate
[0m21:26:30.395631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf8af856-2b9c-4aef-9d91-2fd6ef577561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c1f5c0>]}
[0m21:26:30.436786 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:26:30.438024 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:26:30.451866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf8af856-2b9c-4aef-9d91-2fd6ef577561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d43af0>]}
[0m21:26:30.452122 [info ] [MainThread]: Found 3 models, 4 data tests, 3 sources, 459 macros
[0m21:26:30.452367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf8af856-2b9c-4aef-9d91-2fd6ef577561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115205a50>]}
[0m21:26:30.453260 [info ] [MainThread]: 
[0m21:26:30.453445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:26:30.453589 [info ] [MainThread]: 
[0m21:26:30.453821 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:26:30.455609 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:26:30.460595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:26:30.501143 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:26:30.501376 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:26:30.501547 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:26:30.501751 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:26:30.501910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:30.502054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:30.545574 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.043 seconds
[0m21:26:30.545844 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.044 seconds
[0m21:26:30.546601 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:26:30.547143 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:26:30.547609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now create_dbt_test_analytics_staging)
[0m21:26:30.547838 [debug] [ThreadPool]: Creating schema "database: "dbt_test"
schema: "analytics_staging"
"
[0m21:26:30.550452 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics_staging"
[0m21:26:30.550628 [debug] [ThreadPool]: On create_dbt_test_analytics_staging: BEGIN
[0m21:26:30.550769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:30.563550 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m21:26:30.563797 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics_staging"
[0m21:26:30.563978 [debug] [ThreadPool]: On create_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "create_dbt_test_analytics_staging"} */
create schema if not exists "analytics_staging"
[0m21:26:30.565203 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:26:30.565708 [debug] [ThreadPool]: On create_dbt_test_analytics_staging: COMMIT
[0m21:26:30.565874 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics_staging"
[0m21:26:30.566006 [debug] [ThreadPool]: On create_dbt_test_analytics_staging: COMMIT
[0m21:26:30.567180 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m21:26:30.567346 [debug] [ThreadPool]: On create_dbt_test_analytics_staging: Close
[0m21:26:30.568049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_staging)
[0m21:26:30.570902 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:26:30.571177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_test_analytics_staging, now list_dbt_test_analytics)
[0m21:26:30.571321 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:26:30.572497 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:26:30.572656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:30.572810 [debug] [ThreadPool]: On list_dbt_test_analytics: BEGIN
[0m21:26:30.573001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:30.586326 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m21:26:30.586528 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:26:30.586744 [debug] [ThreadPool]: On list_dbt_test_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:26:30.587123 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m21:26:30.587278 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:26:30.587440 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:26:30.591635 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m21:26:30.592291 [debug] [ThreadPool]: On list_dbt_test_analytics: ROLLBACK
[0m21:26:30.592458 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m21:26:30.593021 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:26:30.593163 [debug] [ThreadPool]: On list_dbt_test_analytics: Close
[0m21:26:30.593685 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:26:30.595766 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:30.595927 [debug] [MainThread]: On master: BEGIN
[0m21:26:30.596060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:30.607236 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m21:26:30.607417 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:30.607611 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:26:30.611272 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m21:26:30.612010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf8af856-2b9c-4aef-9d91-2fd6ef577561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151dff50>]}
[0m21:26:30.612243 [debug] [MainThread]: On master: ROLLBACK
[0m21:26:30.612714 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:30.612853 [debug] [MainThread]: On master: BEGIN
[0m21:26:30.613659 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:26:30.613834 [debug] [MainThread]: On master: COMMIT
[0m21:26:30.613978 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:30.614114 [debug] [MainThread]: On master: COMMIT
[0m21:26:30.614539 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:26:30.614674 [debug] [MainThread]: On master: Close
[0m21:26:30.616120 [debug] [Thread-1 (]: Began running node model.dbt_test.my_first_dbt_model
[0m21:26:30.616308 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_customers
[0m21:26:30.616567 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m21:26:30.617004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.my_first_dbt_model)
[0m21:26:30.616825 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_staging.stg_customers .................... [RUN]
[0m21:26:30.617238 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:26:30.617435 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics, now model.dbt_test.stg_customers)
[0m21:26:30.621437 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:26:30.621640 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_customers
[0m21:26:30.623129 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:26:30.623425 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:26:30.641454 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_customers
[0m21:26:30.643317 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:26:30.652032 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:26:30.652655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:26:30.652842 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:26:30.653008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:30.653197 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:26:30.653465 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:26:30.653611 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:30.666589 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m21:26:30.666810 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:26:30.667021 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."analytics_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_tutorial"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed;
  );
[0m21:26:30.667754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m21:26:30.667954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:26:30.668155 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: select * from renamed;
                              ^

[0m21:26:30.668363 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:26:30.668631 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: ROLLBACK
[0m21:26:30.669310 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: Close
[0m21:26:30.673052 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m21:26:30.677877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:26:30.678101 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:26:30.679877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:26:30.681317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:26:30.681945 [debug] [Thread-2 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 21: select * from renamed;
                                ^
  compiled code at target/run/dbt_test/models/staging/stg_customers.sql
[0m21:26:30.682133 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:26:30.683133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf8af856-2b9c-4aef-9d91-2fd6ef577561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11548dbd0>]}
[0m21:26:30.683348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:26:30.683679 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model analytics_staging.stg_customers ........... [[31mERROR[0m in 0.06s]
[0m21:26:30.691922 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:26:30.692202 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_customers
[0m21:26:30.692399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:26:30.692679 [debug] [Thread-7 (]: Marking all children of 'model.dbt_test.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 21: select * from renamed;
                                ^
  compiled code at target/run/dbt_test/models/staging/stg_customers.sql.
[0m21:26:30.692948 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:26:30.694859 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:26:30.697801 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_first_dbt_model__dbt_backup"
[0m21:26:30.700118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:26:30.700289 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_test"."analytics"."my_first_dbt_model__dbt_backup" cascade
[0m21:26:30.704519 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m21:26:30.705673 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: Close
[0m21:26:30.705955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf8af856-2b9c-4aef-9d91-2fd6ef577561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11571ed50>]}
[0m21:26:30.706264 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.09s]
[0m21:26:30.706544 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:26:30.706890 [debug] [Thread-3 (]: Began running node model.dbt_test.my_second_dbt_model
[0m21:26:30.707118 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m21:26:30.707349 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_test.my_second_dbt_model'
[0m21:26:30.707508 [debug] [Thread-3 (]: Began compiling node model.dbt_test.my_second_dbt_model
[0m21:26:30.708927 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m21:26:30.709282 [debug] [Thread-3 (]: Began executing node model.dbt_test.my_second_dbt_model
[0m21:26:30.710803 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m21:26:30.711095 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:26:30.711256 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m21:26:30.711413 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:26:30.722675 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m21:26:30.722930 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:26:30.723107 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_test"."analytics"."my_first_dbt_model"
where id = 1
  );
[0m21:26:30.725751 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:26:30.727193 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:26:30.727365 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:26:30.727931 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:26:30.728836 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:26:30.728988 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:26:30.729124 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:26:30.729988 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:26:30.730926 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics"."my_second_dbt_model__dbt_backup"
[0m21:26:30.732357 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:26:30.732548 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_test"."analytics"."my_second_dbt_model__dbt_backup" cascade
[0m21:26:30.733078 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:26:30.733680 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: Close
[0m21:26:30.733944 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf8af856-2b9c-4aef-9d91-2fd6ef577561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11574cfd0>]}
[0m21:26:30.734237 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.03s]
[0m21:26:30.734498 [debug] [Thread-3 (]: Finished running node model.dbt_test.my_second_dbt_model
[0m21:26:30.735374 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:30.735545 [debug] [MainThread]: On master: BEGIN
[0m21:26:30.735686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:30.746205 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m21:26:30.746462 [debug] [MainThread]: On master: COMMIT
[0m21:26:30.746627 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:30.746757 [debug] [MainThread]: On master: COMMIT
[0m21:26:30.747256 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:26:30.747405 [debug] [MainThread]: On master: Close
[0m21:26:30.747619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:30.747755 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:26:30.747884 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:26:30.748021 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m21:26:30.748219 [info ] [MainThread]: 
[0m21:26:30.748377 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m21:26:30.748822 [debug] [MainThread]: Command end result
[0m21:26:30.761374 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:26:30.762390 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:26:30.765472 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:26:30.765642 [info ] [MainThread]: 
[0m21:26:30.765811 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:26:30.765954 [info ] [MainThread]: 
[0m21:26:30.766134 [error] [MainThread]: [31mFailure in model stg_customers (models/staging/stg_customers.sql)[0m
[0m21:26:30.766305 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 21: select * from renamed;
                                ^
  compiled code at target/run/dbt_test/models/staging/stg_customers.sql
[0m21:26:30.766437 [info ] [MainThread]: 
[0m21:26:30.766591 [info ] [MainThread]:   compiled code at target/compiled/dbt_test/models/staging/stg_customers.sql
[0m21:26:30.766720 [info ] [MainThread]: 
[0m21:26:30.766867 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m21:26:30.768773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.279502, "process_in_blocks": "0", "process_kernel_time": 0.198711, "process_mem_max_rss": "137543680", "process_out_blocks": "0", "process_user_time": 1.669893}
[0m21:26:30.769040 [debug] [MainThread]: Command `dbt run` failed at 21:26:30.768992 after 1.28 seconds
[0m21:26:30.769257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dc87c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10500bd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c46c30>]}
[0m21:26:30.769453 [debug] [MainThread]: Flushing usage events
[0m21:26:31.287374 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:26:56.961534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10899f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10899fb10>]}


============================== 21:26:56.964366 | 1c28e4f6-8ebb-4ed3-b1fe-2944bde76cb5 ==============================
[0m21:26:56.964366 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:26:56.964684 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'write_json': 'True', 'profiles_dir': '/Users/adil/.dbt', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'introspect': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error': 'None', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'quiet': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'empty': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'target_path': 'None'}
[0m21:26:57.063546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c28e4f6-8ebb-4ed3-b1fe-2944bde76cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d149d0>]}
[0m21:26:57.091937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c28e4f6-8ebb-4ed3-b1fe-2944bde76cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108847790>]}
[0m21:26:57.093162 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:26:57.142115 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:26:57.212198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:26:57.212509 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/staging/stg_customers.sql
[0m21:26:57.327624 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_test.intermediate
- models.dbt_test.marts
[0m21:26:57.333727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c28e4f6-8ebb-4ed3-b1fe-2944bde76cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e3250>]}
[0m21:26:57.373241 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:26:57.374429 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:26:57.385810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c28e4f6-8ebb-4ed3-b1fe-2944bde76cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098bfe30>]}
[0m21:26:57.386053 [info ] [MainThread]: Found 3 models, 4 data tests, 3 sources, 459 macros
[0m21:26:57.386223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c28e4f6-8ebb-4ed3-b1fe-2944bde76cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bea350>]}
[0m21:26:57.387119 [info ] [MainThread]: 
[0m21:26:57.387305 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:26:57.387445 [info ] [MainThread]: 
[0m21:26:57.387678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:26:57.389514 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:26:57.394477 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:26:57.450167 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:26:57.450394 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:26:57.450566 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:26:57.450742 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:26:57.450902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:57.451047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:57.508255 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.057 seconds
[0m21:26:57.508471 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.057 seconds
[0m21:26:57.509143 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:26:57.509712 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:26:57.510378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics)
[0m21:26:57.510611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_staging)
[0m21:26:57.513338 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:26:57.514177 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:26:57.514329 [debug] [ThreadPool]: On list_dbt_test_analytics: BEGIN
[0m21:26:57.514467 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:26:57.514594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:57.514716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:57.531610 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m21:26:57.531863 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m21:26:57.532056 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:26:57.532224 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:26:57.532389 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:26:57.532566 [debug] [ThreadPool]: On list_dbt_test_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:26:57.539291 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m21:26:57.539487 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m21:26:57.540501 [debug] [ThreadPool]: On list_dbt_test_analytics: ROLLBACK
[0m21:26:57.541064 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:26:57.541777 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:26:57.541973 [debug] [ThreadPool]: On list_dbt_test_analytics: Close
[0m21:26:57.544329 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:57.544497 [debug] [MainThread]: On master: BEGIN
[0m21:26:57.544634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:57.558021 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m21:26:57.558201 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:57.558399 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:26:57.563595 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m21:26:57.564389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c28e4f6-8ebb-4ed3-b1fe-2944bde76cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4cbb0>]}
[0m21:26:57.564631 [debug] [MainThread]: On master: ROLLBACK
[0m21:26:57.565195 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:57.565351 [debug] [MainThread]: On master: BEGIN
[0m21:26:57.566115 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:26:57.566264 [debug] [MainThread]: On master: COMMIT
[0m21:26:57.566405 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:57.566541 [debug] [MainThread]: On master: COMMIT
[0m21:26:57.567040 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:26:57.567231 [debug] [MainThread]: On master: Close
[0m21:26:57.568739 [debug] [Thread-1 (]: Began running node model.dbt_test.my_first_dbt_model
[0m21:26:57.568955 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_customers
[0m21:26:57.569226 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m21:26:57.569531 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_staging.stg_customers .................... [RUN]
[0m21:26:57.569764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics, now model.dbt_test.my_first_dbt_model)
[0m21:26:57.569952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.stg_customers)
[0m21:26:57.570131 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:26:57.570295 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_customers
[0m21:26:57.574686 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:26:57.576631 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:26:57.577571 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:26:57.584782 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_customers
[0m21:26:57.608066 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:26:57.609985 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:26:57.610420 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:26:57.610623 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:26:57.610796 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:26:57.610958 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:26:57.611121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:57.611282 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:57.625331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m21:26:57.625562 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m21:26:57.625782 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:26:57.625995 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:26:57.626208 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:26:57.626417 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."analytics_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_tutorial"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:26:57.627540 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "dbt_tutorial.raw.customers"
LINE 10:     select * from "dbt_tutorial"."raw"."customers"
                           ^

[0m21:26:57.627739 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: ROLLBACK
[0m21:26:57.628381 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: Close
[0m21:26:57.630710 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m21:26:57.635630 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:26:57.635828 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:26:57.636704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:26:57.638164 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:26:57.638374 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:26:57.639015 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:26:57.647344 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:26:57.647560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:26:57.647759 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:26:57.649660 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:26:57.652580 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_first_dbt_model__dbt_backup"
[0m21:26:57.652973 [debug] [Thread-2 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  cross-database references are not implemented: "dbt_tutorial.raw.customers"
  LINE 10:     select * from "dbt_tutorial"."raw"."customers"
                             ^
  compiled code at target/run/dbt_test/models/staging/stg_customers.sql
[0m21:26:57.655452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:26:57.656221 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_test"."analytics"."my_first_dbt_model__dbt_backup" cascade
[0m21:26:57.656624 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c28e4f6-8ebb-4ed3-b1fe-2944bde76cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c03a10>]}
[0m21:26:57.656947 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model analytics_staging.stg_customers ........... [[31mERROR[0m in 0.09s]
[0m21:26:57.657270 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_customers
[0m21:26:57.657533 [debug] [Thread-7 (]: Marking all children of 'model.dbt_test.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models/staging/stg_customers.sql)
  cross-database references are not implemented: "dbt_tutorial.raw.customers"
  LINE 10:     select * from "dbt_tutorial"."raw"."customers"
                             ^
  compiled code at target/run/dbt_test/models/staging/stg_customers.sql.
[0m21:26:57.659304 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:26:57.660407 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: Close
[0m21:26:57.660689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c28e4f6-8ebb-4ed3-b1fe-2944bde76cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bcfac0>]}
[0m21:26:57.661012 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.09s]
[0m21:26:57.661315 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:26:57.661637 [debug] [Thread-3 (]: Began running node model.dbt_test.my_second_dbt_model
[0m21:26:57.661880 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m21:26:57.662288 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_test.my_second_dbt_model'
[0m21:26:57.662507 [debug] [Thread-3 (]: Began compiling node model.dbt_test.my_second_dbt_model
[0m21:26:57.664154 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m21:26:57.664525 [debug] [Thread-3 (]: Began executing node model.dbt_test.my_second_dbt_model
[0m21:26:57.666465 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m21:26:57.666816 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:26:57.666983 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m21:26:57.667135 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:26:57.678330 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m21:26:57.678535 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:26:57.678711 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_test"."analytics"."my_first_dbt_model"
where id = 1
  );
[0m21:26:57.681069 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:26:57.682554 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:26:57.682736 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:26:57.683549 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:26:57.684267 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:26:57.684436 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:26:57.684593 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:26:57.685627 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:26:57.686601 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics"."my_second_dbt_model__dbt_backup"
[0m21:26:57.687983 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:26:57.688153 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_test"."analytics"."my_second_dbt_model__dbt_backup" cascade
[0m21:26:57.688726 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:26:57.689367 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: Close
[0m21:26:57.689650 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c28e4f6-8ebb-4ed3-b1fe-2944bde76cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8de50>]}
[0m21:26:57.689962 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.03s]
[0m21:26:57.690231 [debug] [Thread-3 (]: Finished running node model.dbt_test.my_second_dbt_model
[0m21:26:57.690808 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:57.690952 [debug] [MainThread]: On master: BEGIN
[0m21:26:57.691076 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:57.702549 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m21:26:57.702779 [debug] [MainThread]: On master: COMMIT
[0m21:26:57.702939 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:57.703077 [debug] [MainThread]: On master: COMMIT
[0m21:26:57.703578 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:26:57.703755 [debug] [MainThread]: On master: Close
[0m21:26:57.703975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:57.704122 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:26:57.704257 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:26:57.704373 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m21:26:57.704541 [info ] [MainThread]: 
[0m21:26:57.704701 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m21:26:57.705162 [debug] [MainThread]: Command end result
[0m21:26:57.717295 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:26:57.718272 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:26:57.721783 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:26:57.721947 [info ] [MainThread]: 
[0m21:26:57.722118 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:26:57.722259 [info ] [MainThread]: 
[0m21:26:57.722441 [error] [MainThread]: [31mFailure in model stg_customers (models/staging/stg_customers.sql)[0m
[0m21:26:57.722618 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  cross-database references are not implemented: "dbt_tutorial.raw.customers"
  LINE 10:     select * from "dbt_tutorial"."raw"."customers"
                             ^
  compiled code at target/run/dbt_test/models/staging/stg_customers.sql
[0m21:26:57.722750 [info ] [MainThread]: 
[0m21:26:57.722902 [info ] [MainThread]:   compiled code at target/compiled/dbt_test/models/staging/stg_customers.sql
[0m21:26:57.723034 [info ] [MainThread]: 
[0m21:26:57.723182 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m21:26:57.725055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.79836094, "process_in_blocks": "0", "process_kernel_time": 0.180611, "process_mem_max_rss": "133201920", "process_out_blocks": "0", "process_user_time": 1.198804}
[0m21:26:57.725263 [debug] [MainThread]: Command `dbt run` failed at 21:26:57.725225 after 0.80 seconds
[0m21:26:57.725437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c19a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a207c0>]}
[0m21:26:57.725605 [debug] [MainThread]: Flushing usage events
[0m21:26:58.174361 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:25.401370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106338590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716bb10>]}


============================== 21:27:25.405136 | 6e76a2d9-a2fd-4ee1-b3cd-b45363270479 ==============================
[0m21:27:25.405136 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:27:25.405525 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'empty': 'False', 'introspect': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/Users/adil/.dbt', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'no_print': 'None'}
[0m21:27:25.506600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e76a2d9-a2fd-4ee1-b3cd-b45363270479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e49d0>]}
[0m21:27:25.534259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e76a2d9-a2fd-4ee1-b3cd-b45363270479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107013790>]}
[0m21:27:25.535438 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:27:25.588483 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:27:25.662276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:27:25.662650 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/source.yml
[0m21:27:25.823551 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_test.marts
- models.dbt_test.intermediate
[0m21:27:25.827910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e76a2d9-a2fd-4ee1-b3cd-b45363270479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080af050>]}
[0m21:27:25.895120 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:27:25.896269 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:27:25.907515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e76a2d9-a2fd-4ee1-b3cd-b45363270479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107193200>]}
[0m21:27:25.907756 [info ] [MainThread]: Found 3 models, 4 data tests, 3 sources, 459 macros
[0m21:27:25.907935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e76a2d9-a2fd-4ee1-b3cd-b45363270479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107956dd0>]}
[0m21:27:25.908769 [info ] [MainThread]: 
[0m21:27:25.908946 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:27:25.909081 [info ] [MainThread]: 
[0m21:27:25.909307 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:27:25.911066 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:27:25.916473 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:27:25.936594 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:27:25.936800 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:27:25.936964 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:27:25.937121 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:27:25.937269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:25.937404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:26.005257 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.068 seconds
[0m21:27:26.005504 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.068 seconds
[0m21:27:26.006230 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:27:26.006791 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:27:26.007525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_staging)
[0m21:27:26.007766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics)
[0m21:27:26.010690 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:27:26.011600 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:27:26.011762 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:27:26.011928 [debug] [ThreadPool]: On list_dbt_test_analytics: BEGIN
[0m21:27:26.012104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:26.012248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:26.033119 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m21:27:26.033468 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:27:26.033680 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:27:26.033871 [debug] [ThreadPool]: On list_dbt_test_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:27:26.034055 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:27:26.034283 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:27:26.041124 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m21:27:26.042320 [debug] [ThreadPool]: On list_dbt_test_analytics: ROLLBACK
[0m21:27:26.042983 [debug] [ThreadPool]: On list_dbt_test_analytics: Close
[0m21:27:26.043630 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m21:27:26.044284 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:27:26.044935 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:27:26.047433 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:26.047626 [debug] [MainThread]: On master: BEGIN
[0m21:27:26.047774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:26.061317 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m21:27:26.061546 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:26.061761 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:27:26.066466 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m21:27:26.067280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e76a2d9-a2fd-4ee1-b3cd-b45363270479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f3450>]}
[0m21:27:26.067539 [debug] [MainThread]: On master: ROLLBACK
[0m21:27:26.068117 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:26.068305 [debug] [MainThread]: On master: BEGIN
[0m21:27:26.069111 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:27:26.069271 [debug] [MainThread]: On master: COMMIT
[0m21:27:26.069416 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:26.069555 [debug] [MainThread]: On master: COMMIT
[0m21:27:26.070059 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:27:26.070278 [debug] [MainThread]: On master: Close
[0m21:27:26.071861 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_customers
[0m21:27:26.072083 [debug] [Thread-1 (]: Began running node model.dbt_test.my_first_dbt_model
[0m21:27:26.072429 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_staging.stg_customers .................... [RUN]
[0m21:27:26.072740 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m21:27:26.073020 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics, now model.dbt_test.stg_customers)
[0m21:27:26.073290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.my_first_dbt_model)
[0m21:27:26.073517 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_customers
[0m21:27:26.073726 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:27:26.078512 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:27:26.079900 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:27:26.080321 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:27:26.086682 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_customers
[0m21:27:26.107968 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:27:26.110802 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:27:26.111305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:26.111510 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:27:26.111681 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:27:26.111842 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:27:26.111995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:26.112145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:27:26.126998 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m21:27:26.127225 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:27:26.127432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m21:27:26.127634 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."analytics_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:27:26.127831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:26.128037 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:27:26.131841 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m21:27:26.136959 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:26.137165 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m21:27:26.137357 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:27:26.138777 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:27:26.139007 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:27:26.139589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:27:26.139797 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:27:26.141322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:26.148449 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:27:26.148619 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:27:26.148789 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:27:26.149000 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:27:26.149486 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:27:26.151307 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:27:26.151521 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m21:27:26.151711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:26.154619 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_customers__dbt_backup"
[0m21:27:26.154818 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:27:26.159347 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:27:26.159582 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."analytics_staging"."stg_customers__dbt_backup" cascade
[0m21:27:26.160168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:27:26.160350 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:27:26.161448 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_first_dbt_model__dbt_backup"
[0m21:27:26.162590 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: Close
[0m21:27:26.163934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:26.164165 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_test"."analytics"."my_first_dbt_model__dbt_backup" cascade
[0m21:27:26.165208 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e76a2d9-a2fd-4ee1-b3cd-b45363270479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108123710>]}
[0m21:27:26.165544 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_staging.stg_customers ............... [[32mCREATE VIEW[0m in 0.09s]
[0m21:27:26.165840 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_customers
[0m21:27:26.168361 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m21:27:26.169010 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: Close
[0m21:27:26.169307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e76a2d9-a2fd-4ee1-b3cd-b45363270479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827fee0>]}
[0m21:27:26.169621 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.10s]
[0m21:27:26.169890 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:27:26.170196 [debug] [Thread-3 (]: Began running node model.dbt_test.my_second_dbt_model
[0m21:27:26.170439 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m21:27:26.170855 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_test.my_second_dbt_model'
[0m21:27:26.171107 [debug] [Thread-3 (]: Began compiling node model.dbt_test.my_second_dbt_model
[0m21:27:26.172446 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m21:27:26.172832 [debug] [Thread-3 (]: Began executing node model.dbt_test.my_second_dbt_model
[0m21:27:26.174882 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m21:27:26.175221 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:26.175390 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m21:27:26.175553 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:27:26.188187 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m21:27:26.188390 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:26.188568 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_test"."analytics"."my_first_dbt_model"
where id = 1
  );
[0m21:27:26.191254 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:27:26.192584 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:26.192753 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:27:26.193454 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:27:26.194177 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:27:26.194371 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:26.194528 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:27:26.195339 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:27:26.196618 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics"."my_second_dbt_model__dbt_backup"
[0m21:27:26.196975 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:26.197142 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_test"."analytics"."my_second_dbt_model__dbt_backup" cascade
[0m21:27:26.197725 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:27:26.198419 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: Close
[0m21:27:26.198697 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e76a2d9-a2fd-4ee1-b3cd-b45363270479', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106446a30>]}
[0m21:27:26.199005 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.03s]
[0m21:27:26.199276 [debug] [Thread-3 (]: Finished running node model.dbt_test.my_second_dbt_model
[0m21:27:26.199862 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:26.200019 [debug] [MainThread]: On master: BEGIN
[0m21:27:26.200154 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:27:26.212909 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m21:27:26.213141 [debug] [MainThread]: On master: COMMIT
[0m21:27:26.213293 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:26.213438 [debug] [MainThread]: On master: COMMIT
[0m21:27:26.213929 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:27:26.214077 [debug] [MainThread]: On master: Close
[0m21:27:26.214294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:26.214442 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:27:26.214569 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:27:26.214677 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m21:27:26.214845 [info ] [MainThread]: 
[0m21:27:26.215003 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m21:27:26.215423 [debug] [MainThread]: Command end result
[0m21:27:26.227228 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:27:26.228122 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:27:26.231040 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:27:26.231199 [info ] [MainThread]: 
[0m21:27:26.231375 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:27:26.231522 [info ] [MainThread]: 
[0m21:27:26.231686 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m21:27:26.233477 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8689767, "process_in_blocks": "0", "process_kernel_time": 0.156236, "process_mem_max_rss": "132956160", "process_out_blocks": "0", "process_user_time": 1.211609}
[0m21:27:26.233704 [debug] [MainThread]: Command `dbt run` succeeded at 21:27:26.233664 after 0.87 seconds
[0m21:27:26.233876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083889d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d97d20>]}
[0m21:27:26.234043 [debug] [MainThread]: Flushing usage events
[0m21:27:26.650676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:32.765395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4bb10>]}


============================== 21:27:32.768147 | 772314b6-60df-433b-bbef-26f3bea4a657 ==============================
[0m21:27:32.768147 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:27:32.768458 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'version_check': 'True', 'printer_width': '80', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'no_print': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'profiles_dir': '/Users/adil/.dbt', 'static_parser': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'empty': 'False', 'indirect_selection': 'eager'}
[0m21:27:32.849260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '772314b6-60df-433b-bbef-26f3bea4a657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c49d0>]}
[0m21:27:32.876607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '772314b6-60df-433b-bbef-26f3bea4a657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f3790>]}
[0m21:27:32.877710 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:27:32.927926 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:27:33.000974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:27:33.001306 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/staging/stg_customers.sql
[0m21:27:33.112815 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_test.intermediate
- models.dbt_test.marts
[0m21:27:33.118924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '772314b6-60df-433b-bbef-26f3bea4a657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e3050>]}
[0m21:27:33.160045 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:27:33.161036 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:27:33.173972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '772314b6-60df-433b-bbef-26f3bea4a657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c3f20>]}
[0m21:27:33.174218 [info ] [MainThread]: Found 3 models, 4 data tests, 3 sources, 459 macros
[0m21:27:33.174389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '772314b6-60df-433b-bbef-26f3bea4a657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c28670>]}
[0m21:27:33.175257 [info ] [MainThread]: 
[0m21:27:33.175446 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:27:33.175589 [info ] [MainThread]: 
[0m21:27:33.175824 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:27:33.177574 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:27:33.182485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:27:33.230374 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:27:33.230594 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:27:33.230760 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:27:33.230923 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:27:33.231072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:33.231211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:33.276163 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.045 seconds
[0m21:27:33.276377 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.045 seconds
[0m21:27:33.277059 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:27:33.277675 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:27:33.278518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_staging)
[0m21:27:33.278775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics)
[0m21:27:33.281632 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:27:33.282542 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:27:33.282741 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:27:33.282922 [debug] [ThreadPool]: On list_dbt_test_analytics: BEGIN
[0m21:27:33.283064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:33.283195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:33.303497 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m21:27:33.303712 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m21:27:33.303875 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:27:33.304031 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:27:33.304195 [debug] [ThreadPool]: On list_dbt_test_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:27:33.304377 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:27:33.311542 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m21:27:33.311723 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m21:27:33.312785 [debug] [ThreadPool]: On list_dbt_test_analytics: ROLLBACK
[0m21:27:33.313422 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:27:33.314042 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:27:33.314205 [debug] [ThreadPool]: On list_dbt_test_analytics: Close
[0m21:27:33.316787 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:33.316970 [debug] [MainThread]: On master: BEGIN
[0m21:27:33.317117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:33.332004 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m21:27:33.332280 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:33.332510 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:27:33.336997 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m21:27:33.337940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '772314b6-60df-433b-bbef-26f3bea4a657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200b1cc0>]}
[0m21:27:33.338206 [debug] [MainThread]: On master: ROLLBACK
[0m21:27:33.338777 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:33.338938 [debug] [MainThread]: On master: BEGIN
[0m21:27:33.339723 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:27:33.339937 [debug] [MainThread]: On master: COMMIT
[0m21:27:33.340111 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:33.340268 [debug] [MainThread]: On master: COMMIT
[0m21:27:33.340767 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:27:33.340930 [debug] [MainThread]: On master: Close
[0m21:27:33.342530 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_customers
[0m21:27:33.342755 [debug] [Thread-1 (]: Began running node model.dbt_test.my_first_dbt_model
[0m21:27:33.343044 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_staging.stg_customers .................... [RUN]
[0m21:27:33.343360 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m21:27:33.343623 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics, now model.dbt_test.stg_customers)
[0m21:27:33.343875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.my_first_dbt_model)
[0m21:27:33.344125 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_customers
[0m21:27:33.344332 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:27:33.348968 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:27:33.350493 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:27:33.350908 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_customers
[0m21:27:33.357346 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:27:33.380815 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:27:33.381073 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:27:33.381533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:33.381757 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:27:33.381931 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:27:33.382100 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:27:33.382267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:33.382412 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:27:33.395698 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m21:27:33.395900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m21:27:33.396083 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:27:33.396259 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:33.396441 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."analytics_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed;
  );
[0m21:27:33.396655 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:27:33.397574 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: select * from renamed;
                              ^

[0m21:27:33.397783 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: ROLLBACK
[0m21:27:33.398364 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: Close
[0m21:27:33.399215 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m21:27:33.404190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:33.404417 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:27:33.405036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:27:33.406403 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:33.406590 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:27:33.407167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:27:33.415684 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:27:33.415908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:33.416086 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:27:33.416870 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:27:33.419830 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_first_dbt_model__dbt_backup"
[0m21:27:33.422204 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:33.422385 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_test"."analytics"."my_first_dbt_model__dbt_backup" cascade
[0m21:27:33.425296 [debug] [Thread-2 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 21: select * from renamed;
                                ^
  compiled code at target/run/dbt_test/models/staging/stg_customers.sql
[0m21:27:33.425516 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:27:33.427199 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: Close
[0m21:27:33.427680 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '772314b6-60df-433b-bbef-26f3bea4a657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d63710>]}
[0m21:27:33.428009 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model analytics_staging.stg_customers ........... [[31mERROR[0m in 0.08s]
[0m21:27:33.428304 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_customers
[0m21:27:33.428538 [debug] [Thread-7 (]: Marking all children of 'model.dbt_test.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 21: select * from renamed;
                                ^
  compiled code at target/run/dbt_test/models/staging/stg_customers.sql.
[0m21:27:33.428707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '772314b6-60df-433b-bbef-26f3bea4a657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0f120>]}
[0m21:27:33.429318 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.08s]
[0m21:27:33.429623 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:27:33.430087 [debug] [Thread-3 (]: Began running node model.dbt_test.my_second_dbt_model
[0m21:27:33.430310 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m21:27:33.430551 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_test.my_second_dbt_model'
[0m21:27:33.430713 [debug] [Thread-3 (]: Began compiling node model.dbt_test.my_second_dbt_model
[0m21:27:33.432192 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m21:27:33.432521 [debug] [Thread-3 (]: Began executing node model.dbt_test.my_second_dbt_model
[0m21:27:33.434020 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m21:27:33.434321 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:33.434564 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m21:27:33.434766 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:27:33.450708 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m21:27:33.450983 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:33.451185 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_test"."analytics"."my_first_dbt_model"
where id = 1
  );
[0m21:27:33.454121 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:27:33.455742 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:33.455934 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:27:33.456565 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:27:33.457329 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:27:33.457526 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:33.457689 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:27:33.458610 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:27:33.459904 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics"."my_second_dbt_model__dbt_backup"
[0m21:27:33.461388 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:33.461573 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_test"."analytics"."my_second_dbt_model__dbt_backup" cascade
[0m21:27:33.462063 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:27:33.462693 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: Close
[0m21:27:33.462963 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '772314b6-60df-433b-bbef-26f3bea4a657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202e9b30>]}
[0m21:27:33.463266 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.03s]
[0m21:27:33.463529 [debug] [Thread-3 (]: Finished running node model.dbt_test.my_second_dbt_model
[0m21:27:33.464125 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:33.464303 [debug] [MainThread]: On master: BEGIN
[0m21:27:33.464448 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:27:33.476053 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m21:27:33.476320 [debug] [MainThread]: On master: COMMIT
[0m21:27:33.476516 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:33.476683 [debug] [MainThread]: On master: COMMIT
[0m21:27:33.477198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:27:33.477370 [debug] [MainThread]: On master: Close
[0m21:27:33.477603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:33.477755 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:27:33.477879 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:27:33.477999 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m21:27:33.478181 [info ] [MainThread]: 
[0m21:27:33.478340 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m21:27:33.478774 [debug] [MainThread]: Command end result
[0m21:27:33.492268 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:27:33.493189 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:27:33.496434 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:27:33.496619 [info ] [MainThread]: 
[0m21:27:33.496802 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:27:33.496955 [info ] [MainThread]: 
[0m21:27:33.497144 [error] [MainThread]: [31mFailure in model stg_customers (models/staging/stg_customers.sql)[0m
[0m21:27:33.497337 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 21: select * from renamed;
                                ^
  compiled code at target/run/dbt_test/models/staging/stg_customers.sql
[0m21:27:33.497472 [info ] [MainThread]: 
[0m21:27:33.497630 [info ] [MainThread]:   compiled code at target/compiled/dbt_test/models/staging/stg_customers.sql
[0m21:27:33.497768 [info ] [MainThread]: 
[0m21:27:33.497925 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m21:27:33.499676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7691674, "process_in_blocks": "0", "process_kernel_time": 0.151886, "process_mem_max_rss": "132349952", "process_out_blocks": "0", "process_user_time": 1.168065}
[0m21:27:33.499936 [debug] [MainThread]: Command `dbt run` failed at 21:27:33.499889 after 0.77 seconds
[0m21:27:33.500143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033c9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc47c0>]}
[0m21:27:33.500352 [debug] [MainThread]: Flushing usage events
[0m21:27:33.899169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:39.342424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aff890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106affb10>]}


============================== 21:27:39.345071 | 34f69329-65d2-458a-842c-e143ee2c9976 ==============================
[0m21:27:39.345071 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:27:39.345381 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/adil/.dbt', 'partial_parse': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'log_format': 'default', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_cache_events': 'False', 'empty': 'False', 'target_path': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs'}
[0m21:27:39.429072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34f69329-65d2-458a-842c-e143ee2c9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7c9d0>]}
[0m21:27:39.457237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34f69329-65d2-458a-842c-e143ee2c9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ab790>]}
[0m21:27:39.458427 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:27:39.509212 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:27:39.581852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:27:39.582163 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/staging/stg_customers.sql
[0m21:27:39.692605 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_test.intermediate
- models.dbt_test.marts
[0m21:27:39.698711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34f69329-65d2-458a-842c-e143ee2c9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a47050>]}
[0m21:27:39.738297 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:27:39.739246 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:27:39.751946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34f69329-65d2-458a-842c-e143ee2c9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a27f20>]}
[0m21:27:39.752183 [info ] [MainThread]: Found 3 models, 4 data tests, 3 sources, 459 macros
[0m21:27:39.752357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34f69329-65d2-458a-842c-e143ee2c9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8c670>]}
[0m21:27:39.753259 [info ] [MainThread]: 
[0m21:27:39.753436 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:27:39.753574 [info ] [MainThread]: 
[0m21:27:39.753802 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:27:39.755558 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:27:39.760426 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:27:39.809658 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:27:39.809903 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:27:39.810084 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:27:39.810252 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:27:39.810418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:39.810564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:39.856093 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.046 seconds
[0m21:27:39.856299 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.046 seconds
[0m21:27:39.856996 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:27:39.857577 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:27:39.858436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_staging)
[0m21:27:39.861472 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:27:39.861694 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:27:39.861909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics)
[0m21:27:39.862074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:39.862999 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:27:39.863221 [debug] [ThreadPool]: On list_dbt_test_analytics: BEGIN
[0m21:27:39.863357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:39.878615 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:27:39.878800 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m21:27:39.878966 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:27:39.879129 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:27:39.879294 [debug] [ThreadPool]: On list_dbt_test_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:27:39.879470 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:27:39.885097 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m21:27:39.885275 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m21:27:39.886270 [debug] [ThreadPool]: On list_dbt_test_analytics: ROLLBACK
[0m21:27:39.886874 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:27:39.887429 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:27:39.887596 [debug] [ThreadPool]: On list_dbt_test_analytics: Close
[0m21:27:39.890061 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:39.890231 [debug] [MainThread]: On master: BEGIN
[0m21:27:39.890373 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:39.905277 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m21:27:39.905529 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:39.905762 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:27:39.912592 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m21:27:39.913548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34f69329-65d2-458a-842c-e143ee2c9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f99d90>]}
[0m21:27:39.913823 [debug] [MainThread]: On master: ROLLBACK
[0m21:27:39.914612 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:39.914821 [debug] [MainThread]: On master: BEGIN
[0m21:27:39.916051 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:27:39.916273 [debug] [MainThread]: On master: COMMIT
[0m21:27:39.916459 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:39.916623 [debug] [MainThread]: On master: COMMIT
[0m21:27:39.917311 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:27:39.917489 [debug] [MainThread]: On master: Close
[0m21:27:39.919579 [debug] [Thread-1 (]: Began running node model.dbt_test.my_first_dbt_model
[0m21:27:39.920274 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_customers
[0m21:27:39.920590 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m21:27:39.921484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.my_first_dbt_model)
[0m21:27:39.920887 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_staging.stg_customers .................... [RUN]
[0m21:27:39.921862 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:27:39.922134 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics, now model.dbt_test.stg_customers)
[0m21:27:39.926767 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:27:39.927050 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_customers
[0m21:27:39.929379 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:27:39.929909 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:27:39.930154 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_customers
[0m21:27:39.958232 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:27:39.962248 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:27:39.962698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:39.962878 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:27:39.963037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:39.963321 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:27:39.963509 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:27:39.963670 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:27:39.975956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m21:27:39.976209 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m21:27:39.976413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:39.976601 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:27:39.976779 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:27:39.976969 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."analytics_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:27:39.979446 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.002 seconds
[0m21:27:39.984552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:39.984771 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m21:27:39.984973 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:27:39.986392 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:27:39.986611 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:27:39.987072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:27:39.988545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:39.988751 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:27:39.988918 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:27:39.990116 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:27:39.990315 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:27:39.990726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:27:39.990910 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:27:39.998780 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:27:39.999507 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:27:39.999689 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:39.999847 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:27:40.000021 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:27:40.000175 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:27:40.001112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:27:40.001331 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:27:40.004492 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_first_dbt_model__dbt_backup"
[0m21:27:40.005511 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_customers__dbt_backup"
[0m21:27:40.007855 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:27:40.009092 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:27:40.009281 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_test"."analytics"."my_first_dbt_model__dbt_backup" cascade
[0m21:27:40.009468 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."analytics_staging"."stg_customers__dbt_backup" cascade
[0m21:27:40.010642 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:27:40.011801 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: Close
[0m21:27:40.011992 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:27:40.012620 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: Close
[0m21:27:40.013733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f69329-65d2-458a-842c-e143ee2c9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da3b90>]}
[0m21:27:40.013919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f69329-65d2-458a-842c-e143ee2c9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfb8b0>]}
[0m21:27:40.014274 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_staging.stg_customers ............... [[32mCREATE VIEW[0m in 0.09s]
[0m21:27:40.014781 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_customers
[0m21:27:40.014495 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.09s]
[0m21:27:40.015120 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:27:40.015447 [debug] [Thread-3 (]: Began running node model.dbt_test.my_second_dbt_model
[0m21:27:40.015665 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m21:27:40.015920 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_test.my_second_dbt_model'
[0m21:27:40.016078 [debug] [Thread-3 (]: Began compiling node model.dbt_test.my_second_dbt_model
[0m21:27:40.017537 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m21:27:40.017882 [debug] [Thread-3 (]: Began executing node model.dbt_test.my_second_dbt_model
[0m21:27:40.019366 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m21:27:40.019681 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:40.019842 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m21:27:40.019988 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:27:40.031111 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m21:27:40.031360 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:40.031542 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_test"."analytics"."my_first_dbt_model"
where id = 1
  );
[0m21:27:40.033436 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:27:40.035177 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:40.035388 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:27:40.036286 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:27:40.037066 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:27:40.037255 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:40.037397 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:27:40.038469 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:27:40.039426 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics"."my_second_dbt_model__dbt_backup"
[0m21:27:40.039757 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:27:40.039916 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_test"."analytics"."my_second_dbt_model__dbt_backup" cascade
[0m21:27:40.040392 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:27:40.041051 [debug] [Thread-3 (]: On model.dbt_test.my_second_dbt_model: Close
[0m21:27:40.041324 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f69329-65d2-458a-842c-e143ee2c9976', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10821ceb0>]}
[0m21:27:40.041624 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.03s]
[0m21:27:40.041894 [debug] [Thread-3 (]: Finished running node model.dbt_test.my_second_dbt_model
[0m21:27:40.042438 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:40.042575 [debug] [MainThread]: On master: BEGIN
[0m21:27:40.042699 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:27:40.053471 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m21:27:40.053669 [debug] [MainThread]: On master: COMMIT
[0m21:27:40.053814 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:40.053944 [debug] [MainThread]: On master: COMMIT
[0m21:27:40.054687 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:27:40.054882 [debug] [MainThread]: On master: Close
[0m21:27:40.055190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:40.055361 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:27:40.055490 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:27:40.055611 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m21:27:40.055784 [info ] [MainThread]: 
[0m21:27:40.055942 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m21:27:40.056380 [debug] [MainThread]: Command end result
[0m21:27:40.070158 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:27:40.071093 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:27:40.074346 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:27:40.074516 [info ] [MainThread]: 
[0m21:27:40.074698 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:27:40.074843 [info ] [MainThread]: 
[0m21:27:40.075000 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m21:27:40.076719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7684215, "process_in_blocks": "0", "process_kernel_time": 0.151725, "process_mem_max_rss": "134168576", "process_out_blocks": "0", "process_user_time": 1.18741}
[0m21:27:40.076969 [debug] [MainThread]: Command `dbt run` succeeded at 21:27:40.076921 after 0.77 seconds
[0m21:27:40.077156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104515050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e076d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b847c0>]}
[0m21:27:40.077337 [debug] [MainThread]: Flushing usage events
[0m21:27:40.462954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:15.204097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104154590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f87890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f87b10>]}


============================== 21:28:15.207494 | f666ff4d-868c-469c-82bc-dc267aa38533 ==============================
[0m21:28:15.207494 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:28:15.207825 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'empty': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/adil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_format': 'default', 'introspect': 'True', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'quiet': 'False', 'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m21:28:15.304454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f666ff4d-868c-469c-82bc-dc267aa38533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043009d0>]}
[0m21:28:15.332094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f666ff4d-868c-469c-82bc-dc267aa38533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2f790>]}
[0m21:28:15.332654 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:28:15.382648 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:28:15.465579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:28:15.465918 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/staging/stg_orders.sql
[0m21:28:15.580787 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_test.intermediate
- models.dbt_test.marts
[0m21:28:15.586893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f666ff4d-868c-469c-82bc-dc267aa38533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecb250>]}
[0m21:28:15.628092 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:28:15.629768 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:28:15.645513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f666ff4d-868c-469c-82bc-dc267aa38533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea7f20>]}
[0m21:28:15.645790 [info ] [MainThread]: Found 4 models, 4 data tests, 3 sources, 459 macros
[0m21:28:15.645962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f666ff4d-868c-469c-82bc-dc267aa38533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106110910>]}
[0m21:28:15.646862 [info ] [MainThread]: 
[0m21:28:15.647051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:28:15.647193 [info ] [MainThread]: 
[0m21:28:15.647439 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:28:15.649253 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:28:15.654325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:28:15.722665 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:28:15.722892 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:28:15.723060 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:28:15.723221 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:28:15.723373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:15.723511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:15.781240 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.058 seconds
[0m21:28:15.781502 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.058 seconds
[0m21:28:15.782229 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:28:15.782826 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:28:15.783800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics)
[0m21:28:15.786820 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:28:15.787114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_staging)
[0m21:28:15.787311 [debug] [ThreadPool]: On list_dbt_test_analytics: BEGIN
[0m21:28:15.788236 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:28:15.788393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:15.788541 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:28:15.788737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:15.803133 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m21:28:15.803365 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:28:15.803531 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:28:15.803683 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:28:15.803839 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:28:15.804041 [debug] [ThreadPool]: On list_dbt_test_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:28:15.810581 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m21:28:15.810777 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m21:28:15.811840 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:28:15.812473 [debug] [ThreadPool]: On list_dbt_test_analytics: ROLLBACK
[0m21:28:15.813238 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:28:15.813402 [debug] [ThreadPool]: On list_dbt_test_analytics: Close
[0m21:28:15.816271 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:15.816460 [debug] [MainThread]: On master: BEGIN
[0m21:28:15.816610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:28:15.829317 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m21:28:15.829477 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:15.829669 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:28:15.834500 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m21:28:15.835394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f666ff4d-868c-469c-82bc-dc267aa38533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106421640>]}
[0m21:28:15.835665 [debug] [MainThread]: On master: ROLLBACK
[0m21:28:15.836258 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:15.836431 [debug] [MainThread]: On master: BEGIN
[0m21:28:15.837291 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:28:15.837449 [debug] [MainThread]: On master: COMMIT
[0m21:28:15.837599 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:15.837745 [debug] [MainThread]: On master: COMMIT
[0m21:28:15.838201 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:28:15.838350 [debug] [MainThread]: On master: Close
[0m21:28:15.840371 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_customers
[0m21:28:15.840586 [debug] [Thread-3 (]: Began running node model.dbt_test.stg_orders
[0m21:28:15.840768 [debug] [Thread-1 (]: Began running node model.dbt_test.my_first_dbt_model
[0m21:28:15.841020 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_staging.stg_customers .................... [RUN]
[0m21:28:15.841287 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m21:28:15.841535 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m21:28:15.841791 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.stg_customers)
[0m21:28:15.842090 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_test.stg_orders'
[0m21:28:15.842310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics, now model.dbt_test.my_first_dbt_model)
[0m21:28:15.842593 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_customers
[0m21:28:15.842826 [debug] [Thread-3 (]: Began compiling node model.dbt_test.stg_orders
[0m21:28:15.843003 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:28:15.847817 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:28:15.849372 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.stg_orders"
[0m21:28:15.850710 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:28:15.851251 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:28:15.851460 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_customers
[0m21:28:15.862890 [debug] [Thread-3 (]: Began executing node model.dbt_test.stg_orders
[0m21:28:15.871450 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:28:15.880199 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:28:15.881775 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.stg_orders"
[0m21:28:15.882324 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:28:15.882585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:28:15.882805 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:28:15.882993 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:28:15.883178 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:28:15.883331 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: BEGIN
[0m21:28:15.883480 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:28:15.883643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:15.883831 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:28:15.899798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m21:28:15.900015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:28:15.900208 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m21:28:15.900417 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:28:15.900627 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:28:15.900849 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */

  create view "dbt_test"."analytics_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."orders"
),
casted as (
    select
        id           as order_id,
        user_id      as customer_id,
        order_date::timestamp as order_timestamp,
        lower(status) as status,
        total_amount::numeric(10,2) as total_amount
    from source
)
select * from casted;
  );
[0m21:28:15.901504 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m21:28:15.901757 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:28:15.901972 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: select * from casted;
                             ^

[0m21:28:15.902183 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."analytics_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:28:15.902394 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: ROLLBACK
[0m21:28:15.902988 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: Close
[0m21:28:15.904181 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m21:28:15.909281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:28:15.909484 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m21:28:15.909695 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:28:15.911079 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:28:15.911310 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:28:15.911857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:28:15.913412 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:28:15.913601 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:28:15.913786 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:28:15.915087 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:28:15.915302 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:28:15.915735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:28:15.915906 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:28:15.924169 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:28:15.925005 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:28:15.925229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:28:15.925428 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:28:15.925628 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:28:15.925802 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:28:15.926947 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:28:15.930139 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_first_dbt_model__dbt_backup"
[0m21:28:15.932452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:28:15.932645 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_test"."analytics"."my_first_dbt_model__dbt_backup" cascade
[0m21:28:15.932821 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m21:28:15.933871 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_customers__dbt_backup"
[0m21:28:15.935281 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:28:15.935564 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."analytics_staging"."stg_customers__dbt_backup" cascade
[0m21:28:15.935762 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:28:15.937299 [debug] [Thread-3 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from casted;
                               ^
  compiled code at target/run/dbt_test/models/staging/stg_orders.sql
[0m21:28:15.937484 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:28:15.938608 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: Close
[0m21:28:15.939543 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: Close
[0m21:28:15.940246 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f666ff4d-868c-469c-82bc-dc267aa38533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663c4d0>]}
[0m21:28:15.940447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f666ff4d-868c-469c-82bc-dc267aa38533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106283cd0>]}
[0m21:28:15.940650 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f666ff4d-868c-469c-82bc-dc267aa38533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104284370>]}
[0m21:28:15.940916 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model analytics_staging.stg_orders .............. [[31mERROR[0m in 0.10s]
[0m21:28:15.941507 [debug] [Thread-3 (]: Finished running node model.dbt_test.stg_orders
[0m21:28:15.941168 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.10s]
[0m21:28:15.941783 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_staging.stg_customers ............... [[32mCREATE VIEW[0m in 0.10s]
[0m21:28:15.942052 [debug] [Thread-7 (]: Marking all children of 'model.dbt_test.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from casted;
                               ^
  compiled code at target/run/dbt_test/models/staging/stg_orders.sql.
[0m21:28:15.942296 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:28:15.942531 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_customers
[0m21:28:15.943108 [debug] [Thread-4 (]: Began running node model.dbt_test.my_second_dbt_model
[0m21:28:15.943336 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m21:28:15.943574 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_test.my_second_dbt_model'
[0m21:28:15.943734 [debug] [Thread-4 (]: Began compiling node model.dbt_test.my_second_dbt_model
[0m21:28:15.945222 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m21:28:15.945544 [debug] [Thread-4 (]: Began executing node model.dbt_test.my_second_dbt_model
[0m21:28:15.947146 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m21:28:15.947492 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:28:15.947663 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m21:28:15.947818 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:28:15.959411 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m21:28:15.959632 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:28:15.959808 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_test"."analytics"."my_first_dbt_model"
where id = 1
  );
[0m21:28:15.962254 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:28:15.963628 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:28:15.963808 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:28:15.964466 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:28:15.965154 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:28:15.965328 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:28:15.965497 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:28:15.966310 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m21:28:15.967544 [debug] [Thread-4 (]: Applying DROP to: "dbt_test"."analytics"."my_second_dbt_model__dbt_backup"
[0m21:28:15.967875 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:28:15.968044 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_test"."analytics"."my_second_dbt_model__dbt_backup" cascade
[0m21:28:15.968672 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:28:15.969240 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: Close
[0m21:28:15.969497 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f666ff4d-868c-469c-82bc-dc267aa38533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106708a50>]}
[0m21:28:15.969788 [info ] [Thread-4 (]: 4 of 4 OK created sql view model analytics.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.03s]
[0m21:28:15.970045 [debug] [Thread-4 (]: Finished running node model.dbt_test.my_second_dbt_model
[0m21:28:15.970702 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:15.970849 [debug] [MainThread]: On master: BEGIN
[0m21:28:15.970973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:28:15.983454 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m21:28:15.983721 [debug] [MainThread]: On master: COMMIT
[0m21:28:15.983904 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:15.984043 [debug] [MainThread]: On master: COMMIT
[0m21:28:15.984529 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:28:15.984673 [debug] [MainThread]: On master: Close
[0m21:28:15.984880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:15.985025 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:28:15.985142 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:28:15.985251 [debug] [MainThread]: Connection 'model.dbt_test.stg_orders' was properly closed.
[0m21:28:15.985361 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m21:28:15.985536 [info ] [MainThread]: 
[0m21:28:15.985737 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m21:28:15.986475 [debug] [MainThread]: Command end result
[0m21:28:16.000179 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:28:16.001133 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:28:16.004439 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:28:16.004672 [info ] [MainThread]: 
[0m21:28:16.004876 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:28:16.005062 [info ] [MainThread]: 
[0m21:28:16.005255 [error] [MainThread]: [31mFailure in model stg_orders (models/staging/stg_orders.sql)[0m
[0m21:28:16.005433 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  syntax error at or near ";"
  LINE 21: select * from casted;
                               ^
  compiled code at target/run/dbt_test/models/staging/stg_orders.sql
[0m21:28:16.005569 [info ] [MainThread]: 
[0m21:28:16.005729 [info ] [MainThread]:   compiled code at target/compiled/dbt_test/models/staging/stg_orders.sql
[0m21:28:16.005864 [info ] [MainThread]: 
[0m21:28:16.006018 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m21:28:16.007682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8413625, "process_in_blocks": "0", "process_kernel_time": 0.189131, "process_mem_max_rss": "131989504", "process_out_blocks": "0", "process_user_time": 1.22495}
[0m21:28:16.007937 [debug] [MainThread]: Command `dbt run` failed at 21:28:16.007891 after 0.84 seconds
[0m21:28:16.008136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050047c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b17d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f1490>]}
[0m21:28:16.008322 [debug] [MainThread]: Flushing usage events
[0m21:28:16.453923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:21.601959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e64590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c93890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c93b10>]}


============================== 21:28:21.604724 | 73e0d467-3c1b-4888-a54b-46b1a22d7923 ==============================
[0m21:28:21.604724 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:28:21.605041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'version_check': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'write_json': 'True', 'static_parser': 'True', 'log_format': 'default', 'warn_error': 'None', 'debug': 'False', 'target_path': 'None', 'empty': 'False', 'profiles_dir': '/Users/adil/.dbt'}
[0m21:28:21.687948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73e0d467-3c1b-4888-a54b-46b1a22d7923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080109d0>]}
[0m21:28:21.715301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73e0d467-3c1b-4888-a54b-46b1a22d7923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b3f790>]}
[0m21:28:21.716488 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:28:21.766942 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:28:21.842645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:28:21.842981 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/staging/stg_orders.sql
[0m21:28:21.955555 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_test.intermediate
- models.dbt_test.marts
[0m21:28:21.961555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73e0d467-3c1b-4888-a54b-46b1a22d7923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bdb350>]}
[0m21:28:22.002697 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:28:22.003648 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:28:22.016224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73e0d467-3c1b-4888-a54b-46b1a22d7923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bbbd40>]}
[0m21:28:22.016469 [info ] [MainThread]: Found 4 models, 4 data tests, 3 sources, 459 macros
[0m21:28:22.016645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73e0d467-3c1b-4888-a54b-46b1a22d7923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e20910>]}
[0m21:28:22.017536 [info ] [MainThread]: 
[0m21:28:22.017721 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:28:22.017859 [info ] [MainThread]: 
[0m21:28:22.018091 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:28:22.019921 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:28:22.024899 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:28:22.073768 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:28:22.074020 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:28:22.074207 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:28:22.074385 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:28:22.074543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:22.074721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:22.117393 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.043 seconds
[0m21:28:22.117632 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.043 seconds
[0m21:28:22.118354 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:28:22.118959 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:28:22.119892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_staging)
[0m21:28:22.120182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics)
[0m21:28:22.123247 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:28:22.124222 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:28:22.124403 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:28:22.124583 [debug] [ThreadPool]: On list_dbt_test_analytics: BEGIN
[0m21:28:22.124764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:22.124921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:22.141091 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m21:28:22.141301 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m21:28:22.141460 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:28:22.141611 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:28:22.141781 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:28:22.141969 [debug] [ThreadPool]: On list_dbt_test_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:28:22.147071 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m21:28:22.147240 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m21:28:22.148279 [debug] [ThreadPool]: On list_dbt_test_analytics: ROLLBACK
[0m21:28:22.148887 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:28:22.149501 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:28:22.149659 [debug] [ThreadPool]: On list_dbt_test_analytics: Close
[0m21:28:22.152292 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:22.152474 [debug] [MainThread]: On master: BEGIN
[0m21:28:22.152638 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:28:22.165507 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m21:28:22.165699 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:22.165903 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:28:22.169997 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m21:28:22.170810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73e0d467-3c1b-4888-a54b-46b1a22d7923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a131710>]}
[0m21:28:22.171058 [debug] [MainThread]: On master: ROLLBACK
[0m21:28:22.171627 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:22.171817 [debug] [MainThread]: On master: BEGIN
[0m21:28:22.172613 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:28:22.172773 [debug] [MainThread]: On master: COMMIT
[0m21:28:22.172921 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:22.173060 [debug] [MainThread]: On master: COMMIT
[0m21:28:22.173634 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:28:22.173784 [debug] [MainThread]: On master: Close
[0m21:28:22.175867 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_customers
[0m21:28:22.176079 [debug] [Thread-3 (]: Began running node model.dbt_test.stg_orders
[0m21:28:22.176259 [debug] [Thread-1 (]: Began running node model.dbt_test.my_first_dbt_model
[0m21:28:22.176520 [info ] [Thread-2 (]: 2 of 4 START sql view model analytics_staging.stg_customers .................... [RUN]
[0m21:28:22.176765 [info ] [Thread-3 (]: 3 of 4 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m21:28:22.177277 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics, now model.dbt_test.stg_customers)
[0m21:28:22.177026 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m21:28:22.177577 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_test.stg_orders'
[0m21:28:22.177811 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_customers
[0m21:28:22.178074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.my_first_dbt_model)
[0m21:28:22.178298 [debug] [Thread-3 (]: Began compiling node model.dbt_test.stg_orders
[0m21:28:22.182822 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:28:22.183172 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:28:22.184969 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.stg_orders"
[0m21:28:22.187751 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:28:22.188265 [debug] [Thread-3 (]: Began executing node model.dbt_test.stg_orders
[0m21:28:22.194241 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_customers
[0m21:28:22.194443 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:28:22.206370 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.stg_orders"
[0m21:28:22.208070 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:28:22.218080 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:28:22.218497 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:28:22.218697 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: BEGIN
[0m21:28:22.218857 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:28:22.219141 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:28:22.219387 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:28:22.219599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:28:22.219778 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:28:22.219955 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:28:22.220185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:28:22.234417 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m21:28:22.234633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m21:28:22.234815 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m21:28:22.234979 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:28:22.235145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:28:22.235350 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:28:22.235563 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."analytics_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:28:22.235775 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:28:22.236029 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */

  create view "dbt_test"."analytics_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."orders"
),
casted as (
    select
        id           as order_id,
        user_id      as customer_id,
        order_date::timestamp as order_timestamp,
        lower(status) as status,
        total_amount::numeric(10,2) as total_amount
    from source
)
select * from casted
  );
[0m21:28:22.239663 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m21:28:22.245042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:28:22.245258 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m21:28:22.245443 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:28:22.245620 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m21:28:22.247098 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:28:22.248575 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:28:22.248751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:28:22.248942 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:28:22.249105 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."analytics_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:28:22.250426 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:28:22.250657 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:28:22.251147 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:28:22.251376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:28:22.257394 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m21:28:22.259512 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:28:22.261187 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:28:22.262676 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:28:22.262879 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:28:22.263059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:28:22.263249 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:28:22.263440 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:28:22.263622 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:28:22.264344 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:28:22.265181 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:28:22.265348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:28:22.265501 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:28:22.265649 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m21:28:22.268466 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_first_dbt_model__dbt_backup"
[0m21:28:22.268653 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:28:22.269638 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_orders__dbt_backup"
[0m21:28:22.272116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:28:22.273546 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:28:22.273744 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:28:22.273919 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_test"."analytics"."my_first_dbt_model__dbt_backup" cascade
[0m21:28:22.274110 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
drop view if exists "dbt_test"."analytics_staging"."stg_orders__dbt_backup" cascade
[0m21:28:22.275170 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_customers__dbt_backup"
[0m21:28:22.275564 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:28:22.275729 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."analytics_staging"."stg_customers__dbt_backup" cascade
[0m21:28:22.275907 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:28:22.277101 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: Close
[0m21:28:22.277291 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:28:22.277467 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:28:22.278065 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: Close
[0m21:28:22.279019 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: Close
[0m21:28:22.279889 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73e0d467-3c1b-4888-a54b-46b1a22d7923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a38c710>]}
[0m21:28:22.280083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73e0d467-3c1b-4888-a54b-46b1a22d7923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fabe30>]}
[0m21:28:22.280375 [info ] [Thread-3 (]: 3 of 4 OK created sql view model analytics_staging.stg_orders .................. [[32mCREATE VIEW[0m in 0.10s]
[0m21:28:22.280655 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.10s]
[0m21:28:22.280897 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73e0d467-3c1b-4888-a54b-46b1a22d7923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f94370>]}
[0m21:28:22.281134 [debug] [Thread-3 (]: Finished running node model.dbt_test.stg_orders
[0m21:28:22.281360 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:28:22.281610 [info ] [Thread-2 (]: 2 of 4 OK created sql view model analytics_staging.stg_customers ............... [[32mCREATE VIEW[0m in 0.10s]
[0m21:28:22.282036 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_customers
[0m21:28:22.282237 [debug] [Thread-4 (]: Began running node model.dbt_test.my_second_dbt_model
[0m21:28:22.282477 [info ] [Thread-4 (]: 4 of 4 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m21:28:22.282724 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_test.my_second_dbt_model'
[0m21:28:22.282891 [debug] [Thread-4 (]: Began compiling node model.dbt_test.my_second_dbt_model
[0m21:28:22.284099 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m21:28:22.284432 [debug] [Thread-4 (]: Began executing node model.dbt_test.my_second_dbt_model
[0m21:28:22.286319 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m21:28:22.286655 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:28:22.286832 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m21:28:22.286991 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:28:22.298056 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m21:28:22.298302 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:28:22.298476 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_test"."analytics"."my_first_dbt_model"
where id = 1
  );
[0m21:28:22.300857 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:28:22.302460 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:28:22.302683 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:28:22.303358 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:28:22.304106 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:28:22.304290 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:28:22.304470 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:28:22.305288 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m21:28:22.308731 [debug] [Thread-4 (]: Applying DROP to: "dbt_test"."analytics"."my_second_dbt_model__dbt_backup"
[0m21:28:22.309084 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:28:22.309255 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_test"."analytics"."my_second_dbt_model__dbt_backup" cascade
[0m21:28:22.309773 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:28:22.310422 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: Close
[0m21:28:22.310683 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73e0d467-3c1b-4888-a54b-46b1a22d7923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d19ed0>]}
[0m21:28:22.310979 [info ] [Thread-4 (]: 4 of 4 OK created sql view model analytics.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.03s]
[0m21:28:22.311235 [debug] [Thread-4 (]: Finished running node model.dbt_test.my_second_dbt_model
[0m21:28:22.311811 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:22.311960 [debug] [MainThread]: On master: BEGIN
[0m21:28:22.312089 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:28:22.324112 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m21:28:22.324341 [debug] [MainThread]: On master: COMMIT
[0m21:28:22.324500 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:22.324636 [debug] [MainThread]: On master: COMMIT
[0m21:28:22.325119 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:28:22.325257 [debug] [MainThread]: On master: Close
[0m21:28:22.325463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:22.325607 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:28:22.325736 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:28:22.325852 [debug] [MainThread]: Connection 'model.dbt_test.stg_orders' was properly closed.
[0m21:28:22.325969 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m21:28:22.326150 [info ] [MainThread]: 
[0m21:28:22.326309 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m21:28:22.326803 [debug] [MainThread]: Command end result
[0m21:28:22.338048 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:28:22.339001 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:28:22.342778 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:28:22.342948 [info ] [MainThread]: 
[0m21:28:22.343125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:28:22.343267 [info ] [MainThread]: 
[0m21:28:22.343425 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:28:22.345394 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.776975, "process_in_blocks": "0", "process_kernel_time": 0.151589, "process_mem_max_rss": "133677056", "process_out_blocks": "0", "process_user_time": 1.184424}
[0m21:28:22.345602 [debug] [MainThread]: Command `dbt run` succeeded at 21:28:22.345564 after 0.78 seconds
[0m21:28:22.345781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d147c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104933d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b32870>]}
[0m21:28:22.345956 [debug] [MainThread]: Flushing usage events
[0m21:28:22.744818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:33:22.244550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106428590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725bb10>]}


============================== 21:33:22.247626 | ad256638-bf3a-471f-8e26-948530e8c128 ==============================
[0m21:33:22.247626 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:33:22.247980 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'introspect': 'True', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'invocation_command': 'dbt run', 'target_path': 'None', 'version_check': 'True', 'log_format': 'default', 'warn_error': 'None', 'quiet': 'False', 'printer_width': '80', 'profiles_dir': '/Users/adil/.dbt', 'log_cache_events': 'False', 'no_print': 'None', 'fail_fast': 'False', 'empty': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'debug': 'False'}
[0m21:33:22.349748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad256638-bf3a-471f-8e26-948530e8c128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d49d0>]}
[0m21:33:22.379582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad256638-bf3a-471f-8e26-948530e8c128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107103790>]}
[0m21:33:22.380273 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:33:22.437437 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:33:22.513952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:33:22.514229 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/staging/stg_payments.sql
[0m21:33:22.629277 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_test.marts
- models.dbt_test.intermediate
[0m21:33:22.635242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad256638-bf3a-471f-8e26-948530e8c128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10819f350>]}
[0m21:33:22.676087 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:33:22.677285 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:33:22.692021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad256638-bf3a-471f-8e26-948530e8c128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817ff20>]}
[0m21:33:22.692267 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 459 macros
[0m21:33:22.692440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad256638-bf3a-471f-8e26-948530e8c128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e4910>]}
[0m21:33:22.693351 [info ] [MainThread]: 
[0m21:33:22.693527 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:22.693665 [info ] [MainThread]: 
[0m21:33:22.693897 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:33:22.695847 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:33:22.700750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:33:22.769187 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:33:22.769413 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:33:22.769583 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:33:22.769748 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:33:22.769898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:22.770033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:22.848435 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.078 seconds
[0m21:33:22.848733 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.079 seconds
[0m21:33:22.849592 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:33:22.850307 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:33:22.851442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics)
[0m21:33:22.851765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_staging)
[0m21:33:22.857135 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:33:22.858638 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:33:22.858849 [debug] [ThreadPool]: On list_dbt_test_analytics: BEGIN
[0m21:33:22.859025 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:33:22.859189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:22.859344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:22.881410 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:33:22.881774 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:33:22.882033 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m21:33:22.882397 [debug] [ThreadPool]: On list_dbt_test_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:33:22.882622 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:33:22.882916 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:33:22.893450 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m21:33:22.893883 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m21:33:22.895319 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:33:22.896077 [debug] [ThreadPool]: On list_dbt_test_analytics: ROLLBACK
[0m21:33:22.896868 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:33:22.897074 [debug] [ThreadPool]: On list_dbt_test_analytics: Close
[0m21:33:22.900388 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:22.900803 [debug] [MainThread]: On master: BEGIN
[0m21:33:22.900994 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:22.915433 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m21:33:22.915722 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:22.915951 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:33:22.921276 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m21:33:22.922226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad256638-bf3a-471f-8e26-948530e8c128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f1710>]}
[0m21:33:22.922512 [debug] [MainThread]: On master: ROLLBACK
[0m21:33:22.923151 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:22.923344 [debug] [MainThread]: On master: BEGIN
[0m21:33:22.924281 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:33:22.924446 [debug] [MainThread]: On master: COMMIT
[0m21:33:22.924602 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:22.924748 [debug] [MainThread]: On master: COMMIT
[0m21:33:22.925279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:33:22.925442 [debug] [MainThread]: On master: Close
[0m21:33:22.927795 [debug] [Thread-3 (]: Began running node model.dbt_test.stg_orders
[0m21:33:22.928080 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m21:33:22.928298 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_customers
[0m21:33:22.928554 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_test.stg_orders'
[0m21:33:22.928728 [debug] [Thread-4 (]: Began running node model.dbt_test.stg_payments
[0m21:33:22.928891 [debug] [Thread-1 (]: Began running node model.dbt_test.my_first_dbt_model
[0m21:33:22.929130 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_staging.stg_customers .................... [RUN]
[0m21:33:22.929330 [debug] [Thread-3 (]: Began compiling node model.dbt_test.stg_orders
[0m21:33:22.929548 [info ] [Thread-4 (]: 4 of 5 START sql view model analytics_staging.stg_payments ..................... [RUN]
[0m21:33:22.929772 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m21:33:22.930067 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.stg_customers)
[0m21:33:22.935164 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.stg_orders"
[0m21:33:22.935849 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_test.stg_payments'
[0m21:33:22.936474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics, now model.dbt_test.my_first_dbt_model)
[0m21:33:22.936880 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_customers
[0m21:33:22.937391 [debug] [Thread-4 (]: Began compiling node model.dbt_test.stg_payments
[0m21:33:22.937809 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:33:22.940981 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:33:22.942705 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_test.stg_payments"
[0m21:33:22.944450 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:33:22.944802 [debug] [Thread-3 (]: Began executing node model.dbt_test.stg_orders
[0m21:33:22.956216 [debug] [Thread-4 (]: Began executing node model.dbt_test.stg_payments
[0m21:33:22.966005 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_test.stg_payments"
[0m21:33:22.966267 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:33:22.966461 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_customers
[0m21:33:22.966780 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.stg_orders"
[0m21:33:22.978668 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:33:22.980353 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:33:22.980742 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:33:22.981087 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: BEGIN
[0m21:33:22.981268 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:33:22.981607 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:33:22.981789 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: BEGIN
[0m21:33:22.981986 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:33:22.982158 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:33:22.982352 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:33:22.982532 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:33:22.982771 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:33:22.982949 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:33:22.983146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:23.003030 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m21:33:23.003601 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m21:33:23.003863 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m21:33:23.004060 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:33:23.004256 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:33:23.004438 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:33:23.004751 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */

  create view "dbt_test"."analytics_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."orders"
),
casted as (
    select
        id           as order_id,
        user_id      as customer_id,
        order_date::timestamp as order_timestamp,
        lower(status) as status,
        total_amount::numeric(10,2) as total_amount
    from source
)
select * from casted
  );
[0m21:33:23.004971 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */

  create view "dbt_test"."analytics_staging"."stg_payments__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."payments"
),
casted as (
    select
        id           as payment_id,
        order_id,
        lower(payment_method) as payment_method,
        amount::numeric(10,2) as amount,
        paid_at::timestamp    as paid_at
    from source
)
select * from casted
  );
[0m21:33:23.005210 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."analytics_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:33:23.007708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m21:33:23.007914 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:33:23.008100 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:33:23.010844 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:33:23.011260 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m21:33:23.016288 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:33:23.016510 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m21:33:23.016743 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.008 seconds
[0m21:33:23.018483 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:33:23.018703 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."analytics_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:33:23.020332 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:33:23.023645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:33:23.023853 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:33:23.024087 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."analytics_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:33:23.024285 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:33:23.025925 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:33:23.026127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:33:23.026315 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:33:23.026492 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:33:23.027936 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:33:23.029551 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:33:23.038937 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:33:23.040613 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:33:23.040842 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."analytics_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:33:23.041057 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:33:23.041253 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:33:23.041436 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:33:23.041837 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:33:23.043156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:33:23.045264 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:33:23.045483 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m21:33:23.045688 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m21:33:23.045890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:33:23.046063 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m21:33:23.046884 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:33:23.047686 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:33:23.047900 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:33:23.052110 [debug] [Thread-4 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_payments__dbt_backup"
[0m21:33:23.052328 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:33:23.052527 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:33:23.055194 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:33:23.055410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:33:23.055576 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:33:23.055744 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:33:23.055909 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
drop view if exists "dbt_test"."analytics_staging"."stg_payments__dbt_backup" cascade
[0m21:33:23.057048 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_first_dbt_model__dbt_backup"
[0m21:33:23.058780 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:33:23.058974 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m21:33:23.059176 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:33:23.059379 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m21:33:23.059567 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_test"."analytics"."my_first_dbt_model__dbt_backup" cascade
[0m21:33:23.063139 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_customers__dbt_backup"
[0m21:33:23.064424 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: Close
[0m21:33:23.065526 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_orders__dbt_backup"
[0m21:33:23.066029 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:33:23.067173 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:33:23.067930 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."analytics_staging"."stg_customers__dbt_backup" cascade
[0m21:33:23.068321 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
drop view if exists "dbt_test"."analytics_staging"."stg_orders__dbt_backup" cascade
[0m21:33:23.068673 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad256638-bf3a-471f-8e26-948530e8c128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f7e90>]}
[0m21:33:23.069082 [info ] [Thread-4 (]: 4 of 5 OK created sql view model analytics_staging.stg_payments ................ [[32mCREATE VIEW[0m in 0.13s]
[0m21:33:23.069374 [debug] [Thread-4 (]: Finished running node model.dbt_test.stg_payments
[0m21:33:23.071753 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:33:23.072833 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: Close
[0m21:33:23.073451 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad256638-bf3a-471f-8e26-948530e8c128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108552e60>]}
[0m21:33:23.073872 [info ] [Thread-3 (]: 3 of 5 OK created sql view model analytics_staging.stg_orders .................. [[32mCREATE VIEW[0m in 0.14s]
[0m21:33:23.074145 [debug] [Thread-3 (]: Finished running node model.dbt_test.stg_orders
[0m21:33:23.076146 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m21:33:23.076975 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: Close
[0m21:33:23.077288 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m21:33:23.077919 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: Close
[0m21:33:23.078194 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad256638-bf3a-471f-8e26-948530e8c128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108950730>]}
[0m21:33:23.078477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad256638-bf3a-471f-8e26-948530e8c128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888d5d0>]}
[0m21:33:23.078805 [info ] [Thread-2 (]: 2 of 5 OK created sql view model analytics_staging.stg_customers ............... [[32mCREATE VIEW[0m in 0.15s]
[0m21:33:23.079526 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_customers
[0m21:33:23.079068 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.14s]
[0m21:33:23.080407 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:33:23.081756 [debug] [Thread-4 (]: Began running node model.dbt_test.my_second_dbt_model
[0m21:33:23.082046 [info ] [Thread-4 (]: 5 of 5 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m21:33:23.082285 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_test.stg_payments, now model.dbt_test.my_second_dbt_model)
[0m21:33:23.082701 [debug] [Thread-4 (]: Began compiling node model.dbt_test.my_second_dbt_model
[0m21:33:23.084983 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m21:33:23.085420 [debug] [Thread-4 (]: Began executing node model.dbt_test.my_second_dbt_model
[0m21:33:23.087647 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m21:33:23.088113 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:33:23.088500 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m21:33:23.088850 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:33:23.105599 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m21:33:23.105919 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:33:23.106130 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_test"."analytics"."my_first_dbt_model"
where id = 1
  );
[0m21:33:23.110102 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:33:23.111865 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:33:23.112088 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:33:23.113304 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:33:23.114081 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:33:23.114270 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:33:23.114440 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:33:23.115844 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m21:33:23.117247 [debug] [Thread-4 (]: Applying DROP to: "dbt_test"."analytics"."my_second_dbt_model__dbt_backup"
[0m21:33:23.117620 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:33:23.117799 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_test"."analytics"."my_second_dbt_model__dbt_backup" cascade
[0m21:33:23.118540 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:33:23.119242 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: Close
[0m21:33:23.119542 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad256638-bf3a-471f-8e26-948530e8c128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108809710>]}
[0m21:33:23.119881 [info ] [Thread-4 (]: 5 of 5 OK created sql view model analytics.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.04s]
[0m21:33:23.120484 [debug] [Thread-4 (]: Finished running node model.dbt_test.my_second_dbt_model
[0m21:33:23.121667 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:23.121859 [debug] [MainThread]: On master: BEGIN
[0m21:33:23.122014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:33:23.140373 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m21:33:23.140849 [debug] [MainThread]: On master: COMMIT
[0m21:33:23.141229 [debug] [MainThread]: Using postgres connection "master"
[0m21:33:23.141449 [debug] [MainThread]: On master: COMMIT
[0m21:33:23.142413 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:33:23.142670 [debug] [MainThread]: On master: Close
[0m21:33:23.142950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:23.143179 [debug] [MainThread]: Connection 'model.dbt_test.my_first_dbt_model' was properly closed.
[0m21:33:23.143319 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:33:23.143450 [debug] [MainThread]: Connection 'model.dbt_test.stg_orders' was properly closed.
[0m21:33:23.143574 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m21:33:23.144123 [info ] [MainThread]: 
[0m21:33:23.144309 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m21:33:23.145046 [debug] [MainThread]: Command end result
[0m21:33:23.162628 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:33:23.163839 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:33:23.168648 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:33:23.168967 [info ] [MainThread]: 
[0m21:33:23.169338 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:33:23.169607 [info ] [MainThread]: 
[0m21:33:23.169814 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m21:33:23.172138 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9632339, "process_in_blocks": "0", "process_kernel_time": 0.203626, "process_mem_max_rss": "129810432", "process_out_blocks": "0", "process_user_time": 1.266728}
[0m21:33:23.172431 [debug] [MainThread]: Command `dbt run` succeeded at 21:33:23.172378 after 0.96 seconds
[0m21:33:23.172649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898f9b0>]}
[0m21:33:23.172955 [debug] [MainThread]: Flushing usage events
[0m21:33:23.627682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:34:27.136976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b28590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108957890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108957b10>]}


============================== 21:34:27.140699 | 8d96d673-af25-4b66-b066-89e0273e2119 ==============================
[0m21:34:27.140699 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:34:27.141051 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'use_colors': 'True', 'warn_error': 'None', 'debug': 'False', 'log_format': 'default', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'profiles_dir': '/Users/adil/.dbt', 'log_cache_events': 'False'}
[0m21:34:27.249975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d96d673-af25-4b66-b066-89e0273e2119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd09d0>]}
[0m21:34:27.285198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d96d673-af25-4b66-b066-89e0273e2119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108803790>]}
[0m21:34:27.285914 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:34:27.344014 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:34:27.429490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:34:27.429967 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/intermediate/int_order_payments.sql
[0m21:34:27.558975 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_test.marts
[0m21:34:27.567571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d96d673-af25-4b66-b066-89e0273e2119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10989f450>]}
[0m21:34:27.645397 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:34:27.648076 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:34:27.676328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d96d673-af25-4b66-b066-89e0273e2119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10987a8a0>]}
[0m21:34:27.677219 [info ] [MainThread]: Found 6 models, 4 data tests, 3 sources, 459 macros
[0m21:34:27.677794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d96d673-af25-4b66-b066-89e0273e2119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae8910>]}
[0m21:34:27.682594 [info ] [MainThread]: 
[0m21:34:27.682971 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:34:27.683437 [info ] [MainThread]: 
[0m21:34:27.684394 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:34:27.689237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:34:27.689646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:34:27.793392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:34:27.835649 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:34:27.835941 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:34:27.836138 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:34:27.836315 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:34:27.836492 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:34:27.836671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:27.836904 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:34:27.837259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:27.837961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:27.901773 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.064 seconds
[0m21:34:27.902102 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.065 seconds
[0m21:34:27.902883 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:34:27.903252 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.066 seconds
[0m21:34:27.904066 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:34:27.904883 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:34:27.905651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now create_dbt_test_analytics_intermediate)
[0m21:34:27.906302 [debug] [ThreadPool]: Creating schema "database: "dbt_test"
schema: "analytics_intermediate"
"
[0m21:34:27.909361 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics_intermediate"
[0m21:34:27.909562 [debug] [ThreadPool]: On create_dbt_test_analytics_intermediate: BEGIN
[0m21:34:27.909712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:27.924955 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:34:27.925244 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics_intermediate"
[0m21:34:27.925421 [debug] [ThreadPool]: On create_dbt_test_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "create_dbt_test_analytics_intermediate"} */
create schema if not exists "analytics_intermediate"
[0m21:34:27.926777 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:34:27.927385 [debug] [ThreadPool]: On create_dbt_test_analytics_intermediate: COMMIT
[0m21:34:27.927579 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics_intermediate"
[0m21:34:27.927729 [debug] [ThreadPool]: On create_dbt_test_analytics_intermediate: COMMIT
[0m21:34:27.928948 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m21:34:27.929112 [debug] [ThreadPool]: On create_dbt_test_analytics_intermediate: Close
[0m21:34:27.930155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics)
[0m21:34:27.930607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_staging)
[0m21:34:27.934042 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:34:27.934870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_test_analytics_intermediate, now list_dbt_test_analytics_intermediate)
[0m21:34:27.935848 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:34:27.936051 [debug] [ThreadPool]: On list_dbt_test_analytics: BEGIN
[0m21:34:27.936945 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:34:27.937216 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:34:27.937516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:27.937732 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: BEGIN
[0m21:34:27.937888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:27.938094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:27.957159 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m21:34:27.957446 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:34:27.957657 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m21:34:27.957823 [debug] [ThreadPool]: On list_dbt_test_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:34:27.957980 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m21:34:27.958127 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:34:27.958327 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:34:27.958564 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_intermediate'
  
[0m21:34:27.958749 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:34:27.963152 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m21:34:27.964244 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:34:27.964496 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m21:34:27.964661 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m21:34:27.965307 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: ROLLBACK
[0m21:34:27.965621 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:34:27.966300 [debug] [ThreadPool]: On list_dbt_test_analytics: ROLLBACK
[0m21:34:27.968086 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: Close
[0m21:34:27.968583 [debug] [ThreadPool]: On list_dbt_test_analytics: Close
[0m21:34:27.972421 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:27.972616 [debug] [MainThread]: On master: BEGIN
[0m21:34:27.972768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:27.988593 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m21:34:27.988917 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:27.989254 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:34:27.996015 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m21:34:27.997073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d96d673-af25-4b66-b066-89e0273e2119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e09980>]}
[0m21:34:27.997364 [debug] [MainThread]: On master: ROLLBACK
[0m21:34:27.998309 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:27.998538 [debug] [MainThread]: On master: BEGIN
[0m21:34:28.000729 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m21:34:28.000943 [debug] [MainThread]: On master: COMMIT
[0m21:34:28.001111 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:28.001262 [debug] [MainThread]: On master: COMMIT
[0m21:34:28.002129 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:34:28.002383 [debug] [MainThread]: On master: Close
[0m21:34:28.005506 [debug] [Thread-3 (]: Began running node model.dbt_test.stg_orders
[0m21:34:28.005752 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_customers
[0m21:34:28.005932 [debug] [Thread-4 (]: Began running node model.dbt_test.stg_payments
[0m21:34:28.006107 [debug] [Thread-1 (]: Began running node model.dbt_test.my_first_dbt_model
[0m21:34:28.006419 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m21:34:28.006811 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics_staging.stg_customers .................... [RUN]
[0m21:34:28.007119 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics_staging.stg_payments ..................... [RUN]
[0m21:34:28.007409 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m21:34:28.007681 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_intermediate, now model.dbt_test.stg_orders)
[0m21:34:28.007895 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.stg_customers)
[0m21:34:28.008136 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_test.stg_payments'
[0m21:34:28.008329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics, now model.dbt_test.my_first_dbt_model)
[0m21:34:28.008524 [debug] [Thread-3 (]: Began compiling node model.dbt_test.stg_orders
[0m21:34:28.008781 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_customers
[0m21:34:28.008962 [debug] [Thread-4 (]: Began compiling node model.dbt_test.stg_payments
[0m21:34:28.009133 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:34:28.014948 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.stg_orders"
[0m21:34:28.017335 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:34:28.018863 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_test.stg_payments"
[0m21:34:28.020172 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:34:28.021075 [debug] [Thread-3 (]: Began executing node model.dbt_test.stg_orders
[0m21:34:28.021307 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_customers
[0m21:34:28.021508 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:34:28.026768 [debug] [Thread-4 (]: Began executing node model.dbt_test.stg_payments
[0m21:34:28.049325 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.stg_orders"
[0m21:34:28.050074 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:34:28.062703 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:34:28.065097 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_test.stg_payments"
[0m21:34:28.065955 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:34:28.066232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:34:28.066435 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:34:28.066672 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: BEGIN
[0m21:34:28.066926 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:34:28.067155 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:34:28.067375 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:34:28.067539 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:34:28.067697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:28.067896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:34:28.068075 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: BEGIN
[0m21:34:28.068472 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:34:28.086549 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m21:34:28.086941 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:34:28.087336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m21:34:28.087558 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */

  create view "dbt_test"."analytics_staging"."stg_payments__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."payments"
),
casted as (
    select
        id           as payment_id,
        order_id,
        lower(payment_method) as payment_method,
        amount::numeric(10,2) as amount,
        paid_at::timestamp    as paid_at
    from source
)
select * from casted
  );
[0m21:34:28.087773 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:34:28.088065 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:34:28.088685 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m21:34:28.088874 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:34:28.089053 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."analytics_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:34:28.091554 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m21:34:28.091770 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:34:28.091956 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */

  create view "dbt_test"."analytics_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."orders"
),
casted as (
    select
        id           as order_id,
        user_id      as customer_id,
        order_date::timestamp as order_timestamp,
        lower(status) as status,
        total_amount::numeric(10,2) as total_amount
    from source
)
select * from casted
  );
[0m21:34:28.092306 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:34:28.095974 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:34:28.096197 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.008 seconds
[0m21:34:28.096382 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m21:34:28.096586 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."analytics_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m21:34:28.096782 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:34:28.100442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:34:28.101860 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:34:28.103360 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:34:28.103561 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:34:28.103757 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:34:28.103951 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:34:28.104136 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."analytics_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:34:28.105457 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:34:28.105699 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."analytics_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:34:28.106279 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:34:28.106466 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:34:28.106632 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:34:28.107951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:34:28.108125 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:34:28.109533 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:34:28.110782 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:34:28.110959 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:34:28.119155 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:34:28.119355 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."analytics_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:34:28.119549 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:34:28.119814 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:34:28.120082 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:34:28.120408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:34:28.121251 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:34:28.121461 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:34:28.121631 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:34:28.121796 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m21:34:28.121950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:34:28.122696 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:34:28.123457 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:34:28.128846 [debug] [Thread-4 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_payments__dbt_backup"
[0m21:34:28.129045 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:34:28.129227 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:34:28.129407 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:34:28.132057 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:34:28.132331 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:34:28.132587 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:34:28.132783 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
drop view if exists "dbt_test"."analytics_staging"."stg_payments__dbt_backup" cascade
[0m21:34:28.133156 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:34:28.134343 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_first_dbt_model__dbt_backup"
[0m21:34:28.136667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:34:28.136864 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m21:34:28.137036 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m21:34:28.137199 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m21:34:28.137360 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_test"."analytics"."my_first_dbt_model__dbt_backup" cascade
[0m21:34:28.138521 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_orders__dbt_backup"
[0m21:34:28.139450 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_customers__dbt_backup"
[0m21:34:28.140570 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: Close
[0m21:34:28.140960 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:34:28.141309 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:34:28.141501 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
drop view if exists "dbt_test"."analytics_staging"."stg_orders__dbt_backup" cascade
[0m21:34:28.142044 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."analytics_staging"."stg_customers__dbt_backup" cascade
[0m21:34:28.142780 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:34:28.143400 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: Close
[0m21:34:28.143635 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d96d673-af25-4b66-b066-89e0273e2119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991a2d0>]}
[0m21:34:28.143895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d96d673-af25-4b66-b066-89e0273e2119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c57a10>]}
[0m21:34:28.144390 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:34:28.144562 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:34:28.144219 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics_staging.stg_payments ................ [[32mCREATE VIEW[0m in 0.13s]
[0m21:34:28.144922 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.14s]
[0m21:34:28.145547 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: Close
[0m21:34:28.146138 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: Close
[0m21:34:28.146402 [debug] [Thread-4 (]: Finished running node model.dbt_test.stg_payments
[0m21:34:28.146672 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:34:28.146939 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d96d673-af25-4b66-b066-89e0273e2119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a042d50>]}
[0m21:34:28.147136 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d96d673-af25-4b66-b066-89e0273e2119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee6840>]}
[0m21:34:28.147582 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics_staging.stg_customers ............... [[32mCREATE VIEW[0m in 0.14s]
[0m21:34:28.147907 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics_staging.stg_orders .................. [[32mCREATE VIEW[0m in 0.14s]
[0m21:34:28.148163 [debug] [Thread-4 (]: Began running node model.dbt_test.my_second_dbt_model
[0m21:34:28.148407 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_customers
[0m21:34:28.148642 [debug] [Thread-3 (]: Finished running node model.dbt_test.stg_orders
[0m21:34:28.148888 [info ] [Thread-4 (]: 5 of 6 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m21:34:28.149194 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_test.stg_payments, now model.dbt_test.my_second_dbt_model)
[0m21:34:28.149393 [debug] [Thread-4 (]: Began compiling node model.dbt_test.my_second_dbt_model
[0m21:34:28.151159 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m21:34:28.151418 [debug] [Thread-1 (]: Began running node model.dbt_test.int_order_payments
[0m21:34:28.151853 [info ] [Thread-1 (]: 6 of 6 START sql view model analytics_intermediate.int_order_payments .......... [RUN]
[0m21:34:28.152094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.int_order_payments)
[0m21:34:28.152273 [debug] [Thread-1 (]: Began compiling node model.dbt_test.int_order_payments
[0m21:34:28.154381 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.int_order_payments"
[0m21:34:28.154865 [debug] [Thread-1 (]: Began executing node model.dbt_test.int_order_payments
[0m21:34:28.155058 [debug] [Thread-4 (]: Began executing node model.dbt_test.my_second_dbt_model
[0m21:34:28.157380 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.int_order_payments"
[0m21:34:28.159267 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m21:34:28.159743 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:34:28.159949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:34:28.160126 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m21:34:28.161317 [debug] [Thread-1 (]: On model.dbt_test.int_order_payments: BEGIN
[0m21:34:28.162295 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:34:28.162673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:28.285463 [debug] [Thread-4 (]: SQL status: BEGIN in 0.124 seconds
[0m21:34:28.285752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.123 seconds
[0m21:34:28.285952 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:34:28.286155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:34:28.286362 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_test"."analytics"."my_first_dbt_model"
where id = 1
  );
[0m21:34:28.286558 [debug] [Thread-1 (]: On model.dbt_test.int_order_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.int_order_payments"} */

  create view "dbt_test"."analytics_intermediate"."int_order_payments__dbt_tmp"
    
    
  as (
    

with payments as (
    select
        order_id,
        sum(amount) as total_paid,
        count(*)    as payment_count
    from "dbt_test"."analytics_staging"."stg_payments"
    group by 1
)

select
    o.order_id,
    o.customer_id,
    o.order_timestamp,
    o.status,
    o.total_amount,
    coalesce(p.total_paid, 0)   as total_paid,
    coalesce(p.payment_count, 0) as payment_count,
    (o.total_amount - coalesce(p.total_paid, 0)) as outstanding_amount
from "dbt_test"."analytics_staging"."stg_orders" o
left join payments p on o.order_id = p.order_id;
  );
[0m21:34:28.287769 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 28: left join payments p on o.order_id = p.order_id;
                                                        ^

[0m21:34:28.288057 [debug] [Thread-1 (]: On model.dbt_test.int_order_payments: ROLLBACK
[0m21:34:28.289204 [debug] [Thread-1 (]: On model.dbt_test.int_order_payments: Close
[0m21:34:28.290113 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:34:28.291612 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:34:28.291798 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:34:28.292501 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:34:28.293357 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:34:28.293632 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:34:28.293855 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:34:28.294680 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m21:34:28.296059 [debug] [Thread-4 (]: Applying DROP to: "dbt_test"."analytics"."my_second_dbt_model__dbt_backup"
[0m21:34:28.296444 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:34:28.296642 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_test"."analytics"."my_second_dbt_model__dbt_backup" cascade
[0m21:34:28.297243 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:34:28.297915 [debug] [Thread-4 (]: On model.dbt_test.my_second_dbt_model: Close
[0m21:34:28.298230 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d96d673-af25-4b66-b066-89e0273e2119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fcc3d0>]}
[0m21:34:28.298581 [info ] [Thread-4 (]: 5 of 6 OK created sql view model analytics.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.15s]
[0m21:34:28.298858 [debug] [Thread-4 (]: Finished running node model.dbt_test.my_second_dbt_model
[0m21:34:28.301946 [debug] [Thread-1 (]: Database Error in model int_order_payments (models/intermediate/int_order_payments.sql)
  syntax error at or near ";"
  LINE 28: left join payments p on o.order_id = p.order_id;
                                                          ^
  compiled code at target/run/dbt_test/models/intermediate/int_order_payments.sql
[0m21:34:28.302169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d96d673-af25-4b66-b066-89e0273e2119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a03f5f0>]}
[0m21:34:28.302456 [error] [Thread-1 (]: 6 of 6 ERROR creating sql view model analytics_intermediate.int_order_payments . [[31mERROR[0m in 0.15s]
[0m21:34:28.302719 [debug] [Thread-1 (]: Finished running node model.dbt_test.int_order_payments
[0m21:34:28.302992 [debug] [Thread-7 (]: Marking all children of 'model.dbt_test.int_order_payments' to be skipped because of status 'error'.  Reason: Database Error in model int_order_payments (models/intermediate/int_order_payments.sql)
  syntax error at or near ";"
  LINE 28: left join payments p on o.order_id = p.order_id;
                                                          ^
  compiled code at target/run/dbt_test/models/intermediate/int_order_payments.sql.
[0m21:34:28.303994 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:28.304142 [debug] [MainThread]: On master: BEGIN
[0m21:34:28.304317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:34:28.316899 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m21:34:28.317189 [debug] [MainThread]: On master: COMMIT
[0m21:34:28.317371 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:28.317526 [debug] [MainThread]: On master: COMMIT
[0m21:34:28.318108 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:34:28.318315 [debug] [MainThread]: On master: Close
[0m21:34:28.318584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:28.318747 [debug] [MainThread]: Connection 'model.dbt_test.int_order_payments' was properly closed.
[0m21:34:28.318885 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:34:28.319000 [debug] [MainThread]: Connection 'model.dbt_test.stg_orders' was properly closed.
[0m21:34:28.319120 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m21:34:28.319315 [info ] [MainThread]: 
[0m21:34:28.319474 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m21:34:28.320126 [debug] [MainThread]: Command end result
[0m21:34:28.332908 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:34:28.333950 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:34:28.337347 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:34:28.337529 [info ] [MainThread]: 
[0m21:34:28.337705 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:34:28.337855 [info ] [MainThread]: 
[0m21:34:28.338047 [error] [MainThread]: [31mFailure in model int_order_payments (models/intermediate/int_order_payments.sql)[0m
[0m21:34:28.338344 [error] [MainThread]:   Database Error in model int_order_payments (models/intermediate/int_order_payments.sql)
  syntax error at or near ";"
  LINE 28: left join payments p on o.order_id = p.order_id;
                                                          ^
  compiled code at target/run/dbt_test/models/intermediate/int_order_payments.sql
[0m21:34:28.338488 [info ] [MainThread]: 
[0m21:34:28.338674 [info ] [MainThread]:   compiled code at target/compiled/dbt_test/models/intermediate/int_order_payments.sql
[0m21:34:28.338807 [info ] [MainThread]: 
[0m21:34:28.338960 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m21:34:28.340610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2448192, "process_in_blocks": "0", "process_kernel_time": 0.233551, "process_mem_max_rss": "130187264", "process_out_blocks": "0", "process_user_time": 1.41628}
[0m21:34:28.340811 [debug] [MainThread]: Command `dbt run` failed at 21:34:28.340774 after 1.25 seconds
[0m21:34:28.340985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ff830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ff7d0>]}
[0m21:34:28.341166 [debug] [MainThread]: Flushing usage events
[0m21:34:28.843103 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:34:32.833071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107960590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878fb10>]}


============================== 21:34:32.836046 | 9317f3b5-adb7-403f-8c17-78f7a6bf6afa ==============================
[0m21:34:32.836046 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:34:32.836372 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/adil/.dbt', 'warn_error': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'empty': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'introspect': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default'}
[0m21:34:32.927809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9317f3b5-adb7-403f-8c17-78f7a6bf6afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b089d0>]}
[0m21:34:32.956986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9317f3b5-adb7-403f-8c17-78f7a6bf6afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108637790>]}
[0m21:34:32.958266 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:34:33.012495 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:34:33.087453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:34:33.087800 [debug] [MainThread]: Partial parsing: updated file: dbt_test://models/intermediate/int_order_payments.sql
[0m21:34:33.206364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_test.marts
[0m21:34:33.213972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9317f3b5-adb7-403f-8c17-78f7a6bf6afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d7450>]}
[0m21:34:33.256659 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:34:33.257676 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:34:33.270977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9317f3b5-adb7-403f-8c17-78f7a6bf6afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096b2990>]}
[0m21:34:33.271224 [info ] [MainThread]: Found 6 models, 4 data tests, 3 sources, 459 macros
[0m21:34:33.271396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9317f3b5-adb7-403f-8c17-78f7a6bf6afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109920670>]}
[0m21:34:33.272329 [info ] [MainThread]: 
[0m21:34:33.272511 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:34:33.272647 [info ] [MainThread]: 
[0m21:34:33.272882 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:34:33.274835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:34:33.280087 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:34:33.280372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:34:33.335397 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:34:33.335632 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:34:33.335808 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:34:33.335965 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:34:33.336122 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:34:33.336277 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:34:33.336426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:33.336559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:33.336682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:33.385978 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.049 seconds
[0m21:34:33.386212 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.050 seconds
[0m21:34:33.386383 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.050 seconds
[0m21:34:33.387061 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:34:33.387646 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:34:33.388185 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:34:33.389369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics)
[0m21:34:33.389635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_staging)
[0m21:34:33.392709 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:34:33.393655 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:34:33.393875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_intermediate)
[0m21:34:33.394048 [debug] [ThreadPool]: On list_dbt_test_analytics: BEGIN
[0m21:34:33.394216 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:34:33.395326 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:34:33.395485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:33.395626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:33.395762 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: BEGIN
[0m21:34:33.396045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:34:33.411528 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:34:33.411739 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m21:34:33.411900 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:34:33.412057 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m21:34:33.412245 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:34:33.412419 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_intermediate'
  
[0m21:34:33.412580 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:34:33.412733 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:34:33.412945 [debug] [ThreadPool]: On list_dbt_test_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:34:33.417894 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m21:34:33.418090 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m21:34:33.418256 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m21:34:33.418899 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: ROLLBACK
[0m21:34:33.419525 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:34:33.420078 [debug] [ThreadPool]: On list_dbt_test_analytics: ROLLBACK
[0m21:34:33.420818 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:34:33.421378 [debug] [ThreadPool]: On list_dbt_test_analytics: Close
[0m21:34:33.421523 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: Close
[0m21:34:33.424327 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:33.424497 [debug] [MainThread]: On master: BEGIN
[0m21:34:33.424657 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:33.437822 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m21:34:33.438035 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:33.438245 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:34:33.442013 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m21:34:33.442880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9317f3b5-adb7-403f-8c17-78f7a6bf6afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c414a0>]}
[0m21:34:33.443136 [debug] [MainThread]: On master: ROLLBACK
[0m21:34:33.443779 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:33.443922 [debug] [MainThread]: On master: BEGIN
[0m21:34:33.445441 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:34:33.445604 [debug] [MainThread]: On master: COMMIT
[0m21:34:33.445749 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:33.445884 [debug] [MainThread]: On master: COMMIT
[0m21:34:33.446711 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:34:33.447091 [debug] [MainThread]: On master: Close
[0m21:34:33.448533 [debug] [Thread-3 (]: Began running node model.dbt_test.stg_orders
[0m21:34:33.448754 [debug] [Thread-4 (]: Began running node model.dbt_test.stg_payments
[0m21:34:33.448941 [debug] [Thread-1 (]: Began running node model.dbt_test.my_first_dbt_model
[0m21:34:33.449105 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_customers
[0m21:34:33.449348 [info ] [Thread-3 (]: 3 of 6 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m21:34:33.449601 [info ] [Thread-4 (]: 4 of 6 START sql view model analytics_staging.stg_payments ..................... [RUN]
[0m21:34:33.450272 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_intermediate, now model.dbt_test.stg_orders)
[0m21:34:33.449811 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m21:34:33.450552 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_test.stg_payments'
[0m21:34:33.450072 [info ] [Thread-2 (]: 2 of 6 START sql view model analytics_staging.stg_customers .................... [RUN]
[0m21:34:33.450792 [debug] [Thread-3 (]: Began compiling node model.dbt_test.stg_orders
[0m21:34:33.450971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics, now model.dbt_test.my_first_dbt_model)
[0m21:34:33.451140 [debug] [Thread-4 (]: Began compiling node model.dbt_test.stg_payments
[0m21:34:33.451314 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.stg_customers)
[0m21:34:33.456055 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.stg_orders"
[0m21:34:33.456317 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:34:33.458245 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_test.stg_payments"
[0m21:34:33.458435 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_customers
[0m21:34:33.460720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:34:33.462101 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:34:33.462490 [debug] [Thread-4 (]: Began executing node model.dbt_test.stg_payments
[0m21:34:33.467772 [debug] [Thread-3 (]: Began executing node model.dbt_test.stg_orders
[0m21:34:33.467959 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:34:33.482109 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.stg_orders"
[0m21:34:33.482476 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_test.stg_payments"
[0m21:34:33.493656 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_customers
[0m21:34:33.493496 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:34:33.495779 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:34:33.496245 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:34:33.496488 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:34:33.496720 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: BEGIN
[0m21:34:33.496917 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: BEGIN
[0m21:34:33.497123 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:34:33.497318 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:34:33.497487 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:34:33.497677 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:34:33.497852 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:34:33.498013 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:34:33.498284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:33.498451 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:34:33.514522 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m21:34:33.514775 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m21:34:33.515015 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:34:33.515198 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:34:33.515380 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */

  create view "dbt_test"."analytics_staging"."stg_payments__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."payments"
),
casted as (
    select
        id           as payment_id,
        order_id,
        lower(payment_method) as payment_method,
        amount::numeric(10,2) as amount,
        paid_at::timestamp    as paid_at
    from source
)
select * from casted
  );
[0m21:34:33.515617 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:34:33.516111 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m21:34:33.516310 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m21:34:33.516485 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:34:33.516655 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:34:33.516831 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */

  create view "dbt_test"."analytics_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."orders"
),
casted as (
    select
        id           as order_id,
        user_id      as customer_id,
        order_date::timestamp as order_timestamp,
        lower(status) as status,
        total_amount::numeric(10,2) as total_amount
    from source
)
select * from casted
  );
[0m21:34:33.517017 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."analytics_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:34:33.518412 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m21:34:33.523455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:34:33.523650 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m21:34:33.523815 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m21:34:33.523981 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:34:33.524140 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m21:34:33.525522 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:34:33.527057 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:34:33.528596 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:34:33.528812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:34:33.529003 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."analytics_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:34:33.529216 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."analytics_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m21:34:33.529422 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:34:33.530906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:34:33.531185 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:34:33.531626 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:34:33.532992 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:34:33.533188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:34:33.533375 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."analytics_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:34:33.533573 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:34:33.533739 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:34:33.542688 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:34:33.544499 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:34:33.544788 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:34:33.546124 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:34:33.546314 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:34:33.546499 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:34:33.547259 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:34:33.547444 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."analytics_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:34:33.547621 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:34:33.547803 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:34:33.548089 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:34:33.548606 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:34:33.548784 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:34:33.549576 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:34:33.549752 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:34:33.549913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:34:33.550636 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:34:33.550811 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:34:33.556801 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_orders__dbt_backup"
[0m21:34:33.557910 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_first_dbt_model__dbt_backup"
[0m21:34:33.558113 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:34:33.558311 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:34:33.560681 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:34:33.561955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:34:33.562142 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:34:33.562337 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
drop view if exists "dbt_test"."analytics_staging"."stg_orders__dbt_backup" cascade
[0m21:34:33.562524 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_test"."analytics"."my_first_dbt_model__dbt_backup" cascade
[0m21:34:33.564139 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m21:34:33.565214 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_customers__dbt_backup"
[0m21:34:33.565571 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:34:33.565751 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m21:34:33.565923 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:34:33.566098 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:34:33.566263 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."analytics_staging"."stg_customers__dbt_backup" cascade
[0m21:34:33.567465 [debug] [Thread-4 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_payments__dbt_backup"
[0m21:34:33.568681 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: Close
[0m21:34:33.569344 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: Close
[0m21:34:33.569757 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:34:33.570351 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
drop view if exists "dbt_test"."analytics_staging"."stg_payments__dbt_backup" cascade
[0m21:34:33.571585 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:34:33.572283 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: Close
[0m21:34:33.572783 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:34:33.573450 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: Close
[0m21:34:33.573955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9317f3b5-adb7-403f-8c17-78f7a6bf6afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e8c290>]}
[0m21:34:33.574626 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9317f3b5-adb7-403f-8c17-78f7a6bf6afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a93b70>]}
[0m21:34:33.574789 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9317f3b5-adb7-403f-8c17-78f7a6bf6afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c82d0>]}
[0m21:34:33.574461 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.12s]
[0m21:34:33.575124 [info ] [Thread-3 (]: 3 of 6 OK created sql view model analytics_staging.stg_orders .................. [[32mCREATE VIEW[0m in 0.12s]
[0m21:34:33.575298 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9317f3b5-adb7-403f-8c17-78f7a6bf6afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dec950>]}
[0m21:34:33.575574 [info ] [Thread-2 (]: 2 of 6 OK created sql view model analytics_staging.stg_customers ............... [[32mCREATE VIEW[0m in 0.12s]
[0m21:34:33.575872 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:34:33.576165 [debug] [Thread-3 (]: Finished running node model.dbt_test.stg_orders
[0m21:34:33.576443 [info ] [Thread-4 (]: 4 of 6 OK created sql view model analytics_staging.stg_payments ................ [[32mCREATE VIEW[0m in 0.12s]
[0m21:34:33.576797 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_customers
[0m21:34:33.577612 [debug] [Thread-4 (]: Finished running node model.dbt_test.stg_payments
[0m21:34:33.578167 [debug] [Thread-1 (]: Began running node model.dbt_test.my_second_dbt_model
[0m21:34:33.578572 [info ] [Thread-1 (]: 5 of 6 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m21:34:33.578853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m21:34:33.579069 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_second_dbt_model
[0m21:34:33.581939 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m21:34:33.582190 [debug] [Thread-3 (]: Began running node model.dbt_test.int_order_payments
[0m21:34:33.582643 [info ] [Thread-3 (]: 6 of 6 START sql view model analytics_intermediate.int_order_payments .......... [RUN]
[0m21:34:33.583041 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_test.stg_orders, now model.dbt_test.int_order_payments)
[0m21:34:33.583283 [debug] [Thread-3 (]: Began compiling node model.dbt_test.int_order_payments
[0m21:34:33.585808 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.int_order_payments"
[0m21:34:33.586150 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_second_dbt_model
[0m21:34:33.588900 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m21:34:33.589106 [debug] [Thread-3 (]: Began executing node model.dbt_test.int_order_payments
[0m21:34:33.590835 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.int_order_payments"
[0m21:34:33.591152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:34:33.591331 [debug] [Thread-1 (]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m21:34:33.591501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:34:33.591739 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:34:33.591912 [debug] [Thread-3 (]: On model.dbt_test.int_order_payments: BEGIN
[0m21:34:33.592065 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:34:33.607865 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m21:34:33.608157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m21:34:33.608369 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:34:33.608576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:34:33.608797 [debug] [Thread-3 (]: On model.dbt_test.int_order_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.int_order_payments"} */

  create view "dbt_test"."analytics_intermediate"."int_order_payments__dbt_tmp"
    
    
  as (
    

with payments as (
    select
        order_id,
        sum(amount) as total_paid,
        count(*)    as payment_count
    from "dbt_test"."analytics_staging"."stg_payments"
    group by 1
)

select
    o.order_id,
    o.customer_id,
    o.order_timestamp,
    o.status,
    o.total_amount,
    coalesce(p.total_paid, 0)   as total_paid,
    coalesce(p.payment_count, 0) as payment_count,
    (o.total_amount - coalesce(p.total_paid, 0)) as outstanding_amount
from "dbt_test"."analytics_staging"."stg_orders" o
left join payments p on o.order_id = p.order_id
  );
[0m21:34:33.609001 [debug] [Thread-1 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_test"."analytics"."my_first_dbt_model"
where id = 1
  );
[0m21:34:33.611876 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:34:33.613827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:34:33.614064 [debug] [Thread-1 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:34:33.614251 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:34:33.615830 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:34:33.616012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:34:33.616185 [debug] [Thread-3 (]: On model.dbt_test.int_order_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.int_order_payments"} */
alter table "dbt_test"."analytics_intermediate"."int_order_payments__dbt_tmp" rename to "int_order_payments"
[0m21:34:33.616870 [debug] [Thread-1 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:34:33.617063 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:34:33.617229 [debug] [Thread-1 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:34:33.617568 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:34:33.618274 [debug] [Thread-3 (]: On model.dbt_test.int_order_payments: COMMIT
[0m21:34:33.618449 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:34:33.618617 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:34:33.619827 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_second_dbt_model__dbt_backup"
[0m21:34:33.619999 [debug] [Thread-3 (]: On model.dbt_test.int_order_payments: COMMIT
[0m21:34:33.620336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:34:33.620523 [debug] [Thread-1 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_test"."analytics"."my_second_dbt_model__dbt_backup" cascade
[0m21:34:33.621192 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:34:33.621382 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:34:33.622043 [debug] [Thread-1 (]: On model.dbt_test.my_second_dbt_model: Close
[0m21:34:33.623087 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics_intermediate"."int_order_payments__dbt_backup"
[0m21:34:33.623420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9317f3b5-adb7-403f-8c17-78f7a6bf6afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de5160>]}
[0m21:34:33.623802 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:34:33.624285 [debug] [Thread-3 (]: On model.dbt_test.int_order_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.int_order_payments"} */
drop view if exists "dbt_test"."analytics_intermediate"."int_order_payments__dbt_backup" cascade
[0m21:34:33.624132 [info ] [Thread-1 (]: 5 of 6 OK created sql view model analytics.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.04s]
[0m21:34:33.624595 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_second_dbt_model
[0m21:34:33.624983 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:34:33.625614 [debug] [Thread-3 (]: On model.dbt_test.int_order_payments: Close
[0m21:34:33.625894 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9317f3b5-adb7-403f-8c17-78f7a6bf6afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a9bf50>]}
[0m21:34:33.626178 [info ] [Thread-3 (]: 6 of 6 OK created sql view model analytics_intermediate.int_order_payments ..... [[32mCREATE VIEW[0m in 0.04s]
[0m21:34:33.626431 [debug] [Thread-3 (]: Finished running node model.dbt_test.int_order_payments
[0m21:34:33.627073 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:33.627219 [debug] [MainThread]: On master: BEGIN
[0m21:34:33.627351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:34:33.639524 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m21:34:33.639788 [debug] [MainThread]: On master: COMMIT
[0m21:34:33.639950 [debug] [MainThread]: Using postgres connection "master"
[0m21:34:33.640096 [debug] [MainThread]: On master: COMMIT
[0m21:34:33.640782 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:34:33.641063 [debug] [MainThread]: On master: Close
[0m21:34:33.641361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:33.641606 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m21:34:33.641772 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:34:33.642164 [debug] [MainThread]: Connection 'model.dbt_test.int_order_payments' was properly closed.
[0m21:34:33.642350 [debug] [MainThread]: Connection 'model.dbt_test.stg_payments' was properly closed.
[0m21:34:33.642564 [info ] [MainThread]: 
[0m21:34:33.642752 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m21:34:33.643484 [debug] [MainThread]: Command end result
[0m21:34:33.655885 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:34:33.656888 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:34:33.660133 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:34:33.660308 [info ] [MainThread]: 
[0m21:34:33.660489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:34:33.660634 [info ] [MainThread]: 
[0m21:34:33.660794 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m21:34:33.662468 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.86823255, "process_in_blocks": "0", "process_kernel_time": 0.16681, "process_mem_max_rss": "134004736", "process_out_blocks": "0", "process_user_time": 1.272719}
[0m21:34:33.662682 [debug] [MainThread]: Command `dbt run` succeeded at 21:34:33.662644 after 0.87 seconds
[0m21:34:33.662861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10868e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e97e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e978f0>]}
[0m21:34:33.663036 [debug] [MainThread]: Flushing usage events
[0m21:34:34.134454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:36:21.974839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b50590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897fb10>]}


============================== 21:36:21.977955 | ece425de-9a6f-4a26-82c6-a413ef71a9de ==============================
[0m21:36:21.977955 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:36:21.978281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'fail_fast': 'False', 'empty': 'False', 'version_check': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adil/.dbt'}
[0m21:36:22.079798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ece425de-9a6f-4a26-82c6-a413ef71a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfc9d0>]}
[0m21:36:22.107476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ece425de-9a6f-4a26-82c6-a413ef71a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10882b790>]}
[0m21:36:22.108081 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:36:22.156119 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:36:22.237238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m21:36:22.237594 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/marts/fct_orders.sql
[0m21:36:22.237778 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/marts/dim_customers.sql
[0m21:36:22.368955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ece425de-9a6f-4a26-82c6-a413ef71a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c7750>]}
[0m21:36:22.410195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:36:22.411382 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:36:22.427030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ece425de-9a6f-4a26-82c6-a413ef71a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b27d40>]}
[0m21:36:22.427286 [info ] [MainThread]: Found 8 models, 4 data tests, 3 sources, 459 macros
[0m21:36:22.427476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ece425de-9a6f-4a26-82c6-a413ef71a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b10910>]}
[0m21:36:22.428434 [info ] [MainThread]: 
[0m21:36:22.428628 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:36:22.428770 [info ] [MainThread]: 
[0m21:36:22.429011 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:36:22.431112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:36:22.431392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:36:22.437337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:36:22.437935 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:36:22.507868 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:36:22.508100 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:36:22.508274 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:36:22.508434 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:36:22.508579 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:36:22.508734 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:36:22.508881 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:36:22.509022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:22.509156 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:36:22.509286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:22.509409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:22.509999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:22.587858 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.078 seconds
[0m21:36:22.588126 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.079 seconds
[0m21:36:22.588328 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.079 seconds
[0m21:36:22.588482 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.079 seconds
[0m21:36:22.589206 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:36:22.589872 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:36:22.590507 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:36:22.591075 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:36:22.591818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now create_dbt_test_analytics_marts)
[0m21:36:22.592057 [debug] [ThreadPool]: Creating schema "database: "dbt_test"
schema: "analytics_marts"
"
[0m21:36:22.594834 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics_marts"
[0m21:36:22.595011 [debug] [ThreadPool]: On create_dbt_test_analytics_marts: BEGIN
[0m21:36:22.595155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:22.609738 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:36:22.609957 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics_marts"
[0m21:36:22.610171 [debug] [ThreadPool]: On create_dbt_test_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "create_dbt_test_analytics_marts"} */
create schema if not exists "analytics_marts"
[0m21:36:22.611722 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:36:22.612254 [debug] [ThreadPool]: On create_dbt_test_analytics_marts: COMMIT
[0m21:36:22.612430 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics_marts"
[0m21:36:22.612579 [debug] [ThreadPool]: On create_dbt_test_analytics_marts: COMMIT
[0m21:36:22.615411 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m21:36:22.615574 [debug] [ThreadPool]: On create_dbt_test_analytics_marts: Close
[0m21:36:22.616610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_staging)
[0m21:36:22.619680 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:36:22.619910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_intermediate)
[0m21:36:22.620068 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:36:22.620301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics)
[0m21:36:22.621665 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:36:22.621857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_test_analytics_marts, now list_dbt_test_analytics_marts)
[0m21:36:22.622029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:22.622873 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:36:22.623026 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: BEGIN
[0m21:36:22.624006 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_marts"
[0m21:36:22.624215 [debug] [ThreadPool]: On list_dbt_test_analytics: BEGIN
[0m21:36:22.624357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:22.624503 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: BEGIN
[0m21:36:22.624637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:22.624831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:22.639169 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:36:22.639491 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:36:22.639671 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_intermediate'
  
[0m21:36:22.639948 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:36:22.640126 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_marts"
[0m21:36:22.640303 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m21:36:22.640502 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m21:36:22.640689 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:36:22.640879 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m21:36:22.641086 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:36:22.641258 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics"
[0m21:36:22.641482 [debug] [ThreadPool]: On list_dbt_test_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m21:36:22.644805 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m21:36:22.644966 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m21:36:22.645647 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: ROLLBACK
[0m21:36:22.645830 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m21:36:22.646441 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: ROLLBACK
[0m21:36:22.646606 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m21:36:22.647201 [debug] [ThreadPool]: On list_dbt_test_analytics: ROLLBACK
[0m21:36:22.647358 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: Close
[0m21:36:22.647922 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:36:22.648071 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: Close
[0m21:36:22.648661 [debug] [ThreadPool]: On list_dbt_test_analytics: Close
[0m21:36:22.648817 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:36:22.653415 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:22.653602 [debug] [MainThread]: On master: BEGIN
[0m21:36:22.653737 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:36:22.665145 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m21:36:22.665326 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:22.665529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:36:22.672868 [debug] [MainThread]: SQL status: SELECT 6 in 0.007 seconds
[0m21:36:22.673906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ece425de-9a6f-4a26-82c6-a413ef71a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4dcc0>]}
[0m21:36:22.674149 [debug] [MainThread]: On master: ROLLBACK
[0m21:36:22.674761 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:22.674908 [debug] [MainThread]: On master: BEGIN
[0m21:36:22.676182 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:36:22.676370 [debug] [MainThread]: On master: COMMIT
[0m21:36:22.676530 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:22.676677 [debug] [MainThread]: On master: COMMIT
[0m21:36:22.677194 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:36:22.677387 [debug] [MainThread]: On master: Close
[0m21:36:22.679515 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_customers
[0m21:36:22.679730 [debug] [Thread-4 (]: Began running node model.dbt_test.stg_payments
[0m21:36:22.679918 [debug] [Thread-3 (]: Began running node model.dbt_test.stg_orders
[0m21:36:22.680088 [debug] [Thread-1 (]: Began running node model.dbt_test.my_first_dbt_model
[0m21:36:22.680334 [info ] [Thread-2 (]: 2 of 8 START sql view model analytics_staging.stg_customers .................... [RUN]
[0m21:36:22.680624 [info ] [Thread-4 (]: 4 of 8 START sql view model analytics_staging.stg_payments ..................... [RUN]
[0m21:36:22.680887 [info ] [Thread-3 (]: 3 of 8 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m21:36:22.681140 [info ] [Thread-1 (]: 1 of 8 START sql table model analytics.my_first_dbt_model ...................... [RUN]
[0m21:36:22.681369 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_intermediate, now model.dbt_test.stg_customers)
[0m21:36:22.681557 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_marts, now model.dbt_test.stg_payments)
[0m21:36:22.681729 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics, now model.dbt_test.stg_orders)
[0m21:36:22.681898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.my_first_dbt_model)
[0m21:36:22.682070 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_customers
[0m21:36:22.682229 [debug] [Thread-4 (]: Began compiling node model.dbt_test.stg_payments
[0m21:36:22.682384 [debug] [Thread-3 (]: Began compiling node model.dbt_test.stg_orders
[0m21:36:22.682537 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_first_dbt_model
[0m21:36:22.687087 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:36:22.688656 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_test.stg_payments"
[0m21:36:22.690118 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.stg_orders"
[0m21:36:22.691563 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_first_dbt_model"
[0m21:36:22.692436 [debug] [Thread-4 (]: Began executing node model.dbt_test.stg_payments
[0m21:36:22.698720 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_customers
[0m21:36:22.698922 [debug] [Thread-3 (]: Began executing node model.dbt_test.stg_orders
[0m21:36:22.713364 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:36:22.714484 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_test.stg_payments"
[0m21:36:22.714726 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_first_dbt_model
[0m21:36:22.716373 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.stg_orders"
[0m21:36:22.726450 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_first_dbt_model"
[0m21:36:22.726879 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:36:22.727099 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:36:22.727293 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:36:22.727503 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:36:22.727691 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: BEGIN
[0m21:36:22.727872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:36:22.728023 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:36:22.728176 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: BEGIN
[0m21:36:22.728337 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:36:22.728501 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: BEGIN
[0m21:36:22.728724 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:36:22.728952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:36:22.745361 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m21:36:22.745615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m21:36:22.745861 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m21:36:22.746076 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:36:22.746271 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:36:22.746461 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:36:22.746645 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."analytics_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:36:22.746824 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m21:36:22.747004 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */

  
    

  create  table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m21:36:22.747196 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */

  create view "dbt_test"."analytics_staging"."stg_payments__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."payments"
),
casted as (
    select
        id           as payment_id,
        order_id,
        lower(payment_method) as payment_method,
        amount::numeric(10,2) as amount,
        paid_at::timestamp    as paid_at
    from source
)
select * from casted
  );
[0m21:36:22.747397 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:36:22.747682 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */

  create view "dbt_test"."analytics_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."orders"
),
casted as (
    select
        id           as order_id,
        user_id      as customer_id,
        order_date::timestamp as order_timestamp,
        lower(status) as status,
        total_amount::numeric(10,2) as total_amount
    from source
)
select * from casted
  );
[0m21:36:22.750895 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m21:36:22.756121 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:36:22.756318 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m21:36:22.756494 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m21:36:22.756660 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m21:36:22.756819 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m21:36:22.758125 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:36:22.759499 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:36:22.760897 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:36:22.761071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:36:22.761236 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:36:22.761399 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."analytics_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m21:36:22.761567 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."analytics_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:36:22.762784 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:36:22.763058 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
alter table "dbt_test"."analytics"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:36:22.763656 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:36:22.763866 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:36:22.764080 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:36:22.768277 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:36:22.768487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m21:36:22.769792 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:36:22.771245 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:36:22.771450 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."analytics_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:36:22.779990 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:36:22.780201 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:36:22.780377 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."analytics_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:36:22.780598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:36:22.780892 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: COMMIT
[0m21:36:22.781400 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:36:22.781590 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:36:22.781785 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:36:22.782650 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:36:22.782855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:36:22.783748 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:36:22.784518 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:36:22.784692 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:36:22.787641 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_first_dbt_model__dbt_backup"
[0m21:36:22.787836 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:36:22.788016 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:36:22.788179 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:36:22.790422 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_first_dbt_model"
[0m21:36:22.790601 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:36:22.790759 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:36:22.790952 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_first_dbt_model"} */
drop table if exists "dbt_test"."analytics"."my_first_dbt_model__dbt_backup" cascade
[0m21:36:22.791694 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m21:36:22.793028 [debug] [Thread-4 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_payments__dbt_backup"
[0m21:36:22.793231 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m21:36:22.793413 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m21:36:22.794848 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:36:22.795034 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m21:36:22.795991 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_orders__dbt_backup"
[0m21:36:22.796977 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_customers__dbt_backup"
[0m21:36:22.797147 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
drop view if exists "dbt_test"."analytics_staging"."stg_payments__dbt_backup" cascade
[0m21:36:22.798317 [debug] [Thread-1 (]: On model.dbt_test.my_first_dbt_model: Close
[0m21:36:22.798848 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:36:22.799209 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:36:22.799422 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
drop view if exists "dbt_test"."analytics_staging"."stg_orders__dbt_backup" cascade
[0m21:36:22.800006 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."analytics_staging"."stg_customers__dbt_backup" cascade
[0m21:36:22.800744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece425de-9a6f-4a26-82c6-a413ef71a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109923650>]}
[0m21:36:22.801094 [info ] [Thread-1 (]: 1 of 8 OK created sql table model analytics.my_first_dbt_model ................. [[32mSELECT 2[0m in 0.12s]
[0m21:36:22.801429 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_first_dbt_model
[0m21:36:22.801841 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:36:22.802594 [debug] [Thread-4 (]: On model.dbt_test.stg_payments: Close
[0m21:36:22.802820 [debug] [Thread-1 (]: Began running node model.dbt_test.my_second_dbt_model
[0m21:36:22.803009 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:36:22.803325 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece425de-9a6f-4a26-82c6-a413ef71a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c73800>]}
[0m21:36:22.803736 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:36:22.803577 [info ] [Thread-1 (]: 5 of 8 START sql view model analytics.my_second_dbt_model ...................... [RUN]
[0m21:36:22.804520 [debug] [Thread-3 (]: On model.dbt_test.stg_orders: Close
[0m21:36:22.805444 [debug] [Thread-2 (]: On model.dbt_test.stg_customers: Close
[0m21:36:22.804835 [info ] [Thread-4 (]: 4 of 8 OK created sql view model analytics_staging.stg_payments ................ [[32mCREATE VIEW[0m in 0.12s]
[0m21:36:22.805707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test.my_first_dbt_model, now model.dbt_test.my_second_dbt_model)
[0m21:36:22.805955 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece425de-9a6f-4a26-82c6-a413ef71a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae7430>]}
[0m21:36:22.806213 [debug] [Thread-4 (]: Finished running node model.dbt_test.stg_payments
[0m21:36:22.806543 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece425de-9a6f-4a26-82c6-a413ef71a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe80e0>]}
[0m21:36:22.806875 [debug] [Thread-1 (]: Began compiling node model.dbt_test.my_second_dbt_model
[0m21:36:22.807196 [info ] [Thread-3 (]: 3 of 8 OK created sql view model analytics_staging.stg_orders .................. [[32mCREATE VIEW[0m in 0.12s]
[0m21:36:22.807635 [info ] [Thread-2 (]: 2 of 8 OK created sql view model analytics_staging.stg_customers ............... [[32mCREATE VIEW[0m in 0.13s]
[0m21:36:22.809195 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.my_second_dbt_model"
[0m21:36:22.809466 [debug] [Thread-3 (]: Finished running node model.dbt_test.stg_orders
[0m21:36:22.809710 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_customers
[0m21:36:22.810307 [debug] [Thread-4 (]: Began running node model.dbt_test.int_order_payments
[0m21:36:22.810665 [debug] [Thread-1 (]: Began executing node model.dbt_test.my_second_dbt_model
[0m21:36:22.811090 [debug] [Thread-3 (]: Began running node model.dbt_test.dim_customers
[0m21:36:22.811399 [info ] [Thread-4 (]: 6 of 8 START sql view model analytics_intermediate.int_order_payments .......... [RUN]
[0m21:36:22.813127 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.my_second_dbt_model"
[0m21:36:22.813388 [info ] [Thread-3 (]: 7 of 8 START sql table model analytics_marts.dim_customers ..................... [RUN]
[0m21:36:22.813635 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_test.stg_payments, now model.dbt_test.int_order_payments)
[0m21:36:22.813859 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_test.stg_orders, now model.dbt_test.dim_customers)
[0m21:36:22.814043 [debug] [Thread-4 (]: Began compiling node model.dbt_test.int_order_payments
[0m21:36:22.814224 [debug] [Thread-3 (]: Began compiling node model.dbt_test.dim_customers
[0m21:36:22.815976 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_test.int_order_payments"
[0m21:36:22.816192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:36:22.817440 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.dim_customers"
[0m21:36:22.817678 [debug] [Thread-1 (]: On model.dbt_test.my_second_dbt_model: BEGIN
[0m21:36:22.817903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:36:22.818186 [debug] [Thread-4 (]: Began executing node model.dbt_test.int_order_payments
[0m21:36:22.820032 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_test.int_order_payments"
[0m21:36:22.820348 [debug] [Thread-3 (]: Began executing node model.dbt_test.dim_customers
[0m21:36:22.822028 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.dim_customers"
[0m21:36:22.822247 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:36:22.822468 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: BEGIN
[0m21:36:22.822643 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:36:22.822985 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m21:36:22.823153 [debug] [Thread-3 (]: On model.dbt_test.dim_customers: BEGIN
[0m21:36:22.823306 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:36:22.830829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m21:36:22.831051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:36:22.831233 [debug] [Thread-1 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */

  create view "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt_test"."analytics"."my_first_dbt_model"
where id = 1
  );
[0m21:36:22.834157 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:36:22.835736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:36:22.835952 [debug] [Thread-1 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
alter table "dbt_test"."analytics"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:36:22.836617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:36:22.837599 [debug] [Thread-1 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:36:22.838076 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m21:36:22.838266 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m21:36:22.838447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:36:22.838645 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m21:36:22.838800 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:36:22.838963 [debug] [Thread-1 (]: On model.dbt_test.my_second_dbt_model: COMMIT
[0m21:36:22.839144 [debug] [Thread-3 (]: On model.dbt_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.dim_customers"} */

  
    

  create  table "dbt_test"."analytics_marts"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select
    c.customer_id,
    initcap(c.first_name) as first_name,
    initcap(c.last_name)  as last_name,
    c.email,
    c.created_at
from "dbt_test"."analytics_staging"."stg_customers" c
  );
  
[0m21:36:22.839334 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.int_order_payments"} */

  create view "dbt_test"."analytics_intermediate"."int_order_payments__dbt_tmp"
    
    
  as (
    

with payments as (
    select
        order_id,
        sum(amount) as total_paid,
        count(*)    as payment_count
    from "dbt_test"."analytics_staging"."stg_payments"
    group by 1
)

select
    o.order_id,
    o.customer_id,
    o.order_timestamp,
    o.status,
    o.total_amount,
    coalesce(p.total_paid, 0)   as total_paid,
    coalesce(p.payment_count, 0) as payment_count,
    (o.total_amount - coalesce(p.total_paid, 0)) as outstanding_amount
from "dbt_test"."analytics_staging"."stg_orders" o
left join payments p on o.order_id = p.order_id
  );
[0m21:36:22.840255 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:36:22.841353 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics"."my_second_dbt_model__dbt_backup"
[0m21:36:22.841717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.my_second_dbt_model"
[0m21:36:22.841893 [debug] [Thread-1 (]: On model.dbt_test.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.my_second_dbt_model"} */
drop view if exists "dbt_test"."analytics"."my_second_dbt_model__dbt_backup" cascade
[0m21:36:22.842559 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:36:22.843295 [debug] [Thread-1 (]: On model.dbt_test.my_second_dbt_model: Close
[0m21:36:22.843504 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:36:22.844892 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:36:22.845084 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.006 seconds
[0m21:36:22.845262 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.int_order_payments"} */
alter table "dbt_test"."analytics_intermediate"."int_order_payments__dbt_tmp" rename to "int_order_payments"
[0m21:36:22.845521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece425de-9a6f-4a26-82c6-a413ef71a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a06e6d0>]}
[0m21:36:22.847230 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m21:36:22.847777 [debug] [Thread-3 (]: On model.dbt_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.dim_customers"} */
alter table "dbt_test"."analytics_marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m21:36:22.847619 [info ] [Thread-1 (]: 5 of 8 OK created sql view model analytics.my_second_dbt_model ................. [[32mCREATE VIEW[0m in 0.04s]
[0m21:36:22.848117 [debug] [Thread-1 (]: Finished running node model.dbt_test.my_second_dbt_model
[0m21:36:22.848291 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:36:22.848481 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:36:22.849209 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: COMMIT
[0m21:36:22.849908 [debug] [Thread-3 (]: On model.dbt_test.dim_customers: COMMIT
[0m21:36:22.850099 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:36:22.850279 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m21:36:22.850451 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: COMMIT
[0m21:36:22.850612 [debug] [Thread-3 (]: On model.dbt_test.dim_customers: COMMIT
[0m21:36:22.851684 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m21:36:22.851848 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:36:22.852937 [debug] [Thread-4 (]: Applying DROP to: "dbt_test"."analytics_intermediate"."int_order_payments__dbt_backup"
[0m21:36:22.854003 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics_marts"."dim_customers__dbt_backup"
[0m21:36:22.854663 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:36:22.855033 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m21:36:22.855219 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.int_order_payments"} */
drop view if exists "dbt_test"."analytics_intermediate"."int_order_payments__dbt_backup" cascade
[0m21:36:22.855401 [debug] [Thread-3 (]: On model.dbt_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.dim_customers"} */
drop table if exists "dbt_test"."analytics_marts"."dim_customers__dbt_backup" cascade
[0m21:36:22.856136 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:36:22.857347 [debug] [Thread-3 (]: On model.dbt_test.dim_customers: Close
[0m21:36:22.857540 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:36:22.858172 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: Close
[0m21:36:22.858487 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece425de-9a6f-4a26-82c6-a413ef71a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a085a90>]}
[0m21:36:22.858780 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece425de-9a6f-4a26-82c6-a413ef71a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a085e50>]}
[0m21:36:22.859077 [info ] [Thread-3 (]: 7 of 8 OK created sql table model analytics_marts.dim_customers ................ [[32mSELECT 5[0m in 0.04s]
[0m21:36:22.859336 [debug] [Thread-3 (]: Finished running node model.dbt_test.dim_customers
[0m21:36:22.859588 [info ] [Thread-4 (]: 6 of 8 OK created sql view model analytics_intermediate.int_order_payments ..... [[32mCREATE VIEW[0m in 0.04s]
[0m21:36:22.859925 [debug] [Thread-4 (]: Finished running node model.dbt_test.int_order_payments
[0m21:36:22.860281 [debug] [Thread-2 (]: Began running node model.dbt_test.fct_orders
[0m21:36:22.860530 [info ] [Thread-2 (]: 8 of 8 START sql table model analytics_marts.fct_orders ........................ [RUN]
[0m21:36:22.860845 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_test.stg_customers, now model.dbt_test.fct_orders)
[0m21:36:22.861058 [debug] [Thread-2 (]: Began compiling node model.dbt_test.fct_orders
[0m21:36:22.862599 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.fct_orders"
[0m21:36:22.863036 [debug] [Thread-2 (]: Began executing node model.dbt_test.fct_orders
[0m21:36:22.864615 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.fct_orders"
[0m21:36:22.864973 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m21:36:22.865160 [debug] [Thread-2 (]: On model.dbt_test.fct_orders: BEGIN
[0m21:36:22.865317 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:36:22.877086 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m21:36:22.877342 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m21:36:22.877550 [debug] [Thread-2 (]: On model.dbt_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.fct_orders"} */

  
    

  create  table "dbt_test"."analytics_marts"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    

select
    i.order_id,
    i.customer_id,
    i.order_timestamp,
    i.status,
    i.total_amount,
    i.total_paid,
    i.payment_count,
    i.outstanding_amount,
    case
        when i.outstanding_amount = 0 and i.total_amount > 0 then true
        else false
    end as is_fully_paid
from "dbt_test"."analytics_intermediate"."int_order_payments" i
  );
  
[0m21:36:22.888217 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.010 seconds
[0m21:36:22.890639 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m21:36:22.890843 [debug] [Thread-2 (]: On model.dbt_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.fct_orders"} */
alter table "dbt_test"."analytics_marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m21:36:22.891459 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:36:22.892179 [debug] [Thread-2 (]: On model.dbt_test.fct_orders: COMMIT
[0m21:36:22.892343 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m21:36:22.892488 [debug] [Thread-2 (]: On model.dbt_test.fct_orders: COMMIT
[0m21:36:22.893408 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:36:22.894438 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."analytics_marts"."fct_orders__dbt_backup"
[0m21:36:22.894785 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m21:36:22.894949 [debug] [Thread-2 (]: On model.dbt_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.fct_orders"} */
drop table if exists "dbt_test"."analytics_marts"."fct_orders__dbt_backup" cascade
[0m21:36:22.895507 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m21:36:22.896114 [debug] [Thread-2 (]: On model.dbt_test.fct_orders: Close
[0m21:36:22.896379 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece425de-9a6f-4a26-82c6-a413ef71a9de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a086cf0>]}
[0m21:36:22.896683 [info ] [Thread-2 (]: 8 of 8 OK created sql table model analytics_marts.fct_orders ................... [[32mSELECT 5[0m in 0.04s]
[0m21:36:22.896938 [debug] [Thread-2 (]: Finished running node model.dbt_test.fct_orders
[0m21:36:22.897610 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:22.897758 [debug] [MainThread]: On master: BEGIN
[0m21:36:22.897887 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:36:22.909349 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m21:36:22.909569 [debug] [MainThread]: On master: COMMIT
[0m21:36:22.909717 [debug] [MainThread]: Using postgres connection "master"
[0m21:36:22.909845 [debug] [MainThread]: On master: COMMIT
[0m21:36:22.910328 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:36:22.910483 [debug] [MainThread]: On master: Close
[0m21:36:22.910704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:22.910851 [debug] [MainThread]: Connection 'model.dbt_test.my_second_dbt_model' was properly closed.
[0m21:36:22.910974 [debug] [MainThread]: Connection 'model.dbt_test.fct_orders' was properly closed.
[0m21:36:22.911085 [debug] [MainThread]: Connection 'model.dbt_test.dim_customers' was properly closed.
[0m21:36:22.911193 [debug] [MainThread]: Connection 'model.dbt_test.int_order_payments' was properly closed.
[0m21:36:22.911371 [info ] [MainThread]: 
[0m21:36:22.911526 [info ] [MainThread]: Finished running 3 table models, 5 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m21:36:22.912253 [debug] [MainThread]: Command end result
[0m21:36:22.927220 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:36:22.928158 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:36:22.931146 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:36:22.931312 [info ] [MainThread]: 
[0m21:36:22.931488 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:22.931631 [info ] [MainThread]: 
[0m21:36:22.931787 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m21:36:22.933644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9951209, "process_in_blocks": "0", "process_kernel_time": 0.196641, "process_mem_max_rss": "133644288", "process_out_blocks": "0", "process_user_time": 1.321579}
[0m21:36:22.933896 [debug] [MainThread]: Command `dbt run` succeeded at 21:36:22.933848 after 1.00 seconds
[0m21:36:22.934080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073dc890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a4a10>]}
[0m21:36:22.934257 [debug] [MainThread]: Flushing usage events
[0m21:36:23.453100 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:37:45.522520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110618590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11214b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11214bb10>]}


============================== 21:37:45.525756 | 8d441162-ff68-4405-894b-3f1b2b3c006e ==============================
[0m21:37:45.525756 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:37:45.526087 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'profiles_dir': '/Users/adil/.dbt', 'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'write_json': 'True', 'empty': 'None', 'introspect': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m21:37:45.625312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d441162-ff68-4405-894b-3f1b2b3c006e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c49d0>]}
[0m21:37:45.654161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d441162-ff68-4405-894b-3f1b2b3c006e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ff3790>]}
[0m21:37:45.654829 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:37:45.703766 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:37:45.780710 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 0 files changed.
[0m21:37:45.781035 [debug] [MainThread]: Partial parsing: added file: dbt_test://models/schema.yml
[0m21:37:45.781233 [debug] [MainThread]: Partial parsing: deleted file: dbt_test://models/example/my_first_dbt_model.sql
[0m21:37:45.781367 [debug] [MainThread]: Partial parsing: deleted file: dbt_test://models/example/my_second_dbt_model.sql
[0m21:37:45.900177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_test.example
[0m21:37:45.906227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d441162-ff68-4405-894b-3f1b2b3c006e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ee3d50>]}
[0m21:37:45.980202 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:37:45.981381 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:37:46.059373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d441162-ff68-4405-894b-3f1b2b3c006e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d66f30>]}
[0m21:37:46.059653 [info ] [MainThread]: Found 6 models, 16 data tests, 3 sources, 459 macros
[0m21:37:46.059828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d441162-ff68-4405-894b-3f1b2b3c006e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11217baf0>]}
[0m21:37:46.060974 [info ] [MainThread]: 
[0m21:37:46.061161 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:37:46.061300 [info ] [MainThread]: 
[0m21:37:46.061537 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:37:46.063462 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_marts'
[0m21:37:46.063721 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_staging'
[0m21:37:46.069595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_intermediate'
[0m21:37:46.107754 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_marts"
[0m21:37:46.107972 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:37:46.108153 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:37:46.108304 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: BEGIN
[0m21:37:46.108459 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: BEGIN
[0m21:37:46.108625 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:37:46.108807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:46.108948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:46.109083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:46.179998 [debug] [ThreadPool]: SQL status: BEGIN in 0.071 seconds
[0m21:37:46.180364 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m21:37:46.180578 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m21:37:46.180773 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:37:46.180957 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_marts"
[0m21:37:46.181112 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:37:46.181283 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:37:46.181461 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m21:37:46.181635 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_intermediate'
  
[0m21:37:46.190948 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m21:37:46.191174 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m21:37:46.191344 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m21:37:46.192091 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:37:46.192688 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: ROLLBACK
[0m21:37:46.193236 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: ROLLBACK
[0m21:37:46.193883 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: Close
[0m21:37:46.194059 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:37:46.194205 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: Close
[0m21:37:46.197490 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:46.197678 [debug] [MainThread]: On master: BEGIN
[0m21:37:46.197821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:46.212085 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m21:37:46.212276 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:46.212475 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:37:46.217486 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m21:37:46.218475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d441162-ff68-4405-894b-3f1b2b3c006e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d79cc0>]}
[0m21:37:46.218726 [debug] [MainThread]: On master: ROLLBACK
[0m21:37:46.219313 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:46.219506 [debug] [MainThread]: On master: BEGIN
[0m21:37:46.220358 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:37:46.220512 [debug] [MainThread]: On master: COMMIT
[0m21:37:46.220656 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:46.220814 [debug] [MainThread]: On master: COMMIT
[0m21:37:46.221287 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:37:46.221460 [debug] [MainThread]: On master: Close
[0m21:37:46.222978 [debug] [Thread-1 (]: Began running node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:37:46.223199 [debug] [Thread-3 (]: Began running node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:37:46.223381 [debug] [Thread-4 (]: Began running node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:37:46.223546 [debug] [Thread-2 (]: Began running node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:37:46.223741 [info ] [Thread-1 (]: 1 of 16 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m21:37:46.223951 [info ] [Thread-3 (]: 3 of 16 START test not_null_fct_orders_order_id ................................ [RUN]
[0m21:37:46.224146 [info ] [Thread-4 (]: 4 of 16 START test not_null_int_order_payments_order_id ........................ [RUN]
[0m21:37:46.224382 [info ] [Thread-2 (]: 2 of 16 START test not_null_fct_orders_customer_id ............................. [RUN]
[0m21:37:46.224629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_marts, now test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m21:37:46.224843 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_intermediate, now test.dbt_test.not_null_fct_orders_order_id.4e687af8d0)
[0m21:37:46.225085 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b'
[0m21:37:46.225278 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m21:37:46.225475 [debug] [Thread-1 (]: Began compiling node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:37:46.225658 [debug] [Thread-3 (]: Began compiling node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:37:46.225849 [debug] [Thread-4 (]: Began compiling node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:37:46.226044 [debug] [Thread-2 (]: Began compiling node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:37:46.238583 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:37:46.237777 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"
[0m21:37:46.241063 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"
[0m21:37:46.242941 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:37:46.243661 [debug] [Thread-4 (]: Began executing node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:37:46.243881 [debug] [Thread-1 (]: Began executing node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:37:46.253174 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"
[0m21:37:46.254310 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:37:46.254506 [debug] [Thread-2 (]: Began executing node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:37:46.254678 [debug] [Thread-3 (]: Began executing node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:37:46.255813 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:37:46.257060 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"
[0m21:37:46.257539 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"
[0m21:37:46.257741 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:37:46.257941 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:37:46.258113 [debug] [Thread-4 (]: On test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b: BEGIN
[0m21:37:46.258280 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"
[0m21:37:46.258442 [debug] [Thread-2 (]: On test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m21:37:46.258609 [debug] [Thread-1 (]: On test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m21:37:46.258779 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:37:46.258942 [debug] [Thread-3 (]: On test.dbt_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m21:37:46.259093 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:37:46.259243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:46.259453 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:37:46.274107 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m21:37:46.274361 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"
[0m21:37:46.274661 [debug] [Thread-4 (]: On test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dbt_test"."analytics_intermediate"."int_order_payments"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:37:46.275864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m21:37:46.276054 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:37:46.276236 [debug] [Thread-1 (]: On test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dbt_test"."analytics_marts"."dim_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:37:46.276418 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m21:37:46.276660 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:37:46.276872 [debug] [Thread-2 (]: On test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dbt_test"."analytics_marts"."fct_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:37:46.277250 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m21:37:46.277423 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"
[0m21:37:46.277594 [debug] [Thread-3 (]: On test.dbt_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dbt_test"."analytics_marts"."fct_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:37:46.278836 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:37:46.281227 [debug] [Thread-1 (]: On test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m21:37:46.281447 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m21:37:46.281629 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m21:37:46.281788 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:37:46.282528 [debug] [Thread-4 (]: On test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b: ROLLBACK
[0m21:37:46.282715 [debug] [Thread-1 (]: On test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m21:37:46.283379 [debug] [Thread-2 (]: On test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m21:37:46.283998 [debug] [Thread-3 (]: On test.dbt_test.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m21:37:46.284424 [info ] [Thread-1 (]: 1 of 16 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.06s]
[0m21:37:46.284769 [debug] [Thread-1 (]: Finished running node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:37:46.284998 [debug] [Thread-1 (]: Began running node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:37:46.285183 [debug] [Thread-3 (]: On test.dbt_test.not_null_fct_orders_order_id.4e687af8d0: Close
[0m21:37:46.285334 [debug] [Thread-2 (]: On test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m21:37:46.285474 [debug] [Thread-4 (]: On test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b: Close
[0m21:37:46.285640 [info ] [Thread-1 (]: 5 of 16 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m21:37:46.285941 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 0.06s]
[0m21:37:46.286642 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fct_orders_customer_id ................................... [[32mPASS[0m in 0.06s]
[0m21:37:46.287174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m21:37:46.287500 [info ] [Thread-4 (]: 4 of 16 PASS not_null_int_order_payments_order_id .............................. [[32mPASS[0m in 0.06s]
[0m21:37:46.287797 [debug] [Thread-3 (]: Finished running node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:37:46.288045 [debug] [Thread-2 (]: Finished running node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:37:46.288272 [debug] [Thread-1 (]: Began compiling node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:37:46.288507 [debug] [Thread-4 (]: Finished running node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:37:46.289145 [debug] [Thread-3 (]: Began running node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:37:46.289519 [debug] [Thread-2 (]: Began running node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:37:46.293284 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:37:46.293535 [debug] [Thread-4 (]: Began running node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:37:46.293769 [info ] [Thread-3 (]: 6 of 16 START test not_null_stg_customers_email ................................ [RUN]
[0m21:37:46.294030 [info ] [Thread-2 (]: 7 of 16 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m21:37:46.294359 [info ] [Thread-4 (]: 8 of 16 START test not_null_stg_orders_order_id ................................ [RUN]
[0m21:37:46.295242 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_fct_orders_order_id.4e687af8d0, now test.dbt_test.not_null_stg_customers_email.d7cf761533)
[0m21:37:46.295942 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5)
[0m21:37:46.296379 [debug] [Thread-1 (]: Began executing node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:37:46.296611 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b, now test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64)
[0m21:37:46.296814 [debug] [Thread-3 (]: Began compiling node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:37:46.297015 [debug] [Thread-2 (]: Began compiling node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:37:46.347384 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:37:46.356554 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:37:46.356744 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m21:37:46.356911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:46.348269 [debug] [Thread-4 (]: Began compiling node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:37:46.355996 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:37:46.374891 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:37:46.375369 [debug] [Thread-4 (]: Began executing node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:37:46.376597 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:37:46.378720 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:37:46.379002 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m21:37:46.379335 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:37:46.352341 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_customers_email.d7cf761533"
[0m21:37:46.379956 [debug] [Thread-2 (]: Began executing node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:37:46.382113 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:37:46.382772 [debug] [Thread-3 (]: Began executing node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:37:46.385343 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_customers_email.d7cf761533"
[0m21:37:46.386208 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:37:46.397149 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m21:37:46.397805 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:37:46.398956 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.not_null_stg_customers_email.d7cf761533"
[0m21:37:46.399189 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_customers_email.d7cf761533: BEGIN
[0m21:37:46.399357 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:37:46.420994 [debug] [Thread-4 (]: SQL status: BEGIN in 0.042 seconds
[0m21:37:46.421311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.064 seconds
[0m21:37:46.421527 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m21:37:46.421726 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:37:46.421921 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:37:46.422103 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.not_null_stg_customers_email.d7cf761533"
[0m21:37:46.422290 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dbt_test"."analytics_staging"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:37:46.422488 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dbt_test"."analytics_staging"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:37:46.422683 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dbt_test"."analytics_staging"."stg_customers"
where email is null



  
  
      
    ) dbt_internal_test
[0m21:37:46.426467 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:37:46.427510 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m21:37:46.427732 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m21:37:46.427914 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m21:37:46.428645 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m21:37:46.428836 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m21:37:46.429027 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m21:37:46.429667 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m21:37:46.430208 [info ] [Thread-1 (]: 5 of 16 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.14s]
[0m21:37:46.429913 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:37:46.430542 [debug] [Thread-1 (]: Finished running node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:37:46.430733 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dbt_test"."analytics_staging"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:37:46.430939 [debug] [Thread-1 (]: Began running node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:37:46.431153 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m21:37:46.431363 [info ] [Thread-1 (]: 9 of 16 START test not_null_stg_payments_order_id .............................. [RUN]
[0m21:37:46.431649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_test.not_null_stg_payments_order_id.601cf57649)
[0m21:37:46.431842 [debug] [Thread-1 (]: Began compiling node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:37:46.434026 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_payments_order_id.601cf57649"
[0m21:37:46.434498 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_customers_email.d7cf761533: Close
[0m21:37:46.434327 [info ] [Thread-4 (]: 8 of 16 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.14s]
[0m21:37:46.434832 [debug] [Thread-4 (]: Finished running node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:37:46.435084 [info ] [Thread-3 (]: 6 of 16 PASS not_null_stg_customers_email ...................................... [[32mPASS[0m in 0.14s]
[0m21:37:46.435368 [debug] [Thread-4 (]: Began running node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:37:46.436132 [info ] [Thread-4 (]: 10 of 16 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m21:37:46.435729 [debug] [Thread-3 (]: Finished running node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:37:46.436355 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_test.not_null_stg_payments_payment_id.c19cc50075)
[0m21:37:46.436568 [debug] [Thread-3 (]: Began running node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:37:46.435962 [debug] [Thread-1 (]: Began executing node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:37:46.436767 [debug] [Thread-4 (]: Began compiling node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:37:46.437003 [info ] [Thread-3 (]: 11 of 16 START test unique_dim_customers_customer_id ........................... [RUN]
[0m21:37:46.438902 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_payments_order_id.601cf57649"
[0m21:37:46.441009 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"
[0m21:37:46.441235 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m21:37:46.441442 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_customers_email.d7cf761533, now test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m21:37:46.442464 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m21:37:46.442664 [debug] [Thread-3 (]: Began compiling node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:37:46.445835 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:37:46.446039 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m21:37:46.446331 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_stg_payments_order_id.601cf57649"
[0m21:37:46.446513 [debug] [Thread-4 (]: Began executing node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:37:46.446950 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_payments_order_id.601cf57649: BEGIN
[0m21:37:46.446788 [info ] [Thread-2 (]: 7 of 16 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.15s]
[0m21:37:46.447200 [debug] [Thread-3 (]: Began executing node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:37:46.448681 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"
[0m21:37:46.448888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:46.449197 [debug] [Thread-2 (]: Finished running node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:37:46.450370 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:37:46.450752 [debug] [Thread-2 (]: Began running node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:37:46.451728 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"
[0m21:37:46.452170 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m21:37:46.452377 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:37:46.451239 [info ] [Thread-2 (]: 12 of 16 START test unique_fct_orders_order_id ................................. [RUN]
[0m21:37:46.453190 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:37:46.453559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_test.unique_fct_orders_order_id.523ddb6ce5)
[0m21:37:46.453777 [debug] [Thread-3 (]: On test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m21:37:46.453979 [debug] [Thread-2 (]: Began compiling node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:37:46.454202 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:37:46.457172 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"
[0m21:37:46.457826 [debug] [Thread-2 (]: Began executing node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:37:46.458991 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"
[0m21:37:46.459351 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"
[0m21:37:46.459523 [debug] [Thread-2 (]: On test.dbt_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m21:37:46.459684 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:37:46.485825 [debug] [Thread-4 (]: SQL status: BEGIN in 0.033 seconds
[0m21:37:46.486127 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"
[0m21:37:46.486358 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_id
from "dbt_test"."analytics_staging"."stg_payments"
where payment_id is null



  
  
      
    ) dbt_internal_test
[0m21:37:46.490771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m21:37:46.491015 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m21:37:46.491212 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_stg_payments_order_id.601cf57649"
[0m21:37:46.491420 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"
[0m21:37:46.491615 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_payments_order_id.601cf57649: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_payments_order_id.601cf57649"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dbt_test"."analytics_staging"."stg_payments"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:37:46.491820 [debug] [Thread-2 (]: On test.dbt_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_test"."analytics_marts"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:37:46.492133 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m21:37:46.493005 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m21:37:46.495240 [debug] [Thread-3 (]: SQL status: BEGIN in 0.041 seconds
[0m21:37:46.495444 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:37:46.495631 [debug] [Thread-3 (]: On test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_test"."analytics_marts"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:37:46.496058 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:37:46.496893 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_payments_order_id.601cf57649: ROLLBACK
[0m21:37:46.497120 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m21:37:46.497804 [debug] [Thread-2 (]: On test.dbt_test.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m21:37:46.499231 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_payments_payment_id.c19cc50075: Close
[0m21:37:46.499656 [info ] [Thread-4 (]: 10 of 16 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.06s]
[0m21:37:46.500000 [debug] [Thread-4 (]: Finished running node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:37:46.500214 [debug] [Thread-4 (]: Began running node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:37:46.500412 [info ] [Thread-4 (]: 13 of 16 START test unique_int_order_payments_order_id ......................... [RUN]
[0m21:37:46.500669 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_payments_payment_id.c19cc50075, now test.dbt_test.unique_int_order_payments_order_id.804c2d5021)
[0m21:37:46.500876 [debug] [Thread-4 (]: Began compiling node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:37:46.503038 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"
[0m21:37:46.503474 [debug] [Thread-4 (]: Began executing node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:37:46.505077 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"
[0m21:37:46.505409 [debug] [Thread-2 (]: On test.dbt_test.unique_fct_orders_order_id.523ddb6ce5: Close
[0m21:37:46.505734 [info ] [Thread-2 (]: 12 of 16 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.05s]
[0m21:37:46.506047 [debug] [Thread-2 (]: Finished running node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:37:46.506222 [debug] [Thread-2 (]: Began running node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:37:46.506428 [info ] [Thread-2 (]: 14 of 16 START test unique_stg_customers_customer_id ........................... [RUN]
[0m21:37:46.506660 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"
[0m21:37:46.506843 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_test.unique_fct_orders_order_id.523ddb6ce5, now test.dbt_test.unique_stg_customers_customer_id.c7614daada)
[0m21:37:46.507017 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_payments_order_id.601cf57649: Close
[0m21:37:46.507204 [debug] [Thread-4 (]: On test.dbt_test.unique_int_order_payments_order_id.804c2d5021: BEGIN
[0m21:37:46.507386 [debug] [Thread-2 (]: Began compiling node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:37:46.507590 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:37:46.507843 [info ] [Thread-1 (]: 9 of 16 PASS not_null_stg_payments_order_id .................................... [[32mPASS[0m in 0.08s]
[0m21:37:46.509864 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.unique_stg_customers_customer_id.c7614daada"
[0m21:37:46.510111 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m21:37:46.510993 [debug] [Thread-1 (]: Finished running node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:37:46.512580 [debug] [Thread-3 (]: On test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m21:37:46.512830 [debug] [Thread-1 (]: Began running node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:37:46.513035 [debug] [Thread-2 (]: Began executing node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:37:46.514520 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_test.unique_stg_customers_customer_id.c7614daada"
[0m21:37:46.513314 [info ] [Thread-1 (]: 15 of 16 START test unique_stg_orders_order_id ................................. [RUN]
[0m21:37:46.515148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_payments_order_id.601cf57649, now test.dbt_test.unique_stg_orders_order_id.e3b841c71a)
[0m21:37:46.515787 [debug] [Thread-1 (]: Began compiling node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:37:46.518538 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"
[0m21:37:46.518996 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.unique_stg_customers_customer_id.c7614daada"
[0m21:37:46.519232 [debug] [Thread-1 (]: Began executing node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:37:46.519595 [debug] [Thread-2 (]: On test.dbt_test.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m21:37:46.520875 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"
[0m21:37:46.521164 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:37:46.521479 [debug] [Thread-3 (]: On test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m21:37:46.522143 [info ] [Thread-3 (]: 11 of 16 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.08s]
[0m21:37:46.522466 [debug] [Thread-3 (]: Finished running node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:37:46.522695 [debug] [Thread-3 (]: Began running node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:37:46.522876 [info ] [Thread-3 (]: 16 of 16 START test unique_stg_payments_payment_id ............................. [RUN]
[0m21:37:46.523144 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd, now test.dbt_test.unique_stg_payments_payment_id.3744510712)
[0m21:37:46.523334 [debug] [Thread-3 (]: Began compiling node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:37:46.525717 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.unique_stg_payments_payment_id.3744510712"
[0m21:37:46.526429 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"
[0m21:37:46.526633 [debug] [Thread-1 (]: On test.dbt_test.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m21:37:46.526801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:46.527065 [debug] [Thread-3 (]: Began executing node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:37:46.528247 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_test.unique_stg_payments_payment_id.3744510712"
[0m21:37:46.528597 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.unique_stg_payments_payment_id.3744510712"
[0m21:37:46.528773 [debug] [Thread-3 (]: On test.dbt_test.unique_stg_payments_payment_id.3744510712: BEGIN
[0m21:37:46.528927 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:37:46.566414 [debug] [Thread-4 (]: SQL status: BEGIN in 0.059 seconds
[0m21:37:46.566718 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"
[0m21:37:46.566999 [debug] [Thread-4 (]: On test.dbt_test.unique_int_order_payments_order_id.804c2d5021: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_test"."analytics_intermediate"."int_order_payments"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:37:46.569249 [debug] [Thread-3 (]: SQL status: BEGIN in 0.040 seconds
[0m21:37:46.569523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m21:37:46.569699 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.unique_stg_payments_payment_id.3744510712"
[0m21:37:46.569863 [debug] [Thread-2 (]: SQL status: BEGIN in 0.049 seconds
[0m21:37:46.570042 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"
[0m21:37:46.570221 [debug] [Thread-3 (]: On test.dbt_test.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_stg_payments_payment_id.3744510712"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "dbt_test"."analytics_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:37:46.570400 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.unique_stg_customers_customer_id.c7614daada"
[0m21:37:46.570576 [debug] [Thread-1 (]: On test.dbt_test.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_test"."analytics_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:37:46.570869 [debug] [Thread-2 (]: On test.dbt_test.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_test"."analytics_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:37:46.571940 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m21:37:46.572822 [debug] [Thread-4 (]: On test.dbt_test.unique_int_order_payments_order_id.804c2d5021: ROLLBACK
[0m21:37:46.573756 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:37:46.574538 [debug] [Thread-3 (]: On test.dbt_test.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m21:37:46.574793 [debug] [Thread-4 (]: On test.dbt_test.unique_int_order_payments_order_id.804c2d5021: Close
[0m21:37:46.574988 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:37:46.575723 [debug] [Thread-2 (]: On test.dbt_test.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m21:37:46.576067 [info ] [Thread-4 (]: 13 of 16 PASS unique_int_order_payments_order_id ............................... [[32mPASS[0m in 0.08s]
[0m21:37:46.576456 [debug] [Thread-3 (]: On test.dbt_test.unique_stg_payments_payment_id.3744510712: Close
[0m21:37:46.576739 [debug] [Thread-4 (]: Finished running node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:37:46.576988 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m21:37:46.577187 [debug] [Thread-2 (]: On test.dbt_test.unique_stg_customers_customer_id.c7614daada: Close
[0m21:37:46.578044 [info ] [Thread-3 (]: 16 of 16 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.05s]
[0m21:37:46.579177 [debug] [Thread-1 (]: On test.dbt_test.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m21:37:46.579695 [info ] [Thread-2 (]: 14 of 16 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.07s]
[0m21:37:46.580304 [debug] [Thread-3 (]: Finished running node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:37:46.580926 [debug] [Thread-2 (]: Finished running node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:37:46.582343 [debug] [Thread-1 (]: On test.dbt_test.unique_stg_orders_order_id.e3b841c71a: Close
[0m21:37:46.582961 [info ] [Thread-1 (]: 15 of 16 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.07s]
[0m21:37:46.583907 [debug] [Thread-1 (]: Finished running node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:37:46.585530 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:46.585712 [debug] [MainThread]: On master: BEGIN
[0m21:37:46.585857 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:37:46.602636 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m21:37:46.602917 [debug] [MainThread]: On master: COMMIT
[0m21:37:46.603091 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:46.603232 [debug] [MainThread]: On master: COMMIT
[0m21:37:46.603688 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:37:46.603882 [debug] [MainThread]: On master: Close
[0m21:37:46.604134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:46.604338 [debug] [MainThread]: Connection 'test.dbt_test.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m21:37:46.604480 [debug] [MainThread]: Connection 'test.dbt_test.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m21:37:46.604605 [debug] [MainThread]: Connection 'test.dbt_test.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m21:37:46.604725 [debug] [MainThread]: Connection 'test.dbt_test.unique_int_order_payments_order_id.804c2d5021' was properly closed.
[0m21:37:46.604897 [info ] [MainThread]: 
[0m21:37:46.605179 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m21:37:46.606595 [debug] [MainThread]: Command end result
[0m21:37:46.619480 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:37:46.620436 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:37:46.625443 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:37:46.625619 [info ] [MainThread]: 
[0m21:37:46.625817 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:37:46.625970 [info ] [MainThread]: 
[0m21:37:46.626143 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m21:37:46.627898 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.1448193, "process_in_blocks": "0", "process_kernel_time": 0.201701, "process_mem_max_rss": "158318592", "process_out_blocks": "0", "process_user_time": 1.350209}
[0m21:37:46.628164 [debug] [MainThread]: Command `dbt test` succeeded at 21:37:46.628115 after 1.15 seconds
[0m21:37:46.628381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11203d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d63d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d63b70>]}
[0m21:37:46.628569 [debug] [MainThread]: Flushing usage events
[0m21:37:47.086279 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:38:06.714254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106818590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b4b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b4bb10>]}


============================== 21:38:06.717330 | a05c6252-e76c-4b1d-b787-554c87632749 ==============================
[0m21:38:06.717330 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:38:06.717661 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'profiles_dir': '/Users/adil/.dbt', 'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'write_json': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'partial_parse': 'True', 'warn_error': 'None'}
[0m21:38:06.817509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a05c6252-e76c-4b1d-b787-554c87632749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac49d0>]}
[0m21:38:06.846551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a05c6252-e76c-4b1d-b787-554c87632749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f3790>]}
[0m21:38:06.847284 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:38:06.899857 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:38:06.950521 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:38:06.950779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a05c6252-e76c-4b1d-b787-554c87632749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109eb650>]}
[0m21:38:07.542982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a05c6252-e76c-4b1d-b787-554c87632749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cfb200>]}
[0m21:38:07.582302 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:38:07.583416 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:38:07.599929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a05c6252-e76c-4b1d-b787-554c87632749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d9fd90>]}
[0m21:38:07.600158 [info ] [MainThread]: Found 6 models, 16 data tests, 3 sources, 459 macros
[0m21:38:07.600331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a05c6252-e76c-4b1d-b787-554c87632749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111063ee0>]}
[0m21:38:07.601434 [info ] [MainThread]: 
[0m21:38:07.601604 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:38:07.601737 [info ] [MainThread]: 
[0m21:38:07.601950 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:38:07.603787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_staging'
[0m21:38:07.608919 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_marts'
[0m21:38:07.609174 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_intermediate'
[0m21:38:07.634596 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:38:07.634819 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_marts"
[0m21:38:07.634988 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:38:07.635144 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:38:07.635287 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: BEGIN
[0m21:38:07.635431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:07.635569 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: BEGIN
[0m21:38:07.635695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:07.636274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:07.699887 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m21:38:07.700166 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m21:38:07.700334 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m21:38:07.700478 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:38:07.700632 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_marts"
[0m21:38:07.700766 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:38:07.700960 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_intermediate'
  
[0m21:38:07.701183 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m21:38:07.701369 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:38:07.713160 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m21:38:07.713411 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.012 seconds
[0m21:38:07.713591 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.012 seconds
[0m21:38:07.714329 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: ROLLBACK
[0m21:38:07.714935 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: ROLLBACK
[0m21:38:07.715505 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:38:07.716311 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: Close
[0m21:38:07.716513 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:38:07.716690 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: Close
[0m21:38:07.720035 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:07.720218 [debug] [MainThread]: On master: BEGIN
[0m21:38:07.720365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:38:07.735332 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m21:38:07.735547 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:07.735751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:38:07.741286 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m21:38:07.742497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a05c6252-e76c-4b1d-b787-554c87632749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111110d0>]}
[0m21:38:07.742769 [debug] [MainThread]: On master: ROLLBACK
[0m21:38:07.743370 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:07.743511 [debug] [MainThread]: On master: BEGIN
[0m21:38:07.744511 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:38:07.744717 [debug] [MainThread]: On master: COMMIT
[0m21:38:07.744880 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:07.745024 [debug] [MainThread]: On master: COMMIT
[0m21:38:07.745504 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:38:07.745694 [debug] [MainThread]: On master: Close
[0m21:38:07.747407 [debug] [Thread-1 (]: Began running node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:38:07.747624 [debug] [Thread-3 (]: Began running node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:38:07.747802 [debug] [Thread-4 (]: Began running node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:38:07.747970 [debug] [Thread-2 (]: Began running node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:38:07.748162 [info ] [Thread-1 (]: 1 of 16 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m21:38:07.748376 [info ] [Thread-3 (]: 3 of 16 START test not_null_fct_orders_order_id ................................ [RUN]
[0m21:38:07.748565 [info ] [Thread-4 (]: 4 of 16 START test not_null_int_order_payments_order_id ........................ [RUN]
[0m21:38:07.748987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m21:38:07.749210 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_intermediate, now test.dbt_test.not_null_fct_orders_order_id.4e687af8d0)
[0m21:38:07.748731 [info ] [Thread-2 (]: 2 of 16 START test not_null_fct_orders_customer_id ............................. [RUN]
[0m21:38:07.749505 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b'
[0m21:38:07.749680 [debug] [Thread-1 (]: Began compiling node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:38:07.749853 [debug] [Thread-3 (]: Began compiling node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:38:07.750030 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_marts, now test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m21:38:07.750283 [debug] [Thread-4 (]: Began compiling node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:38:07.760044 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:38:07.761957 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"
[0m21:38:07.762164 [debug] [Thread-2 (]: Began compiling node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:38:07.764133 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"
[0m21:38:07.765974 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:38:07.766399 [debug] [Thread-1 (]: Began executing node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:38:07.766631 [debug] [Thread-4 (]: Began executing node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:38:07.766796 [debug] [Thread-3 (]: Began executing node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:38:07.775770 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:38:07.776867 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"
[0m21:38:07.777950 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"
[0m21:38:07.778244 [debug] [Thread-2 (]: Began executing node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:38:07.779456 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:38:07.779765 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:38:07.779974 [debug] [Thread-1 (]: On test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m21:38:07.780201 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"
[0m21:38:07.780397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.780594 [debug] [Thread-3 (]: On test.dbt_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m21:38:07.780804 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"
[0m21:38:07.781105 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:38:07.781291 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:38:07.781487 [debug] [Thread-4 (]: On test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b: BEGIN
[0m21:38:07.781675 [debug] [Thread-2 (]: On test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m21:38:07.781901 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:38:07.782064 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:38:07.798630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m21:38:07.798914 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:38:07.799147 [debug] [Thread-1 (]: On test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dbt_test"."analytics_marts"."dim_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.799527 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m21:38:07.799707 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m21:38:07.799899 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:38:07.800080 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"
[0m21:38:07.800371 [debug] [Thread-2 (]: On test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dbt_test"."analytics_marts"."fct_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.800609 [debug] [Thread-3 (]: On test.dbt_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dbt_test"."analytics_marts"."fct_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.800813 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m21:38:07.801077 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"
[0m21:38:07.801265 [debug] [Thread-4 (]: On test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dbt_test"."analytics_intermediate"."int_order_payments"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.801831 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:38:07.804212 [debug] [Thread-1 (]: On test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m21:38:07.804496 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:38:07.805273 [debug] [Thread-3 (]: On test.dbt_test.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m21:38:07.805470 [debug] [Thread-1 (]: On test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m21:38:07.805676 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m21:38:07.805851 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:38:07.806626 [debug] [Thread-2 (]: On test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m21:38:07.806961 [info ] [Thread-1 (]: 1 of 16 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.06s]
[0m21:38:07.807174 [debug] [Thread-3 (]: On test.dbt_test.not_null_fct_orders_order_id.4e687af8d0: Close
[0m21:38:07.807828 [debug] [Thread-4 (]: On test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b: ROLLBACK
[0m21:38:07.808130 [debug] [Thread-1 (]: Finished running node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:38:07.808640 [debug] [Thread-2 (]: On test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m21:38:07.808468 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 0.06s]
[0m21:38:07.808895 [debug] [Thread-1 (]: Began running node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:38:07.809119 [debug] [Thread-4 (]: On test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b: Close
[0m21:38:07.809397 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fct_orders_customer_id ................................... [[32mPASS[0m in 0.06s]
[0m21:38:07.809652 [debug] [Thread-3 (]: Finished running node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:38:07.809835 [info ] [Thread-1 (]: 5 of 16 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m21:38:07.810105 [debug] [Thread-2 (]: Finished running node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:38:07.810293 [debug] [Thread-3 (]: Began running node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:38:07.810486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m21:38:07.810767 [info ] [Thread-4 (]: 4 of 16 PASS not_null_int_order_payments_order_id .............................. [[32mPASS[0m in 0.06s]
[0m21:38:07.810985 [debug] [Thread-2 (]: Began running node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:38:07.811332 [debug] [Thread-1 (]: Began compiling node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:38:07.811655 [debug] [Thread-4 (]: Finished running node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:38:07.811176 [info ] [Thread-3 (]: 6 of 16 START test not_null_stg_customers_email ................................ [RUN]
[0m21:38:07.811893 [info ] [Thread-2 (]: 7 of 16 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m21:38:07.814145 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:38:07.814362 [debug] [Thread-4 (]: Began running node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:38:07.814575 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_fct_orders_order_id.4e687af8d0, now test.dbt_test.not_null_stg_customers_email.d7cf761533)
[0m21:38:07.814837 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5)
[0m21:38:07.815148 [info ] [Thread-4 (]: 8 of 16 START test not_null_stg_orders_order_id ................................ [RUN]
[0m21:38:07.815359 [debug] [Thread-3 (]: Began compiling node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:38:07.815589 [debug] [Thread-2 (]: Began compiling node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:38:07.815773 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b, now test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64)
[0m21:38:07.820580 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_customers_email.d7cf761533"
[0m21:38:07.822549 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:38:07.822802 [debug] [Thread-4 (]: Began compiling node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:38:07.822995 [debug] [Thread-1 (]: Began executing node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:38:07.825207 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:38:07.826574 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:38:07.826874 [debug] [Thread-2 (]: Began executing node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:38:07.827047 [debug] [Thread-3 (]: Began executing node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:38:07.828031 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:38:07.829067 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_customers_email.d7cf761533"
[0m21:38:07.829259 [debug] [Thread-4 (]: Began executing node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:38:07.829555 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:38:07.830742 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:38:07.830963 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m21:38:07.831150 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.not_null_stg_customers_email.d7cf761533"
[0m21:38:07.831330 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:38:07.831545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.831711 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_customers_email.d7cf761533: BEGIN
[0m21:38:07.831883 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m21:38:07.832127 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:38:07.832287 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:38:07.832446 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:38:07.832617 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m21:38:07.832888 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:38:07.847368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m21:38:07.847635 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:38:07.847844 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m21:38:07.848060 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dbt_test"."analytics_staging"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.848315 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m21:38:07.848520 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.not_null_stg_customers_email.d7cf761533"
[0m21:38:07.848755 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:38:07.848965 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dbt_test"."analytics_staging"."stg_customers"
where email is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.849200 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dbt_test"."analytics_staging"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.849438 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m21:38:07.849639 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:38:07.849824 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dbt_test"."analytics_staging"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.851027 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:38:07.851842 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m21:38:07.852080 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:38:07.852259 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:38:07.852984 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m21:38:07.853182 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:38:07.853345 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m21:38:07.854096 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m21:38:07.854884 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m21:38:07.855103 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m21:38:07.855395 [info ] [Thread-1 (]: 5 of 16 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.04s]
[0m21:38:07.855733 [info ] [Thread-2 (]: 7 of 16 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.04s]
[0m21:38:07.856470 [debug] [Thread-1 (]: Finished running node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:38:07.856932 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_customers_email.d7cf761533: Close
[0m21:38:07.857538 [debug] [Thread-2 (]: Finished running node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:38:07.857809 [debug] [Thread-1 (]: Began running node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:38:07.857981 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m21:38:07.858369 [info ] [Thread-3 (]: 6 of 16 PASS not_null_stg_customers_email ...................................... [[32mPASS[0m in 0.04s]
[0m21:38:07.858596 [debug] [Thread-2 (]: Began running node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:38:07.858953 [info ] [Thread-1 (]: 9 of 16 START test not_null_stg_payments_order_id .............................. [RUN]
[0m21:38:07.859612 [debug] [Thread-3 (]: Finished running node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:38:07.859990 [info ] [Thread-4 (]: 8 of 16 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.04s]
[0m21:38:07.860250 [info ] [Thread-2 (]: 10 of 16 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m21:38:07.860545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_test.not_null_stg_payments_order_id.601cf57649)
[0m21:38:07.860881 [debug] [Thread-3 (]: Began running node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:38:07.861377 [debug] [Thread-4 (]: Finished running node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:38:07.861849 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_test.not_null_stg_payments_payment_id.c19cc50075)
[0m21:38:07.862046 [debug] [Thread-1 (]: Began compiling node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:38:07.862224 [info ] [Thread-3 (]: 11 of 16 START test unique_dim_customers_customer_id ........................... [RUN]
[0m21:38:07.862469 [debug] [Thread-4 (]: Began running node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:38:07.862718 [debug] [Thread-2 (]: Began compiling node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:38:07.865964 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_payments_order_id.601cf57649"
[0m21:38:07.866224 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_customers_email.d7cf761533, now test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m21:38:07.866458 [info ] [Thread-4 (]: 12 of 16 START test unique_fct_orders_order_id ................................. [RUN]
[0m21:38:07.869086 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"
[0m21:38:07.869367 [debug] [Thread-3 (]: Began compiling node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:38:07.869615 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_test.unique_fct_orders_order_id.523ddb6ce5)
[0m21:38:07.873242 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:38:07.873522 [debug] [Thread-4 (]: Began compiling node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:38:07.873731 [debug] [Thread-1 (]: Began executing node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:38:07.873913 [debug] [Thread-2 (]: Began executing node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:38:07.875726 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"
[0m21:38:07.877090 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_payments_order_id.601cf57649"
[0m21:38:07.878074 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"
[0m21:38:07.878254 [debug] [Thread-3 (]: Began executing node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:38:07.879332 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:38:07.879657 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_stg_payments_order_id.601cf57649"
[0m21:38:07.880011 [debug] [Thread-4 (]: Began executing node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:38:07.880206 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"
[0m21:38:07.880374 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_payments_order_id.601cf57649: BEGIN
[0m21:38:07.881353 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"
[0m21:38:07.881535 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:38:07.881689 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m21:38:07.881849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.882051 [debug] [Thread-3 (]: On test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m21:38:07.882210 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:38:07.882448 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"
[0m21:38:07.882677 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:38:07.882880 [debug] [Thread-4 (]: On test.dbt_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m21:38:07.883071 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:38:07.901158 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m21:38:07.901464 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m21:38:07.901672 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m21:38:07.901898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m21:38:07.902119 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"
[0m21:38:07.902336 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:38:07.902506 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"
[0m21:38:07.902701 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_stg_payments_order_id.601cf57649"
[0m21:38:07.902893 [debug] [Thread-4 (]: On test.dbt_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_test"."analytics_marts"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:38:07.903132 [debug] [Thread-3 (]: On test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_test"."analytics_marts"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:38:07.903343 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_id
from "dbt_test"."analytics_staging"."stg_payments"
where payment_id is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.903532 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_payments_order_id.601cf57649: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_payments_order_id.601cf57649"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dbt_test"."analytics_staging"."stg_payments"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.906006 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:38:07.906207 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:38:07.907065 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_payments_order_id.601cf57649: ROLLBACK
[0m21:38:07.907289 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:38:07.907507 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:38:07.908160 [debug] [Thread-4 (]: On test.dbt_test.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m21:38:07.908948 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m21:38:07.909589 [debug] [Thread-3 (]: On test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m21:38:07.909769 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_payments_order_id.601cf57649: Close
[0m21:38:07.910185 [info ] [Thread-1 (]: 9 of 16 PASS not_null_stg_payments_order_id .................................... [[32mPASS[0m in 0.05s]
[0m21:38:07.910499 [debug] [Thread-1 (]: Finished running node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:38:07.910720 [debug] [Thread-1 (]: Began running node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:38:07.910899 [debug] [Thread-4 (]: On test.dbt_test.unique_fct_orders_order_id.523ddb6ce5: Close
[0m21:38:07.911069 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_payments_payment_id.c19cc50075: Close
[0m21:38:07.911247 [info ] [Thread-1 (]: 13 of 16 START test unique_int_order_payments_order_id ......................... [RUN]
[0m21:38:07.911416 [debug] [Thread-3 (]: On test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m21:38:07.912186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_payments_order_id.601cf57649, now test.dbt_test.unique_int_order_payments_order_id.804c2d5021)
[0m21:38:07.911733 [info ] [Thread-4 (]: 12 of 16 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.04s]
[0m21:38:07.912032 [info ] [Thread-2 (]: 10 of 16 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.05s]
[0m21:38:07.912565 [debug] [Thread-1 (]: Began compiling node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:38:07.912823 [info ] [Thread-3 (]: 11 of 16 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.05s]
[0m21:38:07.913314 [debug] [Thread-4 (]: Finished running node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:38:07.913665 [debug] [Thread-2 (]: Finished running node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:38:07.916819 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"
[0m21:38:07.917316 [debug] [Thread-3 (]: Finished running node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:38:07.917543 [debug] [Thread-4 (]: Began running node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:38:07.917949 [debug] [Thread-2 (]: Began running node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:38:07.918194 [debug] [Thread-3 (]: Began running node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:38:07.918599 [info ] [Thread-4 (]: 14 of 16 START test unique_stg_customers_customer_id ........................... [RUN]
[0m21:38:07.919021 [info ] [Thread-2 (]: 15 of 16 START test unique_stg_orders_order_id ................................. [RUN]
[0m21:38:07.919929 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_test.unique_fct_orders_order_id.523ddb6ce5, now test.dbt_test.unique_stg_customers_customer_id.c7614daada)
[0m21:38:07.919464 [info ] [Thread-3 (]: 16 of 16 START test unique_stg_payments_payment_id ............................. [RUN]
[0m21:38:07.920182 [debug] [Thread-1 (]: Began executing node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:38:07.920399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_payments_payment_id.c19cc50075, now test.dbt_test.unique_stg_orders_order_id.e3b841c71a)
[0m21:38:07.920565 [debug] [Thread-4 (]: Began compiling node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:38:07.920730 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd, now test.dbt_test.unique_stg_payments_payment_id.3744510712)
[0m21:38:07.922456 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"
[0m21:38:07.922644 [debug] [Thread-2 (]: Began compiling node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:38:07.924545 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.unique_stg_customers_customer_id.c7614daada"
[0m21:38:07.924732 [debug] [Thread-3 (]: Began compiling node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:38:07.926517 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"
[0m21:38:07.928547 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.unique_stg_payments_payment_id.3744510712"
[0m21:38:07.928857 [debug] [Thread-4 (]: Began executing node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:38:07.929069 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"
[0m21:38:07.930103 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_test.unique_stg_customers_customer_id.c7614daada"
[0m21:38:07.930310 [debug] [Thread-1 (]: On test.dbt_test.unique_int_order_payments_order_id.804c2d5021: BEGIN
[0m21:38:07.930474 [debug] [Thread-2 (]: Began executing node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:38:07.930640 [debug] [Thread-3 (]: Began executing node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:38:07.930847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.932015 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"
[0m21:38:07.933022 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_test.unique_stg_payments_payment_id.3744510712"
[0m21:38:07.933213 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.unique_stg_customers_customer_id.c7614daada"
[0m21:38:07.933492 [debug] [Thread-4 (]: On test.dbt_test.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m21:38:07.933660 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:38:07.933915 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"
[0m21:38:07.934105 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.unique_stg_payments_payment_id.3744510712"
[0m21:38:07.934279 [debug] [Thread-2 (]: On test.dbt_test.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m21:38:07.934447 [debug] [Thread-3 (]: On test.dbt_test.unique_stg_payments_payment_id.3744510712: BEGIN
[0m21:38:07.934607 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:38:07.934767 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:38:07.948266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m21:38:07.948577 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m21:38:07.948790 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"
[0m21:38:07.949020 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m21:38:07.949212 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.unique_stg_customers_customer_id.c7614daada"
[0m21:38:07.949414 [debug] [Thread-1 (]: On test.dbt_test.unique_int_order_payments_order_id.804c2d5021: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_test"."analytics_intermediate"."int_order_payments"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:38:07.949631 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.unique_stg_payments_payment_id.3744510712"
[0m21:38:07.949811 [debug] [Thread-4 (]: On test.dbt_test.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_test"."analytics_staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:38:07.950014 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m21:38:07.950239 [debug] [Thread-3 (]: On test.dbt_test.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_stg_payments_payment_id.3744510712"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "dbt_test"."analytics_staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:38:07.950486 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"
[0m21:38:07.950794 [debug] [Thread-2 (]: On test.dbt_test.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_test"."analytics_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:38:07.952768 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:38:07.952977 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:38:07.953764 [debug] [Thread-4 (]: On test.dbt_test.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m21:38:07.953949 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:38:07.954592 [debug] [Thread-3 (]: On test.dbt_test.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m21:38:07.954788 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:38:07.955611 [debug] [Thread-1 (]: On test.dbt_test.unique_int_order_payments_order_id.804c2d5021: ROLLBACK
[0m21:38:07.955800 [debug] [Thread-4 (]: On test.dbt_test.unique_stg_customers_customer_id.c7614daada: Close
[0m21:38:07.956542 [debug] [Thread-2 (]: On test.dbt_test.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m21:38:07.956714 [debug] [Thread-3 (]: On test.dbt_test.unique_stg_payments_payment_id.3744510712: Close
[0m21:38:07.957050 [info ] [Thread-4 (]: 14 of 16 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.04s]
[0m21:38:07.957342 [info ] [Thread-3 (]: 16 of 16 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.04s]
[0m21:38:07.957540 [debug] [Thread-2 (]: On test.dbt_test.unique_stg_orders_order_id.e3b841c71a: Close
[0m21:38:07.957724 [debug] [Thread-1 (]: On test.dbt_test.unique_int_order_payments_order_id.804c2d5021: Close
[0m21:38:07.957991 [debug] [Thread-4 (]: Finished running node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:38:07.958226 [debug] [Thread-3 (]: Finished running node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:38:07.958494 [info ] [Thread-2 (]: 15 of 16 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.04s]
[0m21:38:07.958768 [info ] [Thread-1 (]: 13 of 16 PASS unique_int_order_payments_order_id ............................... [[32mPASS[0m in 0.05s]
[0m21:38:07.959148 [debug] [Thread-2 (]: Finished running node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:38:07.959387 [debug] [Thread-1 (]: Finished running node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:38:07.960208 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:07.960366 [debug] [MainThread]: On master: BEGIN
[0m21:38:07.960493 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:38:07.972437 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m21:38:07.972645 [debug] [MainThread]: On master: COMMIT
[0m21:38:07.972801 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:07.972949 [debug] [MainThread]: On master: COMMIT
[0m21:38:07.973468 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:38:07.973626 [debug] [MainThread]: On master: Close
[0m21:38:07.973839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:07.973978 [debug] [MainThread]: Connection 'test.dbt_test.unique_int_order_payments_order_id.804c2d5021' was properly closed.
[0m21:38:07.974113 [debug] [MainThread]: Connection 'test.dbt_test.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m21:38:07.974227 [debug] [MainThread]: Connection 'test.dbt_test.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m21:38:07.974338 [debug] [MainThread]: Connection 'test.dbt_test.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m21:38:07.974486 [info ] [MainThread]: 
[0m21:38:07.974636 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m21:38:07.975753 [debug] [MainThread]: Command end result
[0m21:38:07.990447 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:38:07.991393 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:38:07.994938 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:38:07.995106 [info ] [MainThread]: 
[0m21:38:07.995288 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:38:07.995441 [info ] [MainThread]: 
[0m21:38:07.995608 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m21:38:07.997450 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3202094, "process_in_blocks": "0", "process_kernel_time": 0.223094, "process_mem_max_rss": "135004160", "process_out_blocks": "0", "process_user_time": 1.779655}
[0m21:38:07.997657 [debug] [MainThread]: Command `dbt test` succeeded at 21:38:07.997618 after 1.32 seconds
[0m21:38:07.997827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111003e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111579590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11157bbb0>]}
[0m21:38:07.998006 [debug] [MainThread]: Flushing usage events
[0m21:38:08.396095 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:38:39.687348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d74590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba7d90>]}


============================== 21:38:39.690401 | 289f9316-9788-4e37-b690-05b7ba2efafb ==============================
[0m21:38:39.690401 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:38:39.690730 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'version_check': 'True', 'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'profiles_dir': '/Users/adil/.dbt', 'partial_parse': 'True', 'invocation_command': 'dbt docs generate', 'quiet': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'empty': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_format': 'default'}
[0m21:38:39.795368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '289f9316-9788-4e37-b690-05b7ba2efafb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f209d0>]}
[0m21:38:39.825961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '289f9316-9788-4e37-b690-05b7ba2efafb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4f790>]}
[0m21:38:39.826568 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:38:39.880547 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:38:39.964117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:38:39.964350 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:38:39.987001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '289f9316-9788-4e37-b690-05b7ba2efafb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aeb150>]}
[0m21:38:40.003814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '289f9316-9788-4e37-b690-05b7ba2efafb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd86e0>]}
[0m21:38:40.004075 [info ] [MainThread]: Found 6 models, 16 data tests, 3 sources, 459 macros
[0m21:38:40.004258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '289f9316-9788-4e37-b690-05b7ba2efafb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c782f0>]}
[0m21:38:40.005475 [info ] [MainThread]: 
[0m21:38:40.005687 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:38:40.005830 [info ] [MainThread]: 
[0m21:38:40.006077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:38:40.008116 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_marts'
[0m21:38:40.009146 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_staging'
[0m21:38:40.009409 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_intermediate'
[0m21:38:40.063719 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:38:40.064000 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:38:40.064212 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_marts"
[0m21:38:40.064400 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:38:40.064579 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: BEGIN
[0m21:38:40.064750 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: BEGIN
[0m21:38:40.064917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:40.065069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:40.065213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:40.133639 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m21:38:40.133955 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m21:38:40.134180 [debug] [ThreadPool]: SQL status: BEGIN in 0.069 seconds
[0m21:38:40.134332 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_marts"
[0m21:38:40.134499 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:38:40.134653 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:38:40.134818 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m21:38:40.135018 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:38:40.135230 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_intermediate'
  
[0m21:38:40.145011 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m21:38:40.145196 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m21:38:40.145354 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m21:38:40.146116 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:38:40.146723 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: ROLLBACK
[0m21:38:40.147270 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: ROLLBACK
[0m21:38:40.148048 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: Close
[0m21:38:40.148220 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: Close
[0m21:38:40.148353 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:38:40.151718 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:40.151900 [debug] [MainThread]: On master: BEGIN
[0m21:38:40.152040 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:38:40.165577 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m21:38:40.165842 [debug] [MainThread]: Using postgres connection "master"
[0m21:38:40.166068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:38:40.171557 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m21:38:40.172516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '289f9316-9788-4e37-b690-05b7ba2efafb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d67a00>]}
[0m21:38:40.172758 [debug] [MainThread]: On master: ROLLBACK
[0m21:38:40.173291 [debug] [MainThread]: On master: Close
[0m21:38:40.174761 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_orders
[0m21:38:40.174983 [debug] [Thread-1 (]: Began running node model.dbt_test.stg_customers
[0m21:38:40.175163 [debug] [Thread-3 (]: Began running node model.dbt_test.stg_payments
[0m21:38:40.175363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.stg_orders)
[0m21:38:40.175547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_marts, now model.dbt_test.stg_customers)
[0m21:38:40.175720 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_intermediate, now model.dbt_test.stg_payments)
[0m21:38:40.175894 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_orders
[0m21:38:40.176056 [debug] [Thread-1 (]: Began compiling node model.dbt_test.stg_customers
[0m21:38:40.176247 [debug] [Thread-3 (]: Began compiling node model.dbt_test.stg_payments
[0m21:38:40.180836 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_orders"
[0m21:38:40.182341 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:38:40.183666 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.stg_payments"
[0m21:38:40.184268 [debug] [Thread-1 (]: Began executing node model.dbt_test.stg_customers
[0m21:38:40.184646 [debug] [Thread-1 (]: Finished running node model.dbt_test.stg_customers
[0m21:38:40.184886 [debug] [Thread-3 (]: Began executing node model.dbt_test.stg_payments
[0m21:38:40.185107 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_orders
[0m21:38:40.185430 [debug] [Thread-3 (]: Finished running node model.dbt_test.stg_payments
[0m21:38:40.185605 [debug] [Thread-4 (]: Began running node model.dbt_test.dim_customers
[0m21:38:40.185767 [debug] [Thread-1 (]: Began running node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:38:40.186041 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_orders
[0m21:38:40.186209 [debug] [Thread-3 (]: Began running node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:38:40.186482 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_test.dim_customers'
[0m21:38:40.186715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_test.stg_customers, now test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m21:38:40.186925 [debug] [Thread-2 (]: Began running node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:38:40.187201 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_test.stg_payments, now test.dbt_test.not_null_stg_customers_email.d7cf761533)
[0m21:38:40.187414 [debug] [Thread-4 (]: Began compiling node model.dbt_test.dim_customers
[0m21:38:40.187576 [debug] [Thread-1 (]: Began compiling node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:38:40.187742 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_test.stg_orders, now test.dbt_test.unique_stg_customers_customer_id.c7614daada)
[0m21:38:40.187918 [debug] [Thread-3 (]: Began compiling node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:38:40.189595 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_test.dim_customers"
[0m21:38:40.195218 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:38:40.195422 [debug] [Thread-2 (]: Began compiling node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:38:40.197472 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_customers_email.d7cf761533"
[0m21:38:40.200581 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.unique_stg_customers_customer_id.c7614daada"
[0m21:38:40.200958 [debug] [Thread-1 (]: Began executing node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:38:40.201146 [debug] [Thread-4 (]: Began executing node model.dbt_test.dim_customers
[0m21:38:40.201500 [debug] [Thread-1 (]: Finished running node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:38:40.201674 [debug] [Thread-3 (]: Began executing node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:38:40.201992 [debug] [Thread-4 (]: Finished running node model.dbt_test.dim_customers
[0m21:38:40.202182 [debug] [Thread-2 (]: Began executing node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:38:40.202362 [debug] [Thread-1 (]: Began running node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:38:40.202670 [debug] [Thread-3 (]: Finished running node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:38:40.202850 [debug] [Thread-4 (]: Began running node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:38:40.203143 [debug] [Thread-2 (]: Finished running node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:38:40.203359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_test.not_null_stg_payments_order_id.601cf57649)
[0m21:38:40.203553 [debug] [Thread-3 (]: Began running node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:38:40.203737 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_test.dim_customers, now test.dbt_test.not_null_stg_payments_payment_id.c19cc50075)
[0m21:38:40.203962 [debug] [Thread-2 (]: Began running node model.dbt_test.int_order_payments
[0m21:38:40.204165 [debug] [Thread-1 (]: Began compiling node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:38:40.204335 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_customers_email.d7cf761533, now test.dbt_test.unique_stg_payments_payment_id.3744510712)
[0m21:38:40.204495 [debug] [Thread-4 (]: Began compiling node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:38:40.204660 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_test.unique_stg_customers_customer_id.c7614daada, now model.dbt_test.int_order_payments)
[0m21:38:40.206372 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_payments_order_id.601cf57649"
[0m21:38:40.206547 [debug] [Thread-3 (]: Began compiling node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:38:40.208650 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"
[0m21:38:40.208830 [debug] [Thread-2 (]: Began compiling node model.dbt_test.int_order_payments
[0m21:38:40.210558 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.unique_stg_payments_payment_id.3744510712"
[0m21:38:40.212147 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.int_order_payments"
[0m21:38:40.212367 [debug] [Thread-1 (]: Began executing node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:38:40.212658 [debug] [Thread-4 (]: Began executing node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:38:40.212954 [debug] [Thread-1 (]: Finished running node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:38:40.213136 [debug] [Thread-3 (]: Began executing node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:38:40.213441 [debug] [Thread-4 (]: Finished running node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:38:40.213614 [debug] [Thread-2 (]: Began executing node model.dbt_test.int_order_payments
[0m21:38:40.213782 [debug] [Thread-1 (]: Began running node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:38:40.214080 [debug] [Thread-3 (]: Finished running node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:38:40.214261 [debug] [Thread-4 (]: Began running node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:38:40.214559 [debug] [Thread-2 (]: Finished running node model.dbt_test.int_order_payments
[0m21:38:40.214731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_payments_order_id.601cf57649, now test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5)
[0m21:38:40.214922 [debug] [Thread-3 (]: Began running node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:38:40.215101 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_payments_payment_id.c19cc50075, now test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64)
[0m21:38:40.215281 [debug] [Thread-2 (]: Began running node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:38:40.215458 [debug] [Thread-1 (]: Began compiling node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:38:40.215660 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_test.unique_stg_payments_payment_id.3744510712, now test.dbt_test.unique_stg_orders_order_id.e3b841c71a)
[0m21:38:40.215825 [debug] [Thread-4 (]: Began compiling node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:38:40.215990 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_test.int_order_payments, now test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m21:38:40.217897 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:38:40.218092 [debug] [Thread-3 (]: Began compiling node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:38:40.219949 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:38:40.220149 [debug] [Thread-2 (]: Began compiling node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:38:40.224564 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"
[0m21:38:40.224882 [debug] [Thread-1 (]: Began executing node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:38:40.226690 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:38:40.227089 [debug] [Thread-1 (]: Finished running node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:38:40.227284 [debug] [Thread-4 (]: Began executing node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:38:40.227522 [debug] [Thread-1 (]: Began running node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:38:40.227855 [debug] [Thread-4 (]: Finished running node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:38:40.228033 [debug] [Thread-3 (]: Began executing node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:38:40.228200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m21:38:40.228375 [debug] [Thread-2 (]: Began executing node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:38:40.228565 [debug] [Thread-4 (]: Began running node model.dbt_test.fct_orders
[0m21:38:40.228861 [debug] [Thread-3 (]: Finished running node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:38:40.229037 [debug] [Thread-1 (]: Began compiling node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:38:40.229328 [debug] [Thread-2 (]: Finished running node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:38:40.229512 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64, now model.dbt_test.fct_orders)
[0m21:38:40.229693 [debug] [Thread-3 (]: Began running node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:38:40.263234 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:38:40.263539 [debug] [Thread-2 (]: Began running node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:38:40.263792 [debug] [Thread-4 (]: Began compiling node model.dbt_test.fct_orders
[0m21:38:40.264042 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_test.unique_stg_orders_order_id.e3b841c71a, now test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b)
[0m21:38:40.264289 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_test.unique_int_order_payments_order_id.804c2d5021)
[0m21:38:40.265891 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_test.fct_orders"
[0m21:38:40.266101 [debug] [Thread-3 (]: Began compiling node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:38:40.266295 [debug] [Thread-2 (]: Began compiling node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:38:40.268236 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"
[0m21:38:40.268429 [debug] [Thread-1 (]: Began executing node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:38:40.270449 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"
[0m21:38:40.270858 [debug] [Thread-1 (]: Finished running node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:38:40.271069 [debug] [Thread-4 (]: Began executing node model.dbt_test.fct_orders
[0m21:38:40.271613 [debug] [Thread-4 (]: Finished running node model.dbt_test.fct_orders
[0m21:38:40.271886 [debug] [Thread-3 (]: Began executing node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:38:40.272071 [debug] [Thread-4 (]: Began running node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:38:40.272239 [debug] [Thread-1 (]: Began running node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:38:40.272517 [debug] [Thread-3 (]: Finished running node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:38:40.272713 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_test.fct_orders, now test.dbt_test.not_null_fct_orders_order_id.4e687af8d0)
[0m21:38:40.272891 [debug] [Thread-2 (]: Began executing node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:38:40.273061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd, now test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m21:38:40.273243 [debug] [Thread-3 (]: Began running node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:38:40.273414 [debug] [Thread-4 (]: Began compiling node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:38:40.273704 [debug] [Thread-2 (]: Finished running node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:38:40.273855 [debug] [Thread-1 (]: Began compiling node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:38:40.274025 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b, now test.dbt_test.unique_fct_orders_order_id.523ddb6ce5)
[0m21:38:40.275806 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"
[0m21:38:40.277758 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:38:40.277938 [debug] [Thread-3 (]: Began compiling node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:38:40.279778 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"
[0m21:38:40.279963 [debug] [Thread-4 (]: Began executing node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:38:40.280328 [debug] [Thread-4 (]: Finished running node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:38:40.280543 [debug] [Thread-1 (]: Began executing node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:38:40.280824 [debug] [Thread-1 (]: Finished running node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:38:40.280999 [debug] [Thread-3 (]: Began executing node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:38:40.281341 [debug] [Thread-3 (]: Finished running node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:38:40.281981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:40.282135 [debug] [MainThread]: Connection 'test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b' was properly closed.
[0m21:38:40.282264 [debug] [MainThread]: Connection 'test.dbt_test.unique_int_order_payments_order_id.804c2d5021' was properly closed.
[0m21:38:40.282385 [debug] [MainThread]: Connection 'test.dbt_test.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m21:38:40.282507 [debug] [MainThread]: Connection 'test.dbt_test.not_null_fct_orders_order_id.4e687af8d0' was properly closed.
[0m21:38:40.283923 [debug] [MainThread]: Command end result
[0m21:38:40.329426 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:38:40.330720 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:38:40.334319 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:38:40.336720 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m21:38:40.336893 [info ] [MainThread]: Building catalog
[0m21:38:40.341360 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_test.information_schema'
[0m21:38:40.345149 [debug] [ThreadPool]: Using postgres connection "dbt_test.information_schema"
[0m21:38:40.345336 [debug] [ThreadPool]: On dbt_test.information_schema: BEGIN
[0m21:38:40.345470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:40.367054 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m21:38:40.367352 [debug] [ThreadPool]: Using postgres connection "dbt_test.information_schema"
[0m21:38:40.367604 [debug] [ThreadPool]: On dbt_test.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "dbt_test.information_schema"} */

    
    

    select
        'dbt_test' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('payments')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('analytics_marts') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('analytics_staging') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('analytics_intermediate') and
           upper(tbl.relname) = upper('int_order_payments')) or (upper(sch.nspname) = upper('analytics_staging') and
           upper(tbl.relname) = upper('stg_payments')) or (upper(sch.nspname) = upper('analytics_marts') and
           upper(tbl.relname) = upper('fct_orders')) or (upper(sch.nspname) = upper('analytics_staging') and
           upper(tbl.relname) = upper('stg_orders')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m21:38:40.384417 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.017 seconds
[0m21:38:40.386512 [debug] [ThreadPool]: On dbt_test.information_schema: ROLLBACK
[0m21:38:40.387311 [debug] [ThreadPool]: On dbt_test.information_schema: Close
[0m21:38:40.395517 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/adil/repos/airflow-test/dbt_test/target/catalog.json
[0m21:38:40.409210 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:38:40.410186 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:38:40.410361 [info ] [MainThread]: Catalog written to /Users/adil/repos/airflow-test/dbt_test/target/catalog.json
[0m21:38:40.412088 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.7620862, "process_in_blocks": "0", "process_kernel_time": 0.189675, "process_mem_max_rss": "125845504", "process_out_blocks": "0", "process_user_time": 1.105977}
[0m21:38:40.412362 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:38:40.412316 after 0.76 seconds
[0m21:38:40.412530 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:38:40.412660 [debug] [MainThread]: Connection 'dbt_test.information_schema' was properly closed.
[0m21:38:40.412824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a91310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10803bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10803aaf0>]}
[0m21:38:40.413020 [debug] [MainThread]: Flushing usage events
[0m21:38:40.813358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:38:55.722884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10427c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050abb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050abd90>]}


============================== 21:38:55.725721 | eb63e1ae-aa7f-4589-8c8b-7f1befc336a5 ==============================
[0m21:38:55.725721 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:38:55.726035 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': '/Users/adil/.dbt', 'introspect': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'invocation_command': 'dbt docs serve', 'quiet': 'False'}
[0m21:38:55.820151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb63e1ae-aa7f-4589-8c8b-7f1befc336a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044289d0>]}
[0m21:38:55.849077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb63e1ae-aa7f-4589-8c8b-7f1befc336a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f578a0>]}
[0m21:38:56.088279 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m21:38:56.093696 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/adil/repos/airflow-test/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/adil/repos/airflow-test/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/adil/repos/airflow-test/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/adil/repos/airflow-test/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/adil/repos/airflow-test/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/adil/repos/airflow-test/.venv/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Users/adil/repos/airflow-test/.venv/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 457, in __init__
    self.server_bind()
    ~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 478, in server_bind
    self.socket.bind(self.server_address)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
OSError: [Errno 48] Address already in use

[0m21:38:56.105300 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.41487795, "process_in_blocks": "0", "process_kernel_time": 0.114781, "process_mem_max_rss": "112607232", "process_out_blocks": "0", "process_user_time": 0.734213}
[0m21:38:56.108155 [debug] [MainThread]: Command `dbt docs serve` failed at 21:38:56.107415 after 0.42 seconds
[0m21:38:56.108700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eeab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eeac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee32f0>]}
[0m21:38:56.109519 [debug] [MainThread]: Flushing usage events
[0m21:38:56.538707 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:39:09.128767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118420590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a14bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a14bd90>]}


============================== 21:39:09.132919 | 5c684bea-fa7b-4ab3-ab91-c0a7fc4991cc ==============================
[0m21:39:09.132919 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:39:09.133900 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'empty': 'None', 'printer_width': '80', 'debug': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt docs serve --port 8081', 'static_parser': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'target_path': 'None', 'quiet': 'False', 'warn_error': 'None', 'introspect': 'True', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'no_print': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/adil/.dbt', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m21:39:09.253866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c684bea-fa7b-4ab3-ab91-c0a7fc4991cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187c09d0>]}
[0m21:39:09.282672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c684bea-fa7b-4ab3-ab91-c0a7fc4991cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119df38a0>]}
[0m21:39:48.137819 [error] [MainThread]: Encountered an error:

[0m21:39:48.145593 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/adil/repos/airflow-test/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/adil/repos/airflow-test/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Users/adil/repos/airflow-test/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/Users/adil/repos/airflow-test/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/Users/adil/repos/airflow-test/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/Users/adil/repos/airflow-test/.venv/lib/python3.13/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Users/adil/repos/airflow-test/.venv/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m21:39:48.148783 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 39.058205, "process_in_blocks": "0", "process_kernel_time": 0.131581, "process_mem_max_rss": "112705536", "process_out_blocks": "0", "process_user_time": 0.793874}
[0m21:39:48.149265 [debug] [MainThread]: Command `dbt docs serve` failed at 21:39:48.149190 after 39.06 seconds
[0m21:39:48.150350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a832d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a832c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a82b2f0>]}
[0m21:39:48.150795 [debug] [MainThread]: Flushing usage events
[0m21:39:48.712268 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:39:51.454690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108518590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f4b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f4bb10>]}


============================== 21:39:51.458093 | 14a2de3a-adbf-4c92-98b1-374212013ce8 ==============================
[0m21:39:51.458093 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:39:51.458414 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_format': 'default', 'write_json': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'invocation_command': 'dbt clean', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'static_parser': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/adil/.dbt', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'debug': 'False', 'use_colors': 'True', 'empty': 'None'}
[0m21:39:51.523540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14a2de3a-adbf-4c92-98b1-374212013ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c49d0>]}
[0m21:39:51.541693 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12770942, "process_in_blocks": "0", "process_kernel_time": 0.121702, "process_mem_max_rss": "107642880", "process_out_blocks": "0", "process_user_time": 0.733122}
[0m21:39:51.541957 [debug] [MainThread]: Command `dbt clean` succeeded at 21:39:51.541907 after 0.13 seconds
[0m21:39:51.542152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df3020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a240850>]}
[0m21:39:51.542336 [debug] [MainThread]: Flushing usage events
[0m21:39:51.982733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:40:43.418555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a14b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a14bb10>]}


============================== 21:40:43.421688 | 56a2a919-a84c-43c8-925b-8e504712ab43 ==============================
[0m21:40:43.421688 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:40:43.422010 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'profiles_dir': '/Users/adil/.dbt', 'empty': 'False', 'warn_error': 'None', 'use_colors': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt run -m staging', 'quiet': 'False'}
[0m21:40:43.422254 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:40:43.422443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '56a2a919-a84c-43c8-925b-8e504712ab43', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1988a0>]}
[0m21:40:43.521849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56a2a919-a84c-43c8-925b-8e504712ab43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f3790>]}
[0m21:40:43.549794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56a2a919-a84c-43c8-925b-8e504712ab43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ffa50>]}
[0m21:40:43.550404 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:40:43.599035 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:40:43.599467 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:40:43.599670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56a2a919-a84c-43c8-925b-8e504712ab43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0bc140>]}
[0m21:40:44.229318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56a2a919-a84c-43c8-925b-8e504712ab43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b306190>]}
[0m21:40:44.274263 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:40:44.275715 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:40:44.290216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56a2a919-a84c-43c8-925b-8e504712ab43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2042c0>]}
[0m21:40:44.290486 [info ] [MainThread]: Found 6 models, 16 data tests, 3 sources, 459 macros
[0m21:40:44.290666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56a2a919-a84c-43c8-925b-8e504712ab43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6ecdd0>]}
[0m21:40:44.291506 [info ] [MainThread]: 
[0m21:40:44.291688 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:40:44.291832 [info ] [MainThread]: 
[0m21:40:44.292068 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:40:44.293974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:40:44.337463 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:40:44.337717 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:40:44.337878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:44.384583 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.047 seconds
[0m21:40:44.385409 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:40:44.386266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_marts)
[0m21:40:44.386568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_intermediate'
[0m21:40:44.389583 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_marts"
[0m21:40:44.389895 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_staging'
[0m21:40:44.390814 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:40:44.390986 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: BEGIN
[0m21:40:44.393123 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:40:44.393286 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: BEGIN
[0m21:40:44.393429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:40:44.393582 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:40:44.393717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:44.393928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:44.407796 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m21:40:44.408064 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m21:40:44.408240 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_marts"
[0m21:40:44.408406 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:40:44.408570 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:40:44.408732 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m21:40:44.408903 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:40:44.409063 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:40:44.409289 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_intermediate'
  
[0m21:40:44.413363 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m21:40:44.413534 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m21:40:44.414183 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: ROLLBACK
[0m21:40:44.414339 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m21:40:44.414891 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: ROLLBACK
[0m21:40:44.415567 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:40:44.415728 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: Close
[0m21:40:44.416320 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: Close
[0m21:40:44.416462 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:40:44.419028 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:44.419191 [debug] [MainThread]: On master: BEGIN
[0m21:40:44.419323 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:40:44.431754 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m21:40:44.431943 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:44.432142 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:40:44.436311 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m21:40:44.437153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56a2a919-a84c-43c8-925b-8e504712ab43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b709650>]}
[0m21:40:44.437374 [debug] [MainThread]: On master: ROLLBACK
[0m21:40:44.437912 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:44.438079 [debug] [MainThread]: On master: BEGIN
[0m21:40:44.438873 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:40:44.439035 [debug] [MainThread]: On master: COMMIT
[0m21:40:44.439191 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:44.439333 [debug] [MainThread]: On master: COMMIT
[0m21:40:44.439806 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:40:44.439933 [debug] [MainThread]: On master: Close
[0m21:40:44.441877 [debug] [Thread-1 (]: Began running node model.dbt_test.stg_customers
[0m21:40:44.442080 [debug] [Thread-3 (]: Began running node model.dbt_test.stg_payments
[0m21:40:44.442274 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_orders
[0m21:40:44.442517 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_staging.stg_customers .................... [RUN]
[0m21:40:44.442729 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_staging.stg_payments ..................... [RUN]
[0m21:40:44.443053 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m21:40:44.443307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_marts, now model.dbt_test.stg_customers)
[0m21:40:44.443498 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.stg_payments)
[0m21:40:44.443673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_intermediate, now model.dbt_test.stg_orders)
[0m21:40:44.443863 [debug] [Thread-1 (]: Began compiling node model.dbt_test.stg_customers
[0m21:40:44.444015 [debug] [Thread-3 (]: Began compiling node model.dbt_test.stg_payments
[0m21:40:44.444190 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_orders
[0m21:40:44.448766 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:40:44.450182 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.stg_payments"
[0m21:40:44.451792 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_orders"
[0m21:40:44.452501 [debug] [Thread-1 (]: Began executing node model.dbt_test.stg_customers
[0m21:40:44.452700 [debug] [Thread-3 (]: Began executing node model.dbt_test.stg_payments
[0m21:40:44.452875 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_orders
[0m21:40:44.474678 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:40:44.475201 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.stg_payments"
[0m21:40:44.476812 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_orders"
[0m21:40:44.477554 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:40:44.477762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:40:44.477970 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:40:44.478143 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: BEGIN
[0m21:40:44.478314 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:40:44.478479 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: BEGIN
[0m21:40:44.478640 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:40:44.478791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:44.478950 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:40:44.494353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m21:40:44.494631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:40:44.494838 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."analytics_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:40:44.495062 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m21:40:44.495310 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m21:40:44.495504 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:40:44.495715 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:40:44.495912 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */

  create view "dbt_test"."analytics_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."orders"
),
casted as (
    select
        id           as order_id,
        user_id      as customer_id,
        order_date::timestamp as order_timestamp,
        lower(status) as status,
        total_amount::numeric(10,2) as total_amount
    from source
)
select * from casted
  );
[0m21:40:44.496157 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */

  create view "dbt_test"."analytics_staging"."stg_payments__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."payments"
),
casted as (
    select
        id           as payment_id,
        order_id,
        lower(payment_method) as payment_method,
        amount::numeric(10,2) as amount,
        paid_at::timestamp    as paid_at
    from source
)
select * from casted
  );
[0m21:40:44.499906 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:40:44.500122 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:40:44.500310 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:40:44.503826 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:40:44.505328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:40:44.506785 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:40:44.507006 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."analytics_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:40:44.507207 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:40:44.507393 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."analytics_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m21:40:44.508253 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:40:44.508451 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:40:44.509706 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:40:44.509866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:40:44.511052 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:40:44.511238 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."analytics_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:40:44.512646 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:40:44.512826 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."analytics_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:40:44.513014 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:40:44.513428 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:40:44.519301 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:40:44.519480 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:40:44.526241 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:40:44.527073 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:40:44.527307 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:40:44.527482 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:40:44.527671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:40:44.527821 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:40:44.527983 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:40:44.528131 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:40:44.528274 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:40:44.530129 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:40:44.533141 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_customers__dbt_backup"
[0m21:40:44.533337 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m21:40:44.535738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:40:44.535913 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m21:40:44.536946 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_payments__dbt_backup"
[0m21:40:44.537138 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."analytics_staging"."stg_customers__dbt_backup" cascade
[0m21:40:44.538098 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_orders__dbt_backup"
[0m21:40:44.538435 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:40:44.538793 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:40:44.538977 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
drop view if exists "dbt_test"."analytics_staging"."stg_payments__dbt_backup" cascade
[0m21:40:44.539146 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
drop view if exists "dbt_test"."analytics_staging"."stg_orders__dbt_backup" cascade
[0m21:40:44.540197 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:40:44.541411 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: Close
[0m21:40:44.541615 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:40:44.542302 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: Close
[0m21:40:44.542786 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:40:44.543698 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: Close
[0m21:40:44.544365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a2a919-a84c-43c8-925b-8e504712ab43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c470370>]}
[0m21:40:44.544696 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_staging.stg_customers ............... [[32mCREATE VIEW[0m in 0.10s]
[0m21:40:44.544925 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a2a919-a84c-43c8-925b-8e504712ab43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c18edd0>]}
[0m21:40:44.545191 [debug] [Thread-1 (]: Finished running node model.dbt_test.stg_customers
[0m21:40:44.545344 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a2a919-a84c-43c8-925b-8e504712ab43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108733ad0>]}
[0m21:40:44.545621 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_staging.stg_payments ................ [[32mCREATE VIEW[0m in 0.10s]
[0m21:40:44.546224 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_staging.stg_orders .................. [[32mCREATE VIEW[0m in 0.10s]
[0m21:40:44.546498 [debug] [Thread-3 (]: Finished running node model.dbt_test.stg_payments
[0m21:40:44.546729 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_orders
[0m21:40:44.547776 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:44.547942 [debug] [MainThread]: On master: BEGIN
[0m21:40:44.548080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:40:44.559549 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m21:40:44.559800 [debug] [MainThread]: On master: COMMIT
[0m21:40:44.559962 [debug] [MainThread]: Using postgres connection "master"
[0m21:40:44.560108 [debug] [MainThread]: On master: COMMIT
[0m21:40:44.560675 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:40:44.560809 [debug] [MainThread]: On master: Close
[0m21:40:44.561016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:44.561171 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:40:44.561293 [debug] [MainThread]: Connection 'model.dbt_test.stg_orders' was properly closed.
[0m21:40:44.561421 [debug] [MainThread]: Connection 'model.dbt_test.stg_payments' was properly closed.
[0m21:40:44.561590 [info ] [MainThread]: 
[0m21:40:44.561745 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m21:40:44.562182 [debug] [MainThread]: Command end result
[0m21:40:44.576064 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:40:44.577034 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:40:44.580330 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:40:44.580511 [info ] [MainThread]: 
[0m21:40:44.580690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:40:44.580831 [info ] [MainThread]: 
[0m21:40:44.580985 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m21:40:44.581238 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:40:44.582916 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1999639, "process_in_blocks": "0", "process_kernel_time": 0.186937, "process_mem_max_rss": "136757248", "process_out_blocks": "0", "process_user_time": 1.581479}
[0m21:40:44.583148 [debug] [MainThread]: Command `dbt run` succeeded at 21:40:44.583107 after 1.20 seconds
[0m21:40:44.583326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2cb530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c38b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c38ab70>]}
[0m21:40:44.583499 [debug] [MainThread]: Flushing usage events
[0m21:40:44.978197 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:06.660530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106068590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9bb10>]}


============================== 21:41:06.663643 | 644e0092-5747-4d86-b35c-531fc96e4aaa ==============================
[0m21:41:06.663643 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:41:06.663976 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'version_check': 'True', 'printer_width': '80', 'debug': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'invocation_command': 'dbt run -s staging', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'empty': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/adil/.dbt', 'indirect_selection': 'eager'}
[0m21:41:06.761228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '644e0092-5747-4d86-b35c-531fc96e4aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062149d0>]}
[0m21:41:06.790456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '644e0092-5747-4d86-b35c-531fc96e4aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d43790>]}
[0m21:41:06.791697 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:41:06.840117 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:41:06.913846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:41:06.914074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:41:06.935702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '644e0092-5747-4d86-b35c-531fc96e4aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ddf750>]}
[0m21:41:06.976984 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:41:06.978152 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:41:06.989851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '644e0092-5747-4d86-b35c-531fc96e4aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec2f30>]}
[0m21:41:06.990079 [info ] [MainThread]: Found 6 models, 16 data tests, 3 sources, 459 macros
[0m21:41:06.990249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '644e0092-5747-4d86-b35c-531fc96e4aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106feecf0>]}
[0m21:41:06.991093 [info ] [MainThread]: 
[0m21:41:06.991277 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:41:06.991418 [info ] [MainThread]: 
[0m21:41:06.991652 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:41:06.993367 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:41:07.018200 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:41:07.018403 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:41:07.018549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:07.087417 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.069 seconds
[0m21:41:07.088167 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:41:07.089037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_analytics_intermediate)
[0m21:41:07.089306 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_marts'
[0m21:41:07.092306 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:41:07.092569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_staging'
[0m21:41:07.093492 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_marts"
[0m21:41:07.093694 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: BEGIN
[0m21:41:07.094781 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:41:07.094934 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: BEGIN
[0m21:41:07.095069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:41:07.095199 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:41:07.095332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:07.095531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:07.119798 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m21:41:07.120277 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m21:41:07.120457 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:41:07.120629 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_marts"
[0m21:41:07.120840 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:41:07.121060 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m21:41:07.122622 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m21:41:07.123065 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:41:07.123747 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_intermediate'
  
[0m21:41:07.130729 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.009 seconds
[0m21:41:07.130968 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m21:41:07.131728 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: ROLLBACK
[0m21:41:07.131906 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m21:41:07.132569 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:41:07.133151 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: ROLLBACK
[0m21:41:07.133317 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: Close
[0m21:41:07.133855 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: Close
[0m21:41:07.134014 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:41:07.136738 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:07.136915 [debug] [MainThread]: On master: BEGIN
[0m21:41:07.137059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:41:07.148953 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m21:41:07.149139 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:07.149339 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:41:07.154479 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m21:41:07.155201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '644e0092-5747-4d86-b35c-531fc96e4aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082497e0>]}
[0m21:41:07.155458 [debug] [MainThread]: On master: ROLLBACK
[0m21:41:07.155994 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:07.156182 [debug] [MainThread]: On master: BEGIN
[0m21:41:07.156963 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:41:07.157110 [debug] [MainThread]: On master: COMMIT
[0m21:41:07.157249 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:07.157379 [debug] [MainThread]: On master: COMMIT
[0m21:41:07.157780 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:41:07.157920 [debug] [MainThread]: On master: Close
[0m21:41:07.160008 [debug] [Thread-3 (]: Began running node model.dbt_test.stg_payments
[0m21:41:07.160210 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_orders
[0m21:41:07.160389 [debug] [Thread-1 (]: Began running node model.dbt_test.stg_customers
[0m21:41:07.160641 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_staging.stg_payments ..................... [RUN]
[0m21:41:07.160890 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m21:41:07.161115 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_staging.stg_customers .................... [RUN]
[0m21:41:07.161335 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.stg_payments)
[0m21:41:07.161517 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_marts, now model.dbt_test.stg_orders)
[0m21:41:07.161684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_intermediate, now model.dbt_test.stg_customers)
[0m21:41:07.161863 [debug] [Thread-3 (]: Began compiling node model.dbt_test.stg_payments
[0m21:41:07.162049 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_orders
[0m21:41:07.162255 [debug] [Thread-1 (]: Began compiling node model.dbt_test.stg_customers
[0m21:41:07.166709 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.stg_payments"
[0m21:41:07.168099 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_orders"
[0m21:41:07.169372 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:41:07.169812 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_orders
[0m21:41:07.169995 [debug] [Thread-1 (]: Began executing node model.dbt_test.stg_customers
[0m21:41:07.176295 [debug] [Thread-3 (]: Began executing node model.dbt_test.stg_payments
[0m21:41:07.193092 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_orders"
[0m21:41:07.194488 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:41:07.196014 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.stg_payments"
[0m21:41:07.196513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:41:07.196718 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:41:07.196885 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:41:07.197050 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:41:07.197203 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: BEGIN
[0m21:41:07.197349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:41:07.197495 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: BEGIN
[0m21:41:07.197646 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:41:07.197898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:41:07.213749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m21:41:07.214008 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m21:41:07.214207 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:41:07.214372 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m21:41:07.214553 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:41:07.214726 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."analytics_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:41:07.214899 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:41:07.215064 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */

  create view "dbt_test"."analytics_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."orders"
),
casted as (
    select
        id           as order_id,
        user_id      as customer_id,
        order_date::timestamp as order_timestamp,
        lower(status) as status,
        total_amount::numeric(10,2) as total_amount
    from source
)
select * from casted
  );
[0m21:41:07.215308 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */

  create view "dbt_test"."analytics_staging"."stg_payments__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."payments"
),
casted as (
    select
        id           as payment_id,
        order_id,
        lower(payment_method) as payment_method,
        amount::numeric(10,2) as amount,
        paid_at::timestamp    as paid_at
    from source
)
select * from casted
  );
[0m21:41:07.220224 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:41:07.220470 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:41:07.251573 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.036 seconds
[0m21:41:07.254007 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:41:07.255383 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:41:07.256793 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:41:07.256985 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."analytics_staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m21:41:07.257159 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:41:07.257327 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."analytics_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:41:07.258577 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:07.258810 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:07.259008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:07.260339 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:41:07.261701 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:41:07.263152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:41:07.263378 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."analytics_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:41:07.263565 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."analytics_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:41:07.263750 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:41:07.264542 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:07.264743 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:07.264906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:41:07.272862 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:41:07.273572 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:41:07.274249 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:41:07.274424 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:41:07.274586 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:41:07.274742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:41:07.274895 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:41:07.275049 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:41:07.275198 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:41:07.277078 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:41:07.277256 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m21:41:07.280465 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_customers__dbt_backup"
[0m21:41:07.280665 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m21:41:07.281669 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_orders__dbt_backup"
[0m21:41:07.283948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:41:07.285012 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_payments__dbt_backup"
[0m21:41:07.285351 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:41:07.285519 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."analytics_staging"."stg_customers__dbt_backup" cascade
[0m21:41:07.285854 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:41:07.286028 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
drop view if exists "dbt_test"."analytics_staging"."stg_orders__dbt_backup" cascade
[0m21:41:07.286236 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
drop view if exists "dbt_test"."analytics_staging"."stg_payments__dbt_backup" cascade
[0m21:41:07.287933 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:41:07.289083 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: Close
[0m21:41:07.289300 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:41:07.289917 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: Close
[0m21:41:07.290120 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m21:41:07.290755 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: Close
[0m21:41:07.292698 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '644e0092-5747-4d86-b35c-531fc96e4aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108013f50>]}
[0m21:41:07.292900 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '644e0092-5747-4d86-b35c-531fc96e4aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108062d00>]}
[0m21:41:07.293218 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_staging.stg_orders .................. [[32mCREATE VIEW[0m in 0.13s]
[0m21:41:07.293603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '644e0092-5747-4d86-b35c-531fc96e4aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108480ff0>]}
[0m21:41:07.293949 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_staging.stg_payments ................ [[32mCREATE VIEW[0m in 0.13s]
[0m21:41:07.294218 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_orders
[0m21:41:07.294707 [debug] [Thread-3 (]: Finished running node model.dbt_test.stg_payments
[0m21:41:07.294498 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_staging.stg_customers ............... [[32mCREATE VIEW[0m in 0.13s]
[0m21:41:07.295090 [debug] [Thread-1 (]: Finished running node model.dbt_test.stg_customers
[0m21:41:07.295725 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:07.295878 [debug] [MainThread]: On master: BEGIN
[0m21:41:07.296003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:41:07.309484 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m21:41:07.309695 [debug] [MainThread]: On master: COMMIT
[0m21:41:07.309838 [debug] [MainThread]: Using postgres connection "master"
[0m21:41:07.309968 [debug] [MainThread]: On master: COMMIT
[0m21:41:07.310438 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:41:07.310582 [debug] [MainThread]: On master: Close
[0m21:41:07.310778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:41:07.310928 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:41:07.311053 [debug] [MainThread]: Connection 'model.dbt_test.stg_orders' was properly closed.
[0m21:41:07.311167 [debug] [MainThread]: Connection 'model.dbt_test.stg_payments' was properly closed.
[0m21:41:07.311334 [info ] [MainThread]: 
[0m21:41:07.311495 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m21:41:07.311928 [debug] [MainThread]: Command end result
[0m21:41:07.325739 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:41:07.326720 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:41:07.329845 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:41:07.330008 [info ] [MainThread]: 
[0m21:41:07.330184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:41:07.330323 [info ] [MainThread]: 
[0m21:41:07.330478 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m21:41:07.332044 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.70805144, "process_in_blocks": "0", "process_kernel_time": 0.173898, "process_mem_max_rss": "129499136", "process_out_blocks": "0", "process_user_time": 1.146651}
[0m21:41:07.332247 [debug] [MainThread]: Command `dbt run` succeeded at 21:41:07.332209 after 0.71 seconds
[0m21:41:07.332409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f207c0>]}
[0m21:41:07.332574 [debug] [MainThread]: Flushing usage events
[0m21:41:07.796696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:42:58.238537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107618590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11114b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11114bb10>]}


============================== 21:42:58.241562 | 6e265575-8028-483c-9cd5-4804dd3edb60 ==============================
[0m21:42:58.241562 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:42:58.241882 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'write_json': 'True', 'partial_parse': 'True', 'target_path': 'None', 'profiles_dir': '/Users/adil/.dbt', 'use_colors': 'True', 'empty': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s staging', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'cache_selected_only': 'False'}
[0m21:42:58.341449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e265575-8028-483c-9cd5-4804dd3edb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c49d0>]}
[0m21:42:58.369068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e265575-8028-483c-9cd5-4804dd3edb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106ef790>]}
[0m21:42:58.369640 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:42:58.419081 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:42:58.495042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:42:58.495247 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:42:58.517004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e265575-8028-483c-9cd5-4804dd3edb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fe3750>]}
[0m21:42:58.560062 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:42:58.561188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:42:58.574601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e265575-8028-483c-9cd5-4804dd3edb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111172f30>]}
[0m21:42:58.574826 [info ] [MainThread]: Found 6 models, 16 data tests, 3 sources, 459 macros
[0m21:42:58.575010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e265575-8028-483c-9cd5-4804dd3edb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11129ecf0>]}
[0m21:42:58.575834 [info ] [MainThread]: 
[0m21:42:58.576014 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:42:58.576157 [info ] [MainThread]: 
[0m21:42:58.576390 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:42:58.578089 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:42:58.621261 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:42:58.621465 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:42:58.621611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:58.690702 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.069 seconds
[0m21:42:58.691554 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:42:58.691992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now create_dbt_test_analytics_staging)
[0m21:42:58.692243 [debug] [ThreadPool]: Creating schema "database: "dbt_test"
schema: "analytics_staging"
"
[0m21:42:58.695067 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics_staging"
[0m21:42:58.695252 [debug] [ThreadPool]: On create_dbt_test_analytics_staging: BEGIN
[0m21:42:58.695397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:58.715991 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m21:42:58.716352 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics_staging"
[0m21:42:58.716567 [debug] [ThreadPool]: On create_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "create_dbt_test_analytics_staging"} */
create schema if not exists "analytics_staging"
[0m21:42:58.718068 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:42:58.718682 [debug] [ThreadPool]: On create_dbt_test_analytics_staging: COMMIT
[0m21:42:58.718875 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_analytics_staging"
[0m21:42:58.719034 [debug] [ThreadPool]: On create_dbt_test_analytics_staging: COMMIT
[0m21:42:58.720301 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m21:42:58.720471 [debug] [ThreadPool]: On create_dbt_test_analytics_staging: Close
[0m21:42:58.721397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_test_analytics_staging, now list_dbt_test_analytics_intermediate)
[0m21:42:58.724805 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:42:58.725081 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_staging'
[0m21:42:58.725285 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: BEGIN
[0m21:42:58.725957 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_analytics_marts'
[0m21:42:58.726941 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:42:58.727106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:58.727957 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_marts"
[0m21:42:58.728114 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: BEGIN
[0m21:42:58.728331 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: BEGIN
[0m21:42:58.728490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:58.728637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:58.743292 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:42:58.743552 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_staging"
[0m21:42:58.743771 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:42:58.744517 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m21:42:58.744711 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_intermediate"
[0m21:42:58.744906 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_intermediate'
  
[0m21:42:58.745091 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m21:42:58.745272 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_analytics_marts"
[0m21:42:58.745437 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_analytics_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_marts'
  
[0m21:42:58.749468 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m21:42:58.749657 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m21:42:58.750328 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: ROLLBACK
[0m21:42:58.750508 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m21:42:58.751116 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: ROLLBACK
[0m21:42:58.751675 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: ROLLBACK
[0m21:42:58.751828 [debug] [ThreadPool]: On list_dbt_test_analytics_marts: Close
[0m21:42:58.752298 [debug] [ThreadPool]: On list_dbt_test_analytics_staging: Close
[0m21:42:58.752438 [debug] [ThreadPool]: On list_dbt_test_analytics_intermediate: Close
[0m21:42:58.754807 [debug] [MainThread]: Using postgres connection "master"
[0m21:42:58.754994 [debug] [MainThread]: On master: BEGIN
[0m21:42:58.755143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:42:58.766153 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m21:42:58.766355 [debug] [MainThread]: Using postgres connection "master"
[0m21:42:58.766566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:42:58.774813 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m21:42:58.775920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e265575-8028-483c-9cd5-4804dd3edb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125c9cc0>]}
[0m21:42:58.776186 [debug] [MainThread]: On master: ROLLBACK
[0m21:42:58.776890 [debug] [MainThread]: Using postgres connection "master"
[0m21:42:58.777071 [debug] [MainThread]: On master: BEGIN
[0m21:42:58.777905 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:42:58.778054 [debug] [MainThread]: On master: COMMIT
[0m21:42:58.778192 [debug] [MainThread]: Using postgres connection "master"
[0m21:42:58.778322 [debug] [MainThread]: On master: COMMIT
[0m21:42:58.778738 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:42:58.778874 [debug] [MainThread]: On master: Close
[0m21:42:58.780824 [debug] [Thread-1 (]: Began running node model.dbt_test.stg_customers
[0m21:42:58.781362 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_orders
[0m21:42:58.781687 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_staging.stg_customers .................... [RUN]
[0m21:42:58.781911 [debug] [Thread-3 (]: Began running node model.dbt_test.stg_payments
[0m21:42:58.782159 [info ] [Thread-2 (]: 2 of 3 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m21:42:58.782408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_intermediate, now model.dbt_test.stg_customers)
[0m21:42:58.782798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_staging, now model.dbt_test.stg_orders)
[0m21:42:58.782632 [info ] [Thread-3 (]: 3 of 3 START sql view model analytics_staging.stg_payments ..................... [RUN]
[0m21:42:58.783018 [debug] [Thread-1 (]: Began compiling node model.dbt_test.stg_customers
[0m21:42:58.783184 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_orders
[0m21:42:58.783354 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_analytics_marts, now model.dbt_test.stg_payments)
[0m21:42:58.787381 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:42:58.789095 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_orders"
[0m21:42:58.789312 [debug] [Thread-3 (]: Began compiling node model.dbt_test.stg_payments
[0m21:42:58.791111 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.stg_payments"
[0m21:42:58.791992 [debug] [Thread-1 (]: Began executing node model.dbt_test.stg_customers
[0m21:42:58.792288 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_orders
[0m21:42:58.792517 [debug] [Thread-3 (]: Began executing node model.dbt_test.stg_payments
[0m21:42:58.816775 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:42:58.817784 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_orders"
[0m21:42:58.847987 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.stg_payments"
[0m21:42:58.848801 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:42:58.849016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:42:58.849221 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:42:58.849392 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: BEGIN
[0m21:42:58.849559 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:42:58.849714 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: BEGIN
[0m21:42:58.849879 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:42:58.850050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:42:58.850200 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:42:58.865007 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m21:42:58.865293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m21:42:58.865482 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:42:58.865648 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m21:42:58.865818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:42:58.866014 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */

  create view "dbt_test"."analytics_staging"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."orders"
),
casted as (
    select
        id           as order_id,
        user_id      as customer_id,
        order_date::timestamp as order_timestamp,
        lower(status) as status,
        total_amount::numeric(10,2) as total_amount
    from source
)
select * from casted
  );
[0m21:42:58.866184 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:42:58.866349 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."analytics_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:42:58.866594 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */

  create view "dbt_test"."analytics_staging"."stg_payments__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."payments"
),
casted as (
    select
        id           as payment_id,
        order_id,
        lower(payment_method) as payment_method,
        amount::numeric(10,2) as amount,
        paid_at::timestamp    as paid_at
    from source
)
select * from casted
  );
[0m21:42:58.870100 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:42:58.870333 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:42:58.870512 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:42:58.873741 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:42:58.875225 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:42:58.876453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:42:58.876639 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."analytics_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:42:58.876807 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."analytics_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:42:58.876978 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."analytics_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:42:58.877800 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:42:58.877984 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:42:58.885048 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:42:58.885224 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m21:42:58.885849 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:42:58.886022 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:42:58.886600 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:42:58.886797 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:42:58.886978 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:42:58.887138 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:42:58.887299 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:42:58.887484 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:42:58.888578 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:42:58.891916 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_payments__dbt_backup"
[0m21:42:58.892118 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m21:42:58.892286 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m21:42:58.894735 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:42:58.895708 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_customers__dbt_backup"
[0m21:42:58.896763 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."analytics_staging"."stg_orders__dbt_backup"
[0m21:42:58.896934 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
drop view if exists "dbt_test"."analytics_staging"."stg_payments__dbt_backup" cascade
[0m21:42:58.897291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:42:58.897612 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:42:58.897822 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."analytics_staging"."stg_customers__dbt_backup" cascade
[0m21:42:58.898030 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
drop view if exists "dbt_test"."analytics_staging"."stg_orders__dbt_backup" cascade
[0m21:42:58.898293 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:42:58.899436 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: Close
[0m21:42:58.899614 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:42:58.899792 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:42:58.900398 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: Close
[0m21:42:58.901327 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: Close
[0m21:42:58.902290 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e265575-8028-483c-9cd5-4804dd3edb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11220bc50>]}
[0m21:42:58.902486 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e265575-8028-483c-9cd5-4804dd3edb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112267120>]}
[0m21:42:58.902792 [info ] [Thread-3 (]: 3 of 3 OK created sql view model analytics_staging.stg_payments ................ [[32mCREATE VIEW[0m in 0.12s]
[0m21:42:58.903083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e265575-8028-483c-9cd5-4804dd3edb60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107748370>]}
[0m21:42:58.903369 [info ] [Thread-2 (]: 2 of 3 OK created sql view model analytics_staging.stg_orders .................. [[32mCREATE VIEW[0m in 0.12s]
[0m21:42:58.903716 [debug] [Thread-3 (]: Finished running node model.dbt_test.stg_payments
[0m21:42:58.904023 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_staging.stg_customers ............... [[32mCREATE VIEW[0m in 0.12s]
[0m21:42:58.904373 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_orders
[0m21:42:58.904701 [debug] [Thread-1 (]: Finished running node model.dbt_test.stg_customers
[0m21:42:58.905585 [debug] [MainThread]: Using postgres connection "master"
[0m21:42:58.905743 [debug] [MainThread]: On master: BEGIN
[0m21:42:58.905880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:42:58.917257 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m21:42:58.917473 [debug] [MainThread]: On master: COMMIT
[0m21:42:58.917625 [debug] [MainThread]: Using postgres connection "master"
[0m21:42:58.917751 [debug] [MainThread]: On master: COMMIT
[0m21:42:58.918207 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:42:58.918348 [debug] [MainThread]: On master: Close
[0m21:42:58.918546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:42:58.918696 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:42:58.918820 [debug] [MainThread]: Connection 'model.dbt_test.stg_orders' was properly closed.
[0m21:42:58.918934 [debug] [MainThread]: Connection 'model.dbt_test.stg_payments' was properly closed.
[0m21:42:58.919103 [info ] [MainThread]: 
[0m21:42:58.919257 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m21:42:58.919691 [debug] [MainThread]: Command end result
[0m21:42:58.933553 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:42:58.934676 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:42:58.938041 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:42:58.938233 [info ] [MainThread]: 
[0m21:42:58.938449 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:42:58.938600 [info ] [MainThread]: 
[0m21:42:58.938765 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m21:42:58.940584 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.73727906, "process_in_blocks": "0", "process_kernel_time": 0.177548, "process_mem_max_rss": "128860160", "process_out_blocks": "0", "process_user_time": 1.090889}
[0m21:42:58.941195 [debug] [MainThread]: Command `dbt run` succeeded at 21:42:58.941147 after 0.74 seconds
[0m21:42:58.941416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107733ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111cc7c0>]}
[0m21:42:58.941711 [debug] [MainThread]: Flushing usage events
[0m21:42:59.411837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:49:22.862587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1194e8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b347890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b347b10>]}


============================== 21:49:22.865826 | dbbac33c-f368-41d0-b565-80782522dfee ==============================
[0m21:49:22.865826 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:49:22.866155 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'introspect': 'True', 'invocation_command': 'dbt run -s staging', 'printer_width': '80', 'write_json': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'fail_fast': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/adil/.dbt', 'use_experimental_parser': 'False', 'empty': 'False', 'static_parser': 'True'}
[0m21:49:22.963474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbbac33c-f368-41d0-b565-80782522dfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197c09d0>]}
[0m21:49:22.990660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbbac33c-f368-41d0-b565-80782522dfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a5f3790>]}
[0m21:49:22.991222 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:49:23.039277 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:49:23.090542 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:49:23.090847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dbbac33c-f368-41d0-b565-80782522dfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c9eb650>]}
[0m21:49:23.675843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbbac33c-f368-41d0-b565-80782522dfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cb2b3e0>]}
[0m21:49:23.716234 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:49:23.717536 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:49:23.731115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbbac33c-f368-41d0-b565-80782522dfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd65a90>]}
[0m21:49:23.731354 [info ] [MainThread]: Found 6 models, 16 data tests, 3 sources, 460 macros
[0m21:49:23.731532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbbac33c-f368-41d0-b565-80782522dfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ca647a0>]}
[0m21:49:23.732342 [info ] [MainThread]: 
[0m21:49:23.732528 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:49:23.732675 [info ] [MainThread]: 
[0m21:49:23.732900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:49:23.734802 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:49:23.778356 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:49:23.778620 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:49:23.778787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:23.820789 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.042 seconds
[0m21:49:23.821613 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:49:23.822035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now create_dbt_test_staging)
[0m21:49:23.822305 [debug] [ThreadPool]: Creating schema "database: "dbt_test"
schema: "staging"
"
[0m21:49:23.824934 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_staging"
[0m21:49:23.825105 [debug] [ThreadPool]: On create_dbt_test_staging: BEGIN
[0m21:49:23.825239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:49:23.837236 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m21:49:23.837450 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_staging"
[0m21:49:23.837615 [debug] [ThreadPool]: On create_dbt_test_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "create_dbt_test_staging"} */
create schema if not exists "staging"
[0m21:49:23.838754 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:49:23.839204 [debug] [ThreadPool]: On create_dbt_test_staging: COMMIT
[0m21:49:23.839347 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_staging"
[0m21:49:23.839501 [debug] [ThreadPool]: On create_dbt_test_staging: COMMIT
[0m21:49:23.840419 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m21:49:23.840604 [debug] [ThreadPool]: On create_dbt_test_staging: Close
[0m21:49:23.841393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_test_staging, now list_dbt_test_intermediate)
[0m21:49:23.841677 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_marts'
[0m21:49:23.844466 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m21:49:23.845038 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_staging'
[0m21:49:23.845804 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m21:49:23.845966 [debug] [ThreadPool]: On list_dbt_test_intermediate: BEGIN
[0m21:49:23.846698 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m21:49:23.846845 [debug] [ThreadPool]: On list_dbt_test_marts: BEGIN
[0m21:49:23.846983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:49:23.847122 [debug] [ThreadPool]: On list_dbt_test_staging: BEGIN
[0m21:49:23.847249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:23.847434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:23.860154 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m21:49:23.860341 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m21:49:23.860524 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m21:49:23.860687 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m21:49:23.860840 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m21:49:23.861010 [debug] [ThreadPool]: On list_dbt_test_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m21:49:23.861164 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m21:49:23.861320 [debug] [ThreadPool]: On list_dbt_test_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m21:49:23.861542 [debug] [ThreadPool]: On list_dbt_test_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intermediate'
  
[0m21:49:23.865363 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m21:49:23.865537 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m21:49:23.866163 [debug] [ThreadPool]: On list_dbt_test_intermediate: ROLLBACK
[0m21:49:23.866319 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m21:49:23.866874 [debug] [ThreadPool]: On list_dbt_test_marts: ROLLBACK
[0m21:49:23.867511 [debug] [ThreadPool]: On list_dbt_test_staging: ROLLBACK
[0m21:49:23.867672 [debug] [ThreadPool]: On list_dbt_test_intermediate: Close
[0m21:49:23.868222 [debug] [ThreadPool]: On list_dbt_test_marts: Close
[0m21:49:23.868393 [debug] [ThreadPool]: On list_dbt_test_staging: Close
[0m21:49:23.870779 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:23.870943 [debug] [MainThread]: On master: BEGIN
[0m21:49:23.871076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:49:23.882266 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m21:49:23.882482 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:23.882672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:49:23.886811 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m21:49:23.887896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbbac33c-f368-41d0-b565-80782522dfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce837d0>]}
[0m21:49:23.888158 [debug] [MainThread]: On master: ROLLBACK
[0m21:49:23.888709 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:23.888899 [debug] [MainThread]: On master: BEGIN
[0m21:49:23.889706 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:49:23.889852 [debug] [MainThread]: On master: COMMIT
[0m21:49:23.890004 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:23.890122 [debug] [MainThread]: On master: COMMIT
[0m21:49:23.890601 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:49:23.890795 [debug] [MainThread]: On master: Close
[0m21:49:23.894827 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_orders
[0m21:49:23.895042 [debug] [Thread-1 (]: Began running node model.dbt_test.stg_customers
[0m21:49:23.895230 [debug] [Thread-3 (]: Began running node model.dbt_test.stg_payments
[0m21:49:23.895485 [info ] [Thread-2 (]: 2 of 3 START sql view model staging.stg_orders ................................. [RUN]
[0m21:49:23.895768 [info ] [Thread-1 (]: 1 of 3 START sql view model staging.stg_customers .............................. [RUN]
[0m21:49:23.896032 [info ] [Thread-3 (]: 3 of 3 START sql view model staging.stg_payments ............................... [RUN]
[0m21:49:23.896254 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_marts, now model.dbt_test.stg_orders)
[0m21:49:23.896440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_intermediate, now model.dbt_test.stg_customers)
[0m21:49:23.896617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_staging, now model.dbt_test.stg_payments)
[0m21:49:23.896798 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_orders
[0m21:49:23.896963 [debug] [Thread-1 (]: Began compiling node model.dbt_test.stg_customers
[0m21:49:23.897117 [debug] [Thread-3 (]: Began compiling node model.dbt_test.stg_payments
[0m21:49:23.900937 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_orders"
[0m21:49:23.902358 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:49:23.904439 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.stg_payments"
[0m21:49:23.904992 [debug] [Thread-3 (]: Began executing node model.dbt_test.stg_payments
[0m21:49:23.905207 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_orders
[0m21:49:23.905396 [debug] [Thread-1 (]: Began executing node model.dbt_test.stg_customers
[0m21:49:23.924377 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_orders"
[0m21:49:23.925418 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.stg_payments"
[0m21:49:23.926714 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:49:23.927496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:49:23.927695 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:49:23.927856 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:49:23.928016 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:49:23.928164 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: BEGIN
[0m21:49:23.928308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:23.928455 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: BEGIN
[0m21:49:23.928595 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:49:23.928820 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:49:23.942749 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m21:49:23.942981 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m21:49:23.943157 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:49:23.943314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m21:49:23.943475 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:49:23.943654 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */

  create view "dbt_test"."staging"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."orders"
),
casted as (
    select
        id           as order_id,
        user_id      as customer_id,
        order_date::timestamp as order_timestamp,
        lower(status) as status,
        total_amount::numeric(10,2) as total_amount
    from source
)
select * from casted
  );
[0m21:49:23.943823 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:49:23.943985 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */

  create view "dbt_test"."staging"."stg_payments__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."payments"
),
casted as (
    select
        id           as payment_id,
        order_id,
        lower(payment_method) as payment_method,
        amount::numeric(10,2) as amount,
        paid_at::timestamp    as paid_at
    from source
)
select * from casted
  );
[0m21:49:23.944196 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:49:23.947713 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:49:23.947904 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:49:23.948055 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:49:23.951103 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:49:23.952526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:49:23.953748 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:49:23.953952 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:49:23.954125 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:49:23.954294 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:49:23.955152 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:49:23.955323 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:49:23.960858 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:49:23.964006 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:49:23.964277 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:49:23.964902 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:49:23.965107 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:49:23.965287 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:49:23.965461 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:49:23.965624 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:49:23.965803 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:49:23.965989 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:49:23.967483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:49:23.970535 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."staging"."stg_customers__dbt_backup"
[0m21:49:23.970739 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m21:49:23.973019 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:49:23.973191 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m21:49:23.974081 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."staging"."stg_payments__dbt_backup"
[0m21:49:23.974256 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."staging"."stg_customers__dbt_backup" cascade
[0m21:49:23.975093 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."staging"."stg_orders__dbt_backup"
[0m21:49:23.975331 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:49:23.975613 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:49:23.975801 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
drop view if exists "dbt_test"."staging"."stg_payments__dbt_backup" cascade
[0m21:49:23.975990 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:49:23.976158 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
drop view if exists "dbt_test"."staging"."stg_orders__dbt_backup" cascade
[0m21:49:23.977359 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: Close
[0m21:49:23.977531 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:49:23.978173 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: Close
[0m21:49:23.978985 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:49:23.979907 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: Close
[0m21:49:23.980596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbbac33c-f368-41d0-b565-80782522dfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d36d2e0>]}
[0m21:49:23.980870 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbbac33c-f368-41d0-b565-80782522dfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d5a6030>]}
[0m21:49:23.981404 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbbac33c-f368-41d0-b565-80782522dfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d43fc80>]}
[0m21:49:23.982095 [info ] [Thread-1 (]: 1 of 3 OK created sql view model staging.stg_customers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:49:23.982633 [info ] [Thread-3 (]: 3 of 3 OK created sql view model staging.stg_payments .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m21:49:23.983451 [debug] [Thread-1 (]: Finished running node model.dbt_test.stg_customers
[0m21:49:23.983745 [debug] [Thread-3 (]: Finished running node model.dbt_test.stg_payments
[0m21:49:23.983028 [info ] [Thread-2 (]: 2 of 3 OK created sql view model staging.stg_orders ............................ [[32mCREATE VIEW[0m in 0.08s]
[0m21:49:23.984131 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_orders
[0m21:49:23.984902 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:23.985055 [debug] [MainThread]: On master: BEGIN
[0m21:49:23.985195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:49:23.998123 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m21:49:23.998358 [debug] [MainThread]: On master: COMMIT
[0m21:49:23.998518 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:23.998657 [debug] [MainThread]: On master: COMMIT
[0m21:49:23.999126 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:49:23.999263 [debug] [MainThread]: On master: Close
[0m21:49:23.999460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:23.999592 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:49:23.999880 [debug] [MainThread]: Connection 'model.dbt_test.stg_orders' was properly closed.
[0m21:49:24.000170 [debug] [MainThread]: Connection 'model.dbt_test.stg_payments' was properly closed.
[0m21:49:24.000444 [info ] [MainThread]: 
[0m21:49:24.000607 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m21:49:24.001094 [debug] [MainThread]: Command end result
[0m21:49:24.017958 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:49:24.018992 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:49:24.022898 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:49:24.023092 [info ] [MainThread]: 
[0m21:49:24.023283 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:49:24.023464 [info ] [MainThread]: 
[0m21:49:24.023669 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m21:49:24.025381 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.202429, "process_in_blocks": "0", "process_kernel_time": 0.179646, "process_mem_max_rss": "136724480", "process_out_blocks": "0", "process_user_time": 1.569925}
[0m21:49:24.025621 [debug] [MainThread]: Command `dbt run` succeeded at 21:49:24.025577 after 1.20 seconds
[0m21:49:24.025817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b3cc7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fefd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cc8e930>]}
[0m21:49:24.026000 [debug] [MainThread]: Flushing usage events
[0m21:49:24.785214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:49:44.756011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104630590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545fb10>]}


============================== 21:49:44.758929 | f66b635d-af49-41de-826a-95aa3e8e05de ==============================
[0m21:49:44.758929 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:49:44.759247 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'printer_width': '80', 'empty': 'False', 'log_format': 'default', 'partial_parse': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'invocation_command': 'dbt run -s staging', 'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adil/.dbt', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'no_print': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'quiet': 'False'}
[0m21:49:44.859726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f66b635d-af49-41de-826a-95aa3e8e05de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047dc9d0>]}
[0m21:49:44.891399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f66b635d-af49-41de-826a-95aa3e8e05de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530b790>]}
[0m21:49:44.894028 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:49:44.941642 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:49:44.991894 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:49:44.992162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f66b635d-af49-41de-826a-95aa3e8e05de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a7650>]}
[0m21:49:45.584773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f66b635d-af49-41de-826a-95aa3e8e05de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e73e0>]}
[0m21:49:45.626530 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:49:45.627771 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:49:45.640138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f66b635d-af49-41de-826a-95aa3e8e05de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106721a90>]}
[0m21:49:45.640400 [info ] [MainThread]: Found 6 models, 16 data tests, 3 sources, 460 macros
[0m21:49:45.640573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66b635d-af49-41de-826a-95aa3e8e05de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064046d0>]}
[0m21:49:45.641448 [info ] [MainThread]: 
[0m21:49:45.641625 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:49:45.641764 [info ] [MainThread]: 
[0m21:49:45.641997 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:49:45.643867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:49:45.673818 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:49:45.674052 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:49:45.674195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:45.720927 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.047 seconds
[0m21:49:45.721802 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:49:45.722749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_staging)
[0m21:49:45.723106 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_marts'
[0m21:49:45.726045 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m21:49:45.726358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_intermediate'
[0m21:49:45.727200 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m21:49:45.727387 [debug] [ThreadPool]: On list_dbt_test_staging: BEGIN
[0m21:49:45.728374 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m21:49:45.728540 [debug] [ThreadPool]: On list_dbt_test_marts: BEGIN
[0m21:49:45.728680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:49:45.728828 [debug] [ThreadPool]: On list_dbt_test_intermediate: BEGIN
[0m21:49:45.728990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:45.729194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:45.747435 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m21:49:45.747733 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m21:49:45.747917 [debug] [ThreadPool]: On list_dbt_test_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m21:49:45.748521 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m21:49:45.748706 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m21:49:45.748877 [debug] [ThreadPool]: On list_dbt_test_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intermediate'
  
[0m21:49:45.749384 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m21:49:45.749576 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m21:49:45.749752 [debug] [ThreadPool]: On list_dbt_test_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m21:49:45.753592 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m21:49:45.753789 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m21:49:45.754452 [debug] [ThreadPool]: On list_dbt_test_intermediate: ROLLBACK
[0m21:49:45.754626 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m21:49:45.755190 [debug] [ThreadPool]: On list_dbt_test_marts: ROLLBACK
[0m21:49:45.755867 [debug] [ThreadPool]: On list_dbt_test_staging: ROLLBACK
[0m21:49:45.756034 [debug] [ThreadPool]: On list_dbt_test_intermediate: Close
[0m21:49:45.756616 [debug] [ThreadPool]: On list_dbt_test_marts: Close
[0m21:49:45.756763 [debug] [ThreadPool]: On list_dbt_test_staging: Close
[0m21:49:45.759468 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:45.759638 [debug] [MainThread]: On master: BEGIN
[0m21:49:45.759773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:49:45.772330 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m21:49:45.772556 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:45.772770 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:49:45.778502 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m21:49:45.779218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66b635d-af49-41de-826a-95aa3e8e05de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106803650>]}
[0m21:49:45.779460 [debug] [MainThread]: On master: ROLLBACK
[0m21:49:45.779971 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:45.780153 [debug] [MainThread]: On master: BEGIN
[0m21:49:45.780883 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:49:45.781064 [debug] [MainThread]: On master: COMMIT
[0m21:49:45.781217 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:45.781352 [debug] [MainThread]: On master: COMMIT
[0m21:49:45.781759 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:49:45.781912 [debug] [MainThread]: On master: Close
[0m21:49:45.783339 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_orders
[0m21:49:45.783531 [debug] [Thread-1 (]: Began running node model.dbt_test.stg_customers
[0m21:49:45.783712 [debug] [Thread-3 (]: Began running node model.dbt_test.stg_payments
[0m21:49:45.783967 [info ] [Thread-2 (]: 2 of 3 START sql view model staging.stg_orders ................................. [RUN]
[0m21:49:45.784183 [info ] [Thread-1 (]: 1 of 3 START sql view model staging.stg_customers .............................. [RUN]
[0m21:49:45.784630 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_marts, now model.dbt_test.stg_orders)
[0m21:49:45.784412 [info ] [Thread-3 (]: 3 of 3 START sql view model staging.stg_payments ............................... [RUN]
[0m21:49:45.784849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_staging, now model.dbt_test.stg_customers)
[0m21:49:45.785026 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_orders
[0m21:49:45.785221 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_intermediate, now model.dbt_test.stg_payments)
[0m21:49:45.785394 [debug] [Thread-1 (]: Began compiling node model.dbt_test.stg_customers
[0m21:49:45.789743 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_orders"
[0m21:49:45.789977 [debug] [Thread-3 (]: Began compiling node model.dbt_test.stg_payments
[0m21:49:45.791577 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:49:45.792991 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.stg_payments"
[0m21:49:45.793365 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_orders
[0m21:49:45.793563 [debug] [Thread-1 (]: Began executing node model.dbt_test.stg_customers
[0m21:49:45.800100 [debug] [Thread-3 (]: Began executing node model.dbt_test.stg_payments
[0m21:49:45.813250 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_orders"
[0m21:49:45.814073 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:49:45.815333 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.stg_payments"
[0m21:49:45.815839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:49:45.816043 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:49:45.816236 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:49:45.816419 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:49:45.816594 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: BEGIN
[0m21:49:45.816772 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: BEGIN
[0m21:49:45.816943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:45.817096 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:49:45.817247 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:49:45.830446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m21:49:45.830715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:49:45.830926 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m21:49:45.831118 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:49:45.831326 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:49:45.831517 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m21:49:45.831740 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */

  create view "dbt_test"."staging"."stg_payments__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."payments"
),
casted as (
    select
        id           as payment_id,
        order_id,
        lower(payment_method) as payment_method,
        amount::numeric(10,2) as amount,
        paid_at::timestamp    as paid_at
    from source
)
select * from casted
  );
[0m21:49:45.831968 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:49:45.832183 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */

  create view "dbt_test"."staging"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."orders"
),
casted as (
    select
        id           as order_id,
        user_id      as customer_id,
        order_date::timestamp as order_timestamp,
        lower(status) as status,
        total_amount::numeric(10,2) as total_amount
    from source
)
select * from casted
  );
[0m21:49:45.837178 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:49:45.837373 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m21:49:45.840758 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:49:45.840944 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m21:49:45.842231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:49:45.842424 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:49:45.843988 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:49:45.844188 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:49:45.844455 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m21:49:45.845745 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:49:45.846116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:49:45.848387 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:49:45.848580 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m21:49:45.849848 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:49:45.850102 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:49:45.851552 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:49:45.852001 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:49:45.852262 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:49:45.853241 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:49:45.858621 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:49:45.858851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:49:45.865409 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:49:45.865660 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:49:45.866273 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:49:45.866526 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:49:45.866702 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:49:45.866879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:49:45.867057 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:49:45.867207 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:49:45.867367 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:49:45.869378 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m21:49:45.869571 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:49:45.869721 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m21:49:45.872521 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."staging"."stg_payments__dbt_backup"
[0m21:49:45.875957 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."staging"."stg_customers__dbt_backup"
[0m21:49:45.876879 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."staging"."stg_orders__dbt_backup"
[0m21:49:45.879165 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:49:45.879468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:49:45.879696 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:49:45.879860 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
drop view if exists "dbt_test"."staging"."stg_payments__dbt_backup" cascade
[0m21:49:45.880021 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."staging"."stg_customers__dbt_backup" cascade
[0m21:49:45.880182 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
drop view if exists "dbt_test"."staging"."stg_orders__dbt_backup" cascade
[0m21:49:45.882182 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:49:45.882439 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:49:45.883634 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: Close
[0m21:49:45.883809 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:49:45.884441 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: Close
[0m21:49:45.885027 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: Close
[0m21:49:45.886361 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b635d-af49-41de-826a-95aa3e8e05de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab4f70>]}
[0m21:49:45.886542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b635d-af49-41de-826a-95aa3e8e05de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540bf70>]}
[0m21:49:45.886747 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b635d-af49-41de-826a-95aa3e8e05de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b86570>]}
[0m21:49:45.887027 [info ] [Thread-3 (]: 3 of 3 OK created sql view model staging.stg_payments .......................... [[32mCREATE VIEW[0m in 0.10s]
[0m21:49:45.887361 [info ] [Thread-1 (]: 1 of 3 OK created sql view model staging.stg_customers ......................... [[32mCREATE VIEW[0m in 0.10s]
[0m21:49:45.888013 [debug] [Thread-3 (]: Finished running node model.dbt_test.stg_payments
[0m21:49:45.887692 [info ] [Thread-2 (]: 2 of 3 OK created sql view model staging.stg_orders ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m21:49:45.888352 [debug] [Thread-1 (]: Finished running node model.dbt_test.stg_customers
[0m21:49:45.888694 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_orders
[0m21:49:45.889560 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:45.889706 [debug] [MainThread]: On master: BEGIN
[0m21:49:45.889834 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:49:45.901397 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m21:49:45.901611 [debug] [MainThread]: On master: COMMIT
[0m21:49:45.901780 [debug] [MainThread]: Using postgres connection "master"
[0m21:49:45.901932 [debug] [MainThread]: On master: COMMIT
[0m21:49:45.902473 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:49:45.902652 [debug] [MainThread]: On master: Close
[0m21:49:45.902864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:45.903003 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:49:45.903128 [debug] [MainThread]: Connection 'model.dbt_test.stg_orders' was properly closed.
[0m21:49:45.903243 [debug] [MainThread]: Connection 'model.dbt_test.stg_payments' was properly closed.
[0m21:49:45.903413 [info ] [MainThread]: 
[0m21:49:45.903563 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m21:49:45.903986 [debug] [MainThread]: Command end result
[0m21:49:45.916577 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:49:45.917633 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:49:45.920873 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:49:45.921047 [info ] [MainThread]: 
[0m21:49:45.921226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:49:45.921371 [info ] [MainThread]: 
[0m21:49:45.921534 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m21:49:45.923382 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.202304, "process_in_blocks": "0", "process_kernel_time": 0.18464, "process_mem_max_rss": "135462912", "process_out_blocks": "0", "process_user_time": 1.656129}
[0m21:49:45.923635 [debug] [MainThread]: Command `dbt run` succeeded at 21:49:45.923589 after 1.20 seconds
[0m21:49:45.923820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100fcfd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f85f0>]}
[0m21:49:45.924001 [debug] [MainThread]: Flushing usage events
[0m21:49:46.511646 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:55:30.897332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104180590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104faf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fafb10>]}


============================== 21:55:30.900782 | 8b728797-a281-40b4-9b98-7518c36df3e5 ==============================
[0m21:55:30.900782 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:55:30.901113 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'use_colors': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'partial_parse': 'True', 'empty': 'False', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'fail_fast': 'False', 'version_check': 'True', 'profiles_dir': '/Users/adil/.dbt', 'target_path': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'introspect': 'True', 'log_format': 'default', 'debug': 'False', 'quiet': 'False'}
[0m21:55:31.010650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b728797-a281-40b4-9b98-7518c36df3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043289d0>]}
[0m21:55:31.041501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b728797-a281-40b4-9b98-7518c36df3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e5b790>]}
[0m21:55:31.042206 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:55:31.095014 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:55:31.146241 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:55:31.146549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8b728797-a281-40b4-9b98-7518c36df3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef7650>]}
[0m21:55:31.760797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b728797-a281-40b4-9b98-7518c36df3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060973e0>]}
[0m21:55:31.802098 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:55:31.803408 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:55:31.817095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b728797-a281-40b4-9b98-7518c36df3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106275a90>]}
[0m21:55:31.817321 [info ] [MainThread]: Found 6 models, 16 data tests, 3 sources, 460 macros
[0m21:55:31.817496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b728797-a281-40b4-9b98-7518c36df3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f106d0>]}
[0m21:55:31.818458 [info ] [MainThread]: 
[0m21:55:31.818635 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:55:31.818774 [info ] [MainThread]: 
[0m21:55:31.818996 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:55:31.820848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:55:31.821094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:55:31.826051 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m21:55:31.864762 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:55:31.864993 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:55:31.865165 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m21:55:31.865317 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:55:31.865477 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:55:31.865625 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m21:55:31.865765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:31.865898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:31.866026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:31.947736 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.082 seconds
[0m21:55:31.948018 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.082 seconds
[0m21:55:31.948192 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.082 seconds
[0m21:55:31.948979 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:55:31.949692 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:55:31.950330 [debug] [ThreadPool]: On list_dbt_test: Close
[0m21:55:31.951802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now create_dbt_test_marts)
[0m21:55:31.952105 [debug] [ThreadPool]: Creating schema "database: "dbt_test"
schema: "marts"
"
[0m21:55:31.952480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now create_dbt_test_intermediate)
[0m21:55:31.957296 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_marts"
[0m21:55:31.957568 [debug] [ThreadPool]: Creating schema "database: "dbt_test"
schema: "intermediate"
"
[0m21:55:31.957781 [debug] [ThreadPool]: On create_dbt_test_marts: BEGIN
[0m21:55:31.958696 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_intermediate"
[0m21:55:31.959012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:31.959391 [debug] [ThreadPool]: On create_dbt_test_intermediate: BEGIN
[0m21:55:31.960026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:31.976734 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m21:55:31.977030 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_marts"
[0m21:55:31.977207 [debug] [ThreadPool]: On create_dbt_test_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "create_dbt_test_marts"} */
create schema if not exists "marts"
[0m21:55:31.977379 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m21:55:31.977582 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_intermediate"
[0m21:55:31.977725 [debug] [ThreadPool]: On create_dbt_test_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "create_dbt_test_intermediate"} */
create schema if not exists "intermediate"
[0m21:55:31.979035 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m21:55:31.979232 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m21:55:31.979757 [debug] [ThreadPool]: On create_dbt_test_intermediate: COMMIT
[0m21:55:31.980217 [debug] [ThreadPool]: On create_dbt_test_marts: COMMIT
[0m21:55:31.980389 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_intermediate"
[0m21:55:31.980540 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_marts"
[0m21:55:31.980685 [debug] [ThreadPool]: On create_dbt_test_intermediate: COMMIT
[0m21:55:31.980825 [debug] [ThreadPool]: On create_dbt_test_marts: COMMIT
[0m21:55:31.981611 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m21:55:31.981753 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m21:55:31.981890 [debug] [ThreadPool]: On create_dbt_test_marts: Close
[0m21:55:31.982031 [debug] [ThreadPool]: On create_dbt_test_intermediate: Close
[0m21:55:31.982924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_test_intermediate, now list_dbt_test_marts)
[0m21:55:31.986178 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m21:55:31.986445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_test_marts, now list_dbt_test_staging)
[0m21:55:31.986591 [debug] [ThreadPool]: On list_dbt_test_marts: BEGIN
[0m21:55:31.986804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_intermediate)
[0m21:55:31.987623 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m21:55:31.987777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:31.988679 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m21:55:31.988827 [debug] [ThreadPool]: On list_dbt_test_staging: BEGIN
[0m21:55:31.989021 [debug] [ThreadPool]: On list_dbt_test_intermediate: BEGIN
[0m21:55:31.989172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:31.989335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:32.002373 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m21:55:32.002572 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m21:55:32.002753 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m21:55:32.002883 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m21:55:32.003026 [debug] [ThreadPool]: On list_dbt_test_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m21:55:32.003178 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m21:55:32.003307 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m21:55:32.003491 [debug] [ThreadPool]: On list_dbt_test_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intermediate'
  
[0m21:55:32.003693 [debug] [ThreadPool]: On list_dbt_test_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m21:55:32.013358 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m21:55:32.013636 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m21:55:32.014483 [debug] [ThreadPool]: On list_dbt_test_marts: ROLLBACK
[0m21:55:32.014676 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m21:55:32.015340 [debug] [ThreadPool]: On list_dbt_test_staging: ROLLBACK
[0m21:55:32.015949 [debug] [ThreadPool]: On list_dbt_test_intermediate: ROLLBACK
[0m21:55:32.016580 [debug] [ThreadPool]: On list_dbt_test_marts: Close
[0m21:55:32.017025 [debug] [ThreadPool]: On list_dbt_test_intermediate: Close
[0m21:55:32.017345 [debug] [ThreadPool]: On list_dbt_test_staging: Close
[0m21:55:32.022256 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:32.022451 [debug] [MainThread]: On master: BEGIN
[0m21:55:32.022594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:32.034820 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m21:55:32.035076 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:32.035281 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:55:32.039774 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m21:55:32.040530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b728797-a281-40b4-9b98-7518c36df3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106357890>]}
[0m21:55:32.040782 [debug] [MainThread]: On master: ROLLBACK
[0m21:55:32.041345 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:32.041494 [debug] [MainThread]: On master: BEGIN
[0m21:55:32.042348 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:55:32.042517 [debug] [MainThread]: On master: COMMIT
[0m21:55:32.042662 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:32.042810 [debug] [MainThread]: On master: COMMIT
[0m21:55:32.043265 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:55:32.043404 [debug] [MainThread]: On master: Close
[0m21:55:32.045646 [debug] [Thread-3 (]: Began running node model.dbt_test.stg_payments
[0m21:55:32.045844 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_orders
[0m21:55:32.046267 [debug] [Thread-1 (]: Began running node model.dbt_test.stg_customers
[0m21:55:32.046110 [info ] [Thread-3 (]: 3 of 6 START sql view model staging.stg_payments ............................... [RUN]
[0m21:55:32.046514 [info ] [Thread-2 (]: 2 of 6 START sql view model staging.stg_orders ................................. [RUN]
[0m21:55:32.046813 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.stg_customers .............................. [RUN]
[0m21:55:32.047044 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_intermediate, now model.dbt_test.stg_payments)
[0m21:55:32.047223 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_staging, now model.dbt_test.stg_orders)
[0m21:55:32.047410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_marts, now model.dbt_test.stg_customers)
[0m21:55:32.047601 [debug] [Thread-3 (]: Began compiling node model.dbt_test.stg_payments
[0m21:55:32.047821 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_orders
[0m21:55:32.047979 [debug] [Thread-1 (]: Began compiling node model.dbt_test.stg_customers
[0m21:55:32.052431 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.stg_payments"
[0m21:55:32.053841 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_orders"
[0m21:55:32.055184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m21:55:32.056459 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_orders
[0m21:55:32.062905 [debug] [Thread-3 (]: Began executing node model.dbt_test.stg_payments
[0m21:55:32.069205 [debug] [Thread-1 (]: Began executing node model.dbt_test.stg_customers
[0m21:55:32.077769 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_orders"
[0m21:55:32.079219 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.stg_payments"
[0m21:55:32.080603 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m21:55:32.081341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:55:32.081554 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:55:32.081748 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:55:32.081914 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: BEGIN
[0m21:55:32.082091 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: BEGIN
[0m21:55:32.082261 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: BEGIN
[0m21:55:32.082422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:32.082577 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:55:32.082730 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:55:32.098142 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m21:55:32.098433 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m21:55:32.098641 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:55:32.098820 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m21:55:32.099001 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:55:32.099192 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */

  create view "dbt_test"."staging"."stg_payments__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."payments"
),
casted as (
    select
        id           as payment_id,
        order_id,
        lower(payment_method) as payment_method,
        amount::numeric(10,2) as amount,
        paid_at::timestamp    as paid_at
    from source
)
select * from casted
  );
[0m21:55:32.099369 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:55:32.099538 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m21:55:32.099777 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */

  create view "dbt_test"."staging"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."orders"
),
casted as (
    select
        id           as order_id,
        user_id      as customer_id,
        order_date::timestamp as order_timestamp,
        lower(status) as status,
        total_amount::numeric(10,2) as total_amount
    from source
)
select * from casted
  );
[0m21:55:32.103377 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:55:32.106938 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:55:32.107158 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m21:55:32.107336 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m21:55:32.107501 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."staging"."stg_payments" rename to "stg_payments__dbt_backup"
[0m21:55:32.108794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:55:32.110025 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:55:32.110255 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."staging"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:55:32.110473 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:55:32.110758 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:55:32.114357 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:55:32.114566 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m21:55:32.114729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m21:55:32.114883 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m21:55:32.116044 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:55:32.117168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:55:32.117383 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:55:32.117580 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:55:32.117863 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:55:32.123474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:55:32.123673 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:55:32.130532 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:55:32.130709 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:55:32.131283 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:55:32.131468 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:55:32.131624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:55:32.131779 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:55:32.131929 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: COMMIT
[0m21:55:32.132077 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: COMMIT
[0m21:55:32.132222 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: COMMIT
[0m21:55:32.136139 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m21:55:32.139962 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."staging"."stg_payments__dbt_backup"
[0m21:55:32.144094 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m21:55:32.144544 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m21:55:32.144761 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
drop view if exists "dbt_test"."staging"."stg_payments__dbt_backup" cascade
[0m21:55:32.144960 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m21:55:32.146647 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."staging"."stg_customers__dbt_backup"
[0m21:55:32.147753 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."staging"."stg_orders__dbt_backup"
[0m21:55:32.148031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m21:55:32.148279 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m21:55:32.148458 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."staging"."stg_customers__dbt_backup" cascade
[0m21:55:32.148677 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
drop view if exists "dbt_test"."staging"."stg_orders__dbt_backup" cascade
[0m21:55:32.149438 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:55:32.150787 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: Close
[0m21:55:32.150998 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:55:32.151198 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:55:32.151847 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: Close
[0m21:55:32.153041 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: Close
[0m21:55:32.153763 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b728797-a281-40b4-9b98-7518c36df3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106605650>]}
[0m21:55:32.153933 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b728797-a281-40b4-9b98-7518c36df3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106337b10>]}
[0m21:55:32.154270 [info ] [Thread-3 (]: 3 of 6 OK created sql view model staging.stg_payments .......................... [[32mCREATE VIEW[0m in 0.11s]
[0m21:55:32.154451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b728797-a281-40b4-9b98-7518c36df3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106726570>]}
[0m21:55:32.154819 [info ] [Thread-2 (]: 2 of 6 OK created sql view model staging.stg_orders ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m21:55:32.155095 [debug] [Thread-3 (]: Finished running node model.dbt_test.stg_payments
[0m21:55:32.155361 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.stg_customers ......................... [[32mCREATE VIEW[0m in 0.11s]
[0m21:55:32.155648 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_orders
[0m21:55:32.155919 [debug] [Thread-1 (]: Finished running node model.dbt_test.stg_customers
[0m21:55:32.156521 [debug] [Thread-4 (]: Began running node model.dbt_test.int_order_payments
[0m21:55:32.157137 [info ] [Thread-4 (]: 4 of 6 START sql view model intermediate.int_order_payments .................... [RUN]
[0m21:55:32.157474 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_test.int_order_payments'
[0m21:55:32.157645 [debug] [Thread-4 (]: Began compiling node model.dbt_test.int_order_payments
[0m21:55:32.159300 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_test.int_order_payments"
[0m21:55:32.159512 [debug] [Thread-3 (]: Began running node model.dbt_test.dim_customers
[0m21:55:32.159796 [info ] [Thread-3 (]: 5 of 6 START sql table model marts.dim_customers ............................... [RUN]
[0m21:55:32.160099 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_test.stg_payments, now model.dbt_test.dim_customers)
[0m21:55:32.160300 [debug] [Thread-3 (]: Began compiling node model.dbt_test.dim_customers
[0m21:55:32.162575 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.dim_customers"
[0m21:55:32.163300 [debug] [Thread-3 (]: Began executing node model.dbt_test.dim_customers
[0m21:55:32.163520 [debug] [Thread-4 (]: Began executing node model.dbt_test.int_order_payments
[0m21:55:32.174839 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.dim_customers"
[0m21:55:32.176455 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_test.int_order_payments"
[0m21:55:32.177005 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:55:32.177228 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m21:55:32.177394 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: BEGIN
[0m21:55:32.177549 [debug] [Thread-3 (]: On model.dbt_test.dim_customers: BEGIN
[0m21:55:32.177711 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:55:32.177885 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:55:32.190588 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m21:55:32.190820 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m21:55:32.191000 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:55:32.191184 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m21:55:32.191361 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.int_order_payments"} */

  create view "dbt_test"."intermediate"."int_order_payments__dbt_tmp"
    
    
  as (
    

with payments as (
    select
        order_id,
        sum(amount) as total_paid,
        count(*)    as payment_count
    from "dbt_test"."staging"."stg_payments"
    group by 1
)

select
    o.order_id,
    o.customer_id,
    o.order_timestamp,
    o.status,
    o.total_amount,
    coalesce(p.total_paid, 0)   as total_paid,
    coalesce(p.payment_count, 0) as payment_count,
    (o.total_amount - coalesce(p.total_paid, 0)) as outstanding_amount
from "dbt_test"."staging"."stg_orders" o
left join payments p on o.order_id = p.order_id
  );
[0m21:55:32.191543 [debug] [Thread-3 (]: On model.dbt_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.dim_customers"} */

  
    

  create  table "dbt_test"."marts"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select
    c.customer_id,
    initcap(c.first_name) as first_name,
    initcap(c.last_name)  as last_name,
    c.email,
    c.created_at
from "dbt_test"."staging"."stg_customers" c
  );
  
[0m21:55:32.195849 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:55:32.198146 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:55:32.198423 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.int_order_payments"} */
alter table "dbt_test"."intermediate"."int_order_payments__dbt_tmp" rename to "int_order_payments"
[0m21:55:32.199775 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:55:32.200451 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: COMMIT
[0m21:55:32.200634 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.009 seconds
[0m21:55:32.200810 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:55:32.204394 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m21:55:32.204602 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: COMMIT
[0m21:55:32.204784 [debug] [Thread-3 (]: On model.dbt_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.dim_customers"} */
alter table "dbt_test"."marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m21:55:32.206407 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:55:32.207415 [debug] [Thread-3 (]: On model.dbt_test.dim_customers: COMMIT
[0m21:55:32.207614 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m21:55:32.207818 [debug] [Thread-3 (]: On model.dbt_test.dim_customers: COMMIT
[0m21:55:32.207988 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m21:55:32.209219 [debug] [Thread-4 (]: Applying DROP to: "dbt_test"."intermediate"."int_order_payments__dbt_backup"
[0m21:55:32.209583 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m21:55:32.209782 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.int_order_payments"} */
drop view if exists "dbt_test"."intermediate"."int_order_payments__dbt_backup" cascade
[0m21:55:32.209977 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m21:55:32.211163 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."marts"."dim_customers__dbt_backup"
[0m21:55:32.211667 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:55:32.213302 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m21:55:32.213986 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: Close
[0m21:55:32.214183 [debug] [Thread-3 (]: On model.dbt_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.dim_customers"} */
drop table if exists "dbt_test"."marts"."dim_customers__dbt_backup" cascade
[0m21:55:32.214493 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b728797-a281-40b4-9b98-7518c36df3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c6a50>]}
[0m21:55:32.215118 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:55:32.214848 [info ] [Thread-4 (]: 4 of 6 OK created sql view model intermediate.int_order_payments ............... [[32mCREATE VIEW[0m in 0.06s]
[0m21:55:32.215848 [debug] [Thread-3 (]: On model.dbt_test.dim_customers: Close
[0m21:55:32.216110 [debug] [Thread-4 (]: Finished running node model.dbt_test.int_order_payments
[0m21:55:32.216418 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b728797-a281-40b4-9b98-7518c36df3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a32f0>]}
[0m21:55:32.216756 [info ] [Thread-3 (]: 5 of 6 OK created sql table model marts.dim_customers .......................... [[32mSELECT 5[0m in 0.06s]
[0m21:55:32.217049 [debug] [Thread-3 (]: Finished running node model.dbt_test.dim_customers
[0m21:55:32.217333 [debug] [Thread-2 (]: Began running node model.dbt_test.fct_orders
[0m21:55:32.217562 [info ] [Thread-2 (]: 6 of 6 START sql table model marts.fct_orders .................................. [RUN]
[0m21:55:32.217784 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_test.stg_orders, now model.dbt_test.fct_orders)
[0m21:55:32.218030 [debug] [Thread-2 (]: Began compiling node model.dbt_test.fct_orders
[0m21:55:32.219844 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.fct_orders"
[0m21:55:32.220261 [debug] [Thread-2 (]: Began executing node model.dbt_test.fct_orders
[0m21:55:32.222069 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.fct_orders"
[0m21:55:32.222451 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m21:55:32.222621 [debug] [Thread-2 (]: On model.dbt_test.fct_orders: BEGIN
[0m21:55:32.222780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:55:32.233900 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m21:55:32.234137 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m21:55:32.234317 [debug] [Thread-2 (]: On model.dbt_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.fct_orders"} */

  
    

  create  table "dbt_test"."marts"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    

select
    i.order_id,
    i.customer_id,
    i.order_timestamp,
    i.status,
    i.total_amount,
    i.total_paid,
    i.payment_count,
    i.outstanding_amount,
    case
        when i.outstanding_amount = 0 and i.total_amount > 0 then true
        else false
    end as is_fully_paid
from "dbt_test"."intermediate"."int_order_payments" i
  );
  
[0m21:55:32.240698 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.006 seconds
[0m21:55:32.242419 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m21:55:32.242599 [debug] [Thread-2 (]: On model.dbt_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.fct_orders"} */
alter table "dbt_test"."marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m21:55:32.243130 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:55:32.243714 [debug] [Thread-2 (]: On model.dbt_test.fct_orders: COMMIT
[0m21:55:32.243882 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m21:55:32.244029 [debug] [Thread-2 (]: On model.dbt_test.fct_orders: COMMIT
[0m21:55:32.244837 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:55:32.245801 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."marts"."fct_orders__dbt_backup"
[0m21:55:32.246115 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m21:55:32.246366 [debug] [Thread-2 (]: On model.dbt_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.fct_orders"} */
drop table if exists "dbt_test"."marts"."fct_orders__dbt_backup" cascade
[0m21:55:32.246929 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m21:55:32.247545 [debug] [Thread-2 (]: On model.dbt_test.fct_orders: Close
[0m21:55:32.247806 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b728797-a281-40b4-9b98-7518c36df3e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681a330>]}
[0m21:55:32.248105 [info ] [Thread-2 (]: 6 of 6 OK created sql table model marts.fct_orders ............................. [[32mSELECT 5[0m in 0.03s]
[0m21:55:32.248361 [debug] [Thread-2 (]: Finished running node model.dbt_test.fct_orders
[0m21:55:32.248992 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:32.249135 [debug] [MainThread]: On master: BEGIN
[0m21:55:32.249262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:55:32.260270 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m21:55:32.260527 [debug] [MainThread]: On master: COMMIT
[0m21:55:32.260694 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:32.260850 [debug] [MainThread]: On master: COMMIT
[0m21:55:32.261331 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:55:32.261522 [debug] [MainThread]: On master: Close
[0m21:55:32.261745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:32.261886 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m21:55:32.262014 [debug] [MainThread]: Connection 'model.dbt_test.fct_orders' was properly closed.
[0m21:55:32.262141 [debug] [MainThread]: Connection 'model.dbt_test.dim_customers' was properly closed.
[0m21:55:32.262260 [debug] [MainThread]: Connection 'model.dbt_test.int_order_payments' was properly closed.
[0m21:55:32.262448 [info ] [MainThread]: 
[0m21:55:32.262605 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m21:55:32.263265 [debug] [MainThread]: Command end result
[0m21:55:32.277386 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:55:32.278389 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:55:32.281924 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:55:32.282185 [info ] [MainThread]: 
[0m21:55:32.282646 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:55:32.282811 [info ] [MainThread]: 
[0m21:55:32.282977 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m21:55:32.284754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.424965, "process_in_blocks": "0", "process_kernel_time": 0.207061, "process_mem_max_rss": "134479872", "process_out_blocks": "0", "process_user_time": 1.748958}
[0m21:55:32.285022 [debug] [MainThread]: Command `dbt run` succeeded at 21:55:32.284973 after 1.43 seconds
[0m21:55:32.285223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104985250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062aa450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681ab10>]}
[0m21:55:32.285421 [debug] [MainThread]: Flushing usage events
[0m21:55:32.794853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:58:44.160269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106218590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4bb10>]}


============================== 21:58:44.164318 | dfc68230-d550-4a90-919d-cd3fd33fbf1a ==============================
[0m21:58:44.164318 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:58:44.164796 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'use_colors': 'True', 'no_print': 'None', 'invocation_command': 'dbt test', 'profiles_dir': '/Users/adil/.dbt', 'printer_width': '80', 'log_format': 'default', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'introspect': 'True', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error': 'None'}
[0m21:58:44.378882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfc68230-d550-4a90-919d-cd3fd33fbf1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c49d0>]}
[0m21:58:44.411700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfc68230-d550-4a90-919d-cd3fd33fbf1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107af3790>]}
[0m21:58:44.412522 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:58:44.472968 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:58:44.561538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:58:44.561876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:58:44.588166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfc68230-d550-4a90-919d-cd3fd33fbf1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d5f150>]}
[0m21:58:44.639204 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:58:44.640719 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:58:44.663255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfc68230-d550-4a90-919d-cd3fd33fbf1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121409b0>]}
[0m21:58:44.663794 [info ] [MainThread]: Found 6 models, 16 data tests, 3 sources, 460 macros
[0m21:58:44.664184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfc68230-d550-4a90-919d-cd3fd33fbf1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11213d2b0>]}
[0m21:58:44.666343 [info ] [MainThread]: 
[0m21:58:44.666656 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:58:44.666854 [info ] [MainThread]: 
[0m21:58:44.667175 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:58:44.669445 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_staging'
[0m21:58:44.669870 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_marts'
[0m21:58:44.676438 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_intermediate'
[0m21:58:44.720544 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m21:58:44.720787 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m21:58:44.720981 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m21:58:44.721148 [debug] [ThreadPool]: On list_dbt_test_staging: BEGIN
[0m21:58:44.721304 [debug] [ThreadPool]: On list_dbt_test_intermediate: BEGIN
[0m21:58:44.721457 [debug] [ThreadPool]: On list_dbt_test_marts: BEGIN
[0m21:58:44.721615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:44.721765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:44.721898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:44.786183 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m21:58:44.786482 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m21:58:44.786676 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m21:58:44.786854 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m21:58:44.787069 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m21:58:44.787247 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m21:58:44.787442 [debug] [ThreadPool]: On list_dbt_test_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m21:58:44.787651 [debug] [ThreadPool]: On list_dbt_test_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m21:58:44.787851 [debug] [ThreadPool]: On list_dbt_test_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intermediate'
  
[0m21:58:44.795029 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m21:58:44.795246 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m21:58:44.795399 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m21:58:44.796126 [debug] [ThreadPool]: On list_dbt_test_marts: ROLLBACK
[0m21:58:44.796713 [debug] [ThreadPool]: On list_dbt_test_staging: ROLLBACK
[0m21:58:44.797256 [debug] [ThreadPool]: On list_dbt_test_intermediate: ROLLBACK
[0m21:58:44.797994 [debug] [ThreadPool]: On list_dbt_test_marts: Close
[0m21:58:44.798148 [debug] [ThreadPool]: On list_dbt_test_staging: Close
[0m21:58:44.798276 [debug] [ThreadPool]: On list_dbt_test_intermediate: Close
[0m21:58:44.801491 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:44.801673 [debug] [MainThread]: On master: BEGIN
[0m21:58:44.801815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:58:44.815703 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m21:58:44.815934 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:44.816139 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:58:44.820338 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m21:58:44.821245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfc68230-d550-4a90-919d-cd3fd33fbf1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123993d0>]}
[0m21:58:44.821478 [debug] [MainThread]: On master: ROLLBACK
[0m21:58:44.822051 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:44.822195 [debug] [MainThread]: On master: BEGIN
[0m21:58:44.823028 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:58:44.823190 [debug] [MainThread]: On master: COMMIT
[0m21:58:44.823329 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:44.823448 [debug] [MainThread]: On master: COMMIT
[0m21:58:44.823953 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:58:44.824136 [debug] [MainThread]: On master: Close
[0m21:58:44.825820 [debug] [Thread-1 (]: Began running node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:58:44.826008 [debug] [Thread-2 (]: Began running node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:58:44.826191 [debug] [Thread-3 (]: Began running node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:58:44.826360 [debug] [Thread-4 (]: Began running node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:58:44.826546 [info ] [Thread-1 (]: 1 of 16 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m21:58:44.826744 [info ] [Thread-2 (]: 2 of 16 START test not_null_fct_orders_customer_id ............................. [RUN]
[0m21:58:44.826922 [info ] [Thread-3 (]: 3 of 16 START test not_null_fct_orders_order_id ................................ [RUN]
[0m21:58:44.827110 [info ] [Thread-4 (]: 4 of 16 START test not_null_int_order_payments_order_id ........................ [RUN]
[0m21:58:44.827313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_staging, now test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m21:58:44.827501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_marts, now test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m21:58:44.827731 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_intermediate, now test.dbt_test.not_null_fct_orders_order_id.4e687af8d0)
[0m21:58:44.827964 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b'
[0m21:58:44.828149 [debug] [Thread-1 (]: Began compiling node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:58:44.828321 [debug] [Thread-2 (]: Began compiling node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:58:44.828480 [debug] [Thread-3 (]: Began compiling node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:58:44.828678 [debug] [Thread-4 (]: Began compiling node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:58:44.845135 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:58:44.845709 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:58:44.899710 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"
[0m21:58:44.905165 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"
[0m21:58:44.907497 [debug] [Thread-4 (]: Began executing node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:58:44.913821 [debug] [Thread-3 (]: Began executing node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:58:44.914229 [debug] [Thread-2 (]: Began executing node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:58:44.922286 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"
[0m21:58:44.923528 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"
[0m21:58:44.924558 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:58:44.924778 [debug] [Thread-1 (]: Began executing node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:58:44.926400 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:58:44.926697 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"
[0m21:58:44.926887 [debug] [Thread-3 (]: On test.dbt_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m21:58:44.927108 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:44.927417 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"
[0m21:58:44.927669 [debug] [Thread-4 (]: On test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b: BEGIN
[0m21:58:44.927881 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:58:44.928066 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:58:44.928248 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:58:44.928442 [debug] [Thread-2 (]: On test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m21:58:44.928622 [debug] [Thread-1 (]: On test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m21:58:44.928876 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:44.929099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:44.946677 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m21:58:44.947227 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"
[0m21:58:44.947479 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m21:58:44.947714 [debug] [Thread-4 (]: On test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dbt_test"."intermediate"."int_order_payments"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:44.947980 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"
[0m21:58:44.948277 [debug] [Thread-3 (]: On test.dbt_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dbt_test"."marts"."fct_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:44.949239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m21:58:44.949429 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m21:58:44.949625 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m21:58:44.949811 [debug] [Thread-1 (]: On test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dbt_test"."marts"."dim_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:44.949998 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m21:58:44.950208 [debug] [Thread-2 (]: On test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dbt_test"."marts"."fct_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:44.951040 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:58:44.953361 [debug] [Thread-3 (]: On test.dbt_test.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m21:58:44.953603 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:58:44.953822 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:58:44.954553 [debug] [Thread-1 (]: On test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m21:58:44.954742 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m21:58:44.954903 [debug] [Thread-3 (]: On test.dbt_test.not_null_fct_orders_order_id.4e687af8d0: Close
[0m21:58:44.955530 [debug] [Thread-2 (]: On test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m21:58:44.956259 [debug] [Thread-4 (]: On test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b: ROLLBACK
[0m21:58:44.956451 [debug] [Thread-1 (]: On test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m21:58:44.956771 [info ] [Thread-3 (]: 3 of 16 PASS not_null_fct_orders_order_id ...................................... [[32mPASS[0m in 0.13s]
[0m21:58:44.957122 [debug] [Thread-2 (]: On test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m21:58:44.957370 [info ] [Thread-1 (]: 1 of 16 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.13s]
[0m21:58:44.957652 [debug] [Thread-3 (]: Finished running node test.dbt_test.not_null_fct_orders_order_id.4e687af8d0
[0m21:58:44.957808 [debug] [Thread-4 (]: On test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b: Close
[0m21:58:44.958084 [debug] [Thread-1 (]: Finished running node test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m21:58:44.958325 [info ] [Thread-2 (]: 2 of 16 PASS not_null_fct_orders_customer_id ................................... [[32mPASS[0m in 0.13s]
[0m21:58:44.958632 [debug] [Thread-3 (]: Began running node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:58:44.958879 [info ] [Thread-4 (]: 4 of 16 PASS not_null_int_order_payments_order_id .............................. [[32mPASS[0m in 0.13s]
[0m21:58:44.959243 [debug] [Thread-1 (]: Began running node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:58:44.959907 [debug] [Thread-2 (]: Finished running node test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b
[0m21:58:44.960382 [info ] [Thread-3 (]: 5 of 16 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m21:58:44.961086 [debug] [Thread-4 (]: Finished running node test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b
[0m21:58:44.961418 [info ] [Thread-1 (]: 6 of 16 START test not_null_stg_customers_email ................................ [RUN]
[0m21:58:44.962711 [debug] [Thread-2 (]: Began running node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:58:44.963442 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_fct_orders_order_id.4e687af8d0, now test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m21:58:44.963949 [debug] [Thread-4 (]: Began running node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:58:44.964506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_test.not_null_stg_customers_email.d7cf761533)
[0m21:58:44.964774 [info ] [Thread-2 (]: 7 of 16 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m21:58:44.964989 [debug] [Thread-3 (]: Began compiling node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:58:44.965175 [info ] [Thread-4 (]: 8 of 16 START test not_null_stg_orders_order_id ................................ [RUN]
[0m21:58:44.965372 [debug] [Thread-1 (]: Began compiling node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:58:44.965584 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5)
[0m21:58:44.968888 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:58:44.969162 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_int_order_payments_order_id.57af36bc3b, now test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64)
[0m21:58:44.971955 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_customers_email.d7cf761533"
[0m21:58:44.972630 [debug] [Thread-2 (]: Began compiling node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:58:44.973058 [debug] [Thread-4 (]: Began compiling node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:58:44.978028 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:58:44.983391 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:58:44.983989 [debug] [Thread-3 (]: Began executing node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:58:44.985671 [debug] [Thread-1 (]: Began executing node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:58:44.987723 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:58:44.988122 [debug] [Thread-2 (]: Began executing node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:58:44.989282 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_customers_email.d7cf761533"
[0m21:58:44.989527 [debug] [Thread-4 (]: Began executing node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:58:44.990892 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:58:44.991218 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:58:44.992218 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:58:44.992494 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m21:58:44.992760 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_stg_customers_email.d7cf761533"
[0m21:58:44.992971 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:44.993199 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:58:44.993383 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_customers_email.d7cf761533: BEGIN
[0m21:58:44.993699 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:58:44.993900 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m21:58:44.994087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:44.994268 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m21:58:44.994668 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:44.995145 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:45.018500 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m21:58:45.018893 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:58:45.019663 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dbt_test"."staging"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:45.021079 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m21:58:45.021333 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_stg_customers_email.d7cf761533"
[0m21:58:45.021547 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dbt_test"."staging"."stg_customers"
where email is null



  
  
      
    ) dbt_internal_test
[0m21:58:45.025503 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m21:58:45.026533 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m21:58:45.026736 [debug] [Thread-2 (]: SQL status: BEGIN in 0.032 seconds
[0m21:58:45.027000 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"
[0m21:58:45.027219 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dbt_test"."staging"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:45.029193 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m21:58:45.029408 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m21:58:45.029597 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:58:45.029771 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m21:58:45.029983 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dbt_test"."staging"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:45.030342 [info ] [Thread-3 (]: 5 of 16 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.07s]
[0m21:58:45.030580 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:58:45.031401 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m21:58:45.031726 [debug] [Thread-3 (]: Finished running node test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:58:45.032439 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m21:58:45.032680 [debug] [Thread-3 (]: Began running node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:58:45.032929 [info ] [Thread-3 (]: 9 of 16 START test not_null_stg_payments_order_id .............................. [RUN]
[0m21:58:45.033176 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_test.not_null_stg_payments_order_id.601cf57649)
[0m21:58:45.033355 [debug] [Thread-3 (]: Began compiling node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:58:45.035880 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_payments_order_id.601cf57649"
[0m21:58:45.036095 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_customers_email.d7cf761533: Close
[0m21:58:45.036289 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m21:58:45.036543 [debug] [Thread-2 (]: On test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m21:58:45.036889 [info ] [Thread-1 (]: 6 of 16 PASS not_null_stg_customers_email ...................................... [[32mPASS[0m in 0.07s]
[0m21:58:45.037731 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m21:58:45.037936 [debug] [Thread-3 (]: Began executing node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:58:45.038240 [debug] [Thread-1 (]: Finished running node test.dbt_test.not_null_stg_customers_email.d7cf761533
[0m21:58:45.038497 [info ] [Thread-2 (]: 7 of 16 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.07s]
[0m21:58:45.039603 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_payments_order_id.601cf57649"
[0m21:58:45.039827 [debug] [Thread-1 (]: Began running node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:58:45.040089 [debug] [Thread-2 (]: Finished running node test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5
[0m21:58:45.040274 [debug] [Thread-4 (]: On test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m21:58:45.040725 [debug] [Thread-2 (]: Began running node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:58:45.040540 [info ] [Thread-1 (]: 10 of 16 START test not_null_stg_payments_payment_id ........................... [RUN]
[0m21:58:45.041100 [info ] [Thread-2 (]: 11 of 16 START test unique_dim_customers_customer_id ........................... [RUN]
[0m21:58:45.041591 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.not_null_stg_payments_order_id.601cf57649"
[0m21:58:45.041325 [info ] [Thread-4 (]: 8 of 16 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.07s]
[0m21:58:45.041950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_customers_email.d7cf761533, now test.dbt_test.not_null_stg_payments_payment_id.c19cc50075)
[0m21:58:45.042390 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m21:58:45.042584 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_payments_order_id.601cf57649: BEGIN
[0m21:58:45.042840 [debug] [Thread-4 (]: Finished running node test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64
[0m21:58:45.043141 [debug] [Thread-1 (]: Began compiling node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:58:45.043325 [debug] [Thread-2 (]: Began compiling node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:58:45.043559 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:45.043827 [debug] [Thread-4 (]: Began running node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:58:45.046513 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"
[0m21:58:45.050607 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:58:45.050942 [info ] [Thread-4 (]: 12 of 16 START test unique_fct_orders_order_id ................................. [RUN]
[0m21:58:45.051366 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_test.unique_fct_orders_order_id.523ddb6ce5)
[0m21:58:45.051556 [debug] [Thread-4 (]: Began compiling node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:58:45.053504 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"
[0m21:58:45.053831 [debug] [Thread-1 (]: Began executing node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:58:45.054205 [debug] [Thread-2 (]: Began executing node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:58:45.055991 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"
[0m21:58:45.056964 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:58:45.057400 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"
[0m21:58:45.057583 [debug] [Thread-4 (]: Began executing node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:58:45.057790 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m21:58:45.058718 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"
[0m21:58:45.058912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:45.059125 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:58:45.059398 [debug] [Thread-2 (]: On test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m21:58:45.059568 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:45.059788 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"
[0m21:58:45.059985 [debug] [Thread-4 (]: On test.dbt_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m21:58:45.060176 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:45.066474 [debug] [Thread-3 (]: SQL status: BEGIN in 0.023 seconds
[0m21:58:45.066697 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.not_null_stg_payments_order_id.601cf57649"
[0m21:58:45.066878 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_payments_order_id.601cf57649: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_payments_order_id.601cf57649"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dbt_test"."staging"."stg_payments"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:45.069716 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:58:45.071243 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_payments_order_id.601cf57649: ROLLBACK
[0m21:58:45.072709 [debug] [Thread-3 (]: On test.dbt_test.not_null_stg_payments_order_id.601cf57649: Close
[0m21:58:45.073044 [info ] [Thread-3 (]: 9 of 16 PASS not_null_stg_payments_order_id .................................... [[32mPASS[0m in 0.04s]
[0m21:58:45.073320 [debug] [Thread-3 (]: Finished running node test.dbt_test.not_null_stg_payments_order_id.601cf57649
[0m21:58:45.073505 [debug] [Thread-3 (]: Began running node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:58:45.073676 [info ] [Thread-3 (]: 13 of 16 START test unique_int_order_payments_order_id ......................... [RUN]
[0m21:58:45.073868 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_payments_order_id.601cf57649, now test.dbt_test.unique_int_order_payments_order_id.804c2d5021)
[0m21:58:45.074034 [debug] [Thread-3 (]: Began compiling node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:58:45.076331 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"
[0m21:58:45.076771 [debug] [Thread-3 (]: Began executing node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:58:45.077904 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"
[0m21:58:45.078370 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"
[0m21:58:45.078653 [debug] [Thread-3 (]: On test.dbt_test.unique_int_order_payments_order_id.804c2d5021: BEGIN
[0m21:58:45.078950 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:45.082941 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m21:58:45.083167 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"
[0m21:58:45.083350 [debug] [Thread-4 (]: On test.dbt_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_fct_orders_order_id.523ddb6ce5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_test"."marts"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:45.084332 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m21:58:45.084524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m21:58:45.084717 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m21:58:45.085097 [debug] [Thread-2 (]: On test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_test"."marts"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:45.084893 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"
[0m21:58:45.085336 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.not_null_stg_payments_payment_id.c19cc50075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_id
from "dbt_test"."staging"."stg_payments"
where payment_id is null



  
  
      
    ) dbt_internal_test
[0m21:58:45.086121 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:58:45.087134 [debug] [Thread-4 (]: On test.dbt_test.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m21:58:45.088117 [debug] [Thread-4 (]: On test.dbt_test.unique_fct_orders_order_id.523ddb6ce5: Close
[0m21:58:45.088475 [info ] [Thread-4 (]: 12 of 16 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.04s]
[0m21:58:45.088765 [debug] [Thread-4 (]: Finished running node test.dbt_test.unique_fct_orders_order_id.523ddb6ce5
[0m21:58:45.088964 [debug] [Thread-4 (]: Began running node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:58:45.089136 [info ] [Thread-4 (]: 14 of 16 START test unique_stg_customers_customer_id ........................... [RUN]
[0m21:58:45.089346 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_test.unique_fct_orders_order_id.523ddb6ce5, now test.dbt_test.unique_stg_customers_customer_id.c7614daada)
[0m21:58:45.089516 [debug] [Thread-4 (]: Began compiling node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:58:45.091749 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_test.unique_stg_customers_customer_id.c7614daada"
[0m21:58:45.091984 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m21:58:45.092190 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m21:58:45.092983 [debug] [Thread-2 (]: On test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m21:58:45.093650 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m21:58:45.093940 [debug] [Thread-4 (]: Began executing node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:58:45.095143 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_test.unique_stg_customers_customer_id.c7614daada"
[0m21:58:45.096076 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.unique_stg_customers_customer_id.c7614daada"
[0m21:58:45.096298 [debug] [Thread-4 (]: On test.dbt_test.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m21:58:45.096485 [debug] [Thread-2 (]: On test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m21:58:45.096708 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:45.096871 [debug] [Thread-1 (]: On test.dbt_test.not_null_stg_payments_payment_id.c19cc50075: Close
[0m21:58:45.097276 [info ] [Thread-2 (]: 11 of 16 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.05s]
[0m21:58:45.097645 [debug] [Thread-2 (]: Finished running node test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m21:58:45.097840 [debug] [Thread-2 (]: Began running node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:58:45.098088 [info ] [Thread-1 (]: 10 of 16 PASS not_null_stg_payments_payment_id ................................. [[32mPASS[0m in 0.06s]
[0m21:58:45.098545 [debug] [Thread-1 (]: Finished running node test.dbt_test.not_null_stg_payments_payment_id.c19cc50075
[0m21:58:45.098726 [debug] [Thread-1 (]: Began running node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:58:45.098318 [info ] [Thread-2 (]: 15 of 16 START test unique_stg_orders_order_id ................................. [RUN]
[0m21:58:45.098985 [info ] [Thread-1 (]: 16 of 16 START test unique_stg_payments_payment_id ............................. [RUN]
[0m21:58:45.099237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_test.unique_dim_customers_customer_id.15c9f1e2fd, now test.dbt_test.unique_stg_orders_order_id.e3b841c71a)
[0m21:58:45.099434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_test.not_null_stg_payments_payment_id.c19cc50075, now test.dbt_test.unique_stg_payments_payment_id.3744510712)
[0m21:58:45.099830 [debug] [Thread-2 (]: Began compiling node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:58:45.100037 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m21:58:45.100219 [debug] [Thread-1 (]: Began compiling node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:58:45.102836 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"
[0m21:58:45.103614 [debug] [Thread-3 (]: Using postgres connection "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"
[0m21:58:45.108101 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_test.unique_stg_payments_payment_id.3744510712"
[0m21:58:45.108394 [debug] [Thread-3 (]: On test.dbt_test.unique_int_order_payments_order_id.804c2d5021: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_int_order_payments_order_id.804c2d5021"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_test"."intermediate"."int_order_payments"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:45.109032 [debug] [Thread-1 (]: Began executing node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:58:45.110154 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_test.unique_stg_payments_payment_id.3744510712"
[0m21:58:45.110569 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.unique_stg_payments_payment_id.3744510712"
[0m21:58:45.110739 [debug] [Thread-1 (]: On test.dbt_test.unique_stg_payments_payment_id.3744510712: BEGIN
[0m21:58:45.110924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:45.111682 [debug] [Thread-2 (]: Began executing node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:58:45.118349 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"
[0m21:58:45.118882 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m21:58:45.120206 [debug] [Thread-3 (]: On test.dbt_test.unique_int_order_payments_order_id.804c2d5021: ROLLBACK
[0m21:58:45.120622 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"
[0m21:58:45.120823 [debug] [Thread-2 (]: On test.dbt_test.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m21:58:45.121035 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m21:58:45.121227 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:45.121393 [debug] [Thread-3 (]: On test.dbt_test.unique_int_order_payments_order_id.804c2d5021: Close
[0m21:58:45.121568 [debug] [Thread-4 (]: Using postgres connection "test.dbt_test.unique_stg_customers_customer_id.c7614daada"
[0m21:58:45.122217 [debug] [Thread-4 (]: On test.dbt_test.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_test"."staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:45.121993 [info ] [Thread-3 (]: 13 of 16 PASS unique_int_order_payments_order_id ............................... [[32mPASS[0m in 0.05s]
[0m21:58:45.122604 [debug] [Thread-3 (]: Finished running node test.dbt_test.unique_int_order_payments_order_id.804c2d5021
[0m21:58:45.125385 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:58:45.126171 [debug] [Thread-4 (]: On test.dbt_test.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m21:58:45.127158 [debug] [Thread-4 (]: On test.dbt_test.unique_stg_customers_customer_id.c7614daada: Close
[0m21:58:45.127505 [info ] [Thread-4 (]: 14 of 16 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.04s]
[0m21:58:45.128802 [debug] [Thread-4 (]: Finished running node test.dbt_test.unique_stg_customers_customer_id.c7614daada
[0m21:58:45.136852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m21:58:45.137162 [debug] [Thread-1 (]: Using postgres connection "test.dbt_test.unique_stg_payments_payment_id.3744510712"
[0m21:58:45.137367 [debug] [Thread-1 (]: On test.dbt_test.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_stg_payments_payment_id.3744510712"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "dbt_test"."staging"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:45.139090 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m21:58:45.139306 [debug] [Thread-2 (]: Using postgres connection "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"
[0m21:58:45.139496 [debug] [Thread-2 (]: On test.dbt_test.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "test.dbt_test.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_test"."staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:45.140049 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:58:45.140954 [debug] [Thread-1 (]: On test.dbt_test.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m21:58:45.141704 [debug] [Thread-1 (]: On test.dbt_test.unique_stg_payments_payment_id.3744510712: Close
[0m21:58:45.142039 [info ] [Thread-1 (]: 16 of 16 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.04s]
[0m21:58:45.142288 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m21:58:45.142537 [debug] [Thread-1 (]: Finished running node test.dbt_test.unique_stg_payments_payment_id.3744510712
[0m21:58:45.143264 [debug] [Thread-2 (]: On test.dbt_test.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m21:58:45.143990 [debug] [Thread-2 (]: On test.dbt_test.unique_stg_orders_order_id.e3b841c71a: Close
[0m21:58:45.144337 [info ] [Thread-2 (]: 15 of 16 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.05s]
[0m21:58:45.144993 [debug] [Thread-2 (]: Finished running node test.dbt_test.unique_stg_orders_order_id.e3b841c71a
[0m21:58:45.147949 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:45.148141 [debug] [MainThread]: On master: BEGIN
[0m21:58:45.148398 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:58:45.159977 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m21:58:45.160178 [debug] [MainThread]: On master: COMMIT
[0m21:58:45.160330 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:45.160476 [debug] [MainThread]: On master: COMMIT
[0m21:58:45.161323 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:58:45.161560 [debug] [MainThread]: On master: Close
[0m21:58:45.162769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:45.162965 [debug] [MainThread]: Connection 'test.dbt_test.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m21:58:45.163129 [debug] [MainThread]: Connection 'test.dbt_test.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m21:58:45.163279 [debug] [MainThread]: Connection 'test.dbt_test.unique_int_order_payments_order_id.804c2d5021' was properly closed.
[0m21:58:45.163415 [debug] [MainThread]: Connection 'test.dbt_test.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m21:58:45.163588 [info ] [MainThread]: 
[0m21:58:45.163836 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m21:58:45.165121 [debug] [MainThread]: Command end result
[0m21:58:45.179597 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m21:58:45.180646 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m21:58:45.184912 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m21:58:45.185119 [info ] [MainThread]: 
[0m21:58:45.185408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:58:45.185613 [info ] [MainThread]: 
[0m21:58:45.185796 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m21:58:45.187736 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0776386, "process_in_blocks": "0", "process_kernel_time": 0.233642, "process_mem_max_rss": "125943808", "process_out_blocks": "0", "process_user_time": 1.313109}
[0m21:58:45.188013 [debug] [MainThread]: Command `dbt test` succeeded at 21:58:45.187962 after 1.08 seconds
[0m21:58:45.188218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b35310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112167800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112167750>]}
[0m21:58:45.188436 [debug] [MainThread]: Flushing usage events
[0m21:58:45.633929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:13:52.488657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105407890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105407b10>]}


============================== 22:13:52.492165 | 6fd85a57-40dd-4b91-b2b1-fde33f26d4ac ==============================
[0m22:13:52.492165 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:13:52.492511 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'static_parser': 'True', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'debug': 'False', 'profiles_dir': '/Users/adil/.dbt', 'warn_error': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'use_colors': 'True', 'introspect': 'True', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m22:13:52.591119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fd85a57-40dd-4b91-b2b1-fde33f26d4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047809d0>]}
[0m22:13:52.618837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fd85a57-40dd-4b91-b2b1-fde33f26d4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052af790>]}
[0m22:13:52.619394 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:13:52.667695 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m22:13:52.717855 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:13:52.718108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6fd85a57-40dd-4b91-b2b1-fde33f26d4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10634b650>]}
[0m22:13:53.370151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fd85a57-40dd-4b91-b2b1-fde33f26d4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644a120>]}
[0m22:13:53.413786 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m22:13:53.415052 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m22:13:53.429667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fd85a57-40dd-4b91-b2b1-fde33f26d4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10555b690>]}
[0m22:13:53.429907 [info ] [MainThread]: Found 6 models, 2 seeds, 16 data tests, 3 sources, 460 macros
[0m22:13:53.430078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fd85a57-40dd-4b91-b2b1-fde33f26d4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ecc80>]}
[0m22:13:53.431004 [info ] [MainThread]: 
[0m22:13:53.431187 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:13:53.431327 [info ] [MainThread]: 
[0m22:13:53.431542 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:13:53.433211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m22:13:53.474884 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m22:13:53.475102 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m22:13:53.475247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:53.616695 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.141 seconds
[0m22:13:53.618015 [debug] [ThreadPool]: On list_dbt_test: Close
[0m22:13:53.619373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_intermediate)
[0m22:13:53.623772 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m22:13:53.624182 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_marts'
[0m22:13:53.624520 [debug] [ThreadPool]: On list_dbt_test_intermediate: BEGIN
[0m22:13:53.624916 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_staging'
[0m22:13:53.626062 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m22:13:53.626400 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_raw'
[0m22:13:53.626995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:53.628023 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m22:13:53.628250 [debug] [ThreadPool]: On list_dbt_test_marts: BEGIN
[0m22:13:53.629321 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_raw"
[0m22:13:53.629657 [debug] [ThreadPool]: On list_dbt_test_staging: BEGIN
[0m22:13:53.629851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:53.630028 [debug] [ThreadPool]: On list_dbt_test_raw: BEGIN
[0m22:13:53.630220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:53.630484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:53.654971 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m22:13:53.655343 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m22:13:53.655696 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m22:13:53.655893 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m22:13:53.656116 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m22:13:53.656363 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m22:13:53.656612 [debug] [ThreadPool]: On list_dbt_test_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m22:13:53.656822 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m22:13:53.657006 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_raw"
[0m22:13:53.657199 [debug] [ThreadPool]: On list_dbt_test_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m22:13:53.657485 [debug] [ThreadPool]: On list_dbt_test_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intermediate'
  
[0m22:13:53.657721 [debug] [ThreadPool]: On list_dbt_test_raw: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_raw"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m22:13:53.667635 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m22:13:53.667860 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m22:13:53.668629 [debug] [ThreadPool]: On list_dbt_test_marts: ROLLBACK
[0m22:13:53.668804 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m22:13:53.669433 [debug] [ThreadPool]: On list_dbt_test_intermediate: ROLLBACK
[0m22:13:53.669633 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.012 seconds
[0m22:13:53.670298 [debug] [ThreadPool]: On list_dbt_test_raw: ROLLBACK
[0m22:13:53.670475 [debug] [ThreadPool]: On list_dbt_test_marts: Close
[0m22:13:53.671201 [debug] [ThreadPool]: On list_dbt_test_staging: ROLLBACK
[0m22:13:53.671404 [debug] [ThreadPool]: On list_dbt_test_intermediate: Close
[0m22:13:53.672181 [debug] [ThreadPool]: On list_dbt_test_raw: Close
[0m22:13:53.673026 [debug] [ThreadPool]: On list_dbt_test_staging: Close
[0m22:13:53.677949 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:53.678165 [debug] [MainThread]: On master: BEGIN
[0m22:13:53.678727 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:13:53.693300 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m22:13:53.693550 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:53.693764 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:13:53.699188 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m22:13:53.700347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fd85a57-40dd-4b91-b2b1-fde33f26d4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b54e90>]}
[0m22:13:53.700585 [debug] [MainThread]: On master: ROLLBACK
[0m22:13:53.701107 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:53.701293 [debug] [MainThread]: On master: BEGIN
[0m22:13:53.701983 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:13:53.702134 [debug] [MainThread]: On master: COMMIT
[0m22:13:53.702270 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:53.702397 [debug] [MainThread]: On master: COMMIT
[0m22:13:53.702776 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:13:53.702921 [debug] [MainThread]: On master: Close
[0m22:13:53.704581 [debug] [Thread-2 (]: Began running node seed.dbt_test.orders
[0m22:13:53.704772 [debug] [Thread-1 (]: Began running node seed.dbt_test.customers
[0m22:13:53.705016 [info ] [Thread-2 (]: 2 of 2 START seed file raw.orders .............................................. [RUN]
[0m22:13:53.705449 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_marts, now seed.dbt_test.orders)
[0m22:13:53.705266 [info ] [Thread-1 (]: 1 of 2 START seed file raw.customers ........................................... [RUN]
[0m22:13:53.705663 [debug] [Thread-2 (]: Began compiling node seed.dbt_test.orders
[0m22:13:53.705845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_intermediate, now seed.dbt_test.customers)
[0m22:13:53.706021 [debug] [Thread-2 (]: Began executing node seed.dbt_test.orders
[0m22:13:53.706182 [debug] [Thread-1 (]: Began compiling node seed.dbt_test.customers
[0m22:13:53.715941 [debug] [Thread-1 (]: Began executing node seed.dbt_test.customers
[0m22:13:53.726955 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_test.orders"
[0m22:13:53.727235 [debug] [Thread-2 (]: On seed.dbt_test.orders: BEGIN
[0m22:13:53.727604 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:13:53.730938 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_test.customers"
[0m22:13:53.731246 [debug] [Thread-1 (]: On seed.dbt_test.customers: BEGIN
[0m22:13:53.731444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:53.754052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m22:13:53.754347 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_test.customers"
[0m22:13:53.754543 [debug] [Thread-1 (]: On seed.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "seed.dbt_test.customers"} */
truncate table "dbt_test"."raw"."customers"
[0m22:13:53.755369 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m22:13:53.755603 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_test.orders"
[0m22:13:53.755793 [debug] [Thread-2 (]: On seed.dbt_test.orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "seed.dbt_test.orders"} */
truncate table "dbt_test"."raw"."orders"
[0m22:13:53.757079 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cannot truncate a table referenced in a foreign key constraint
DETAIL:  Table "orders" references "customers".
HINT:  Truncate table "orders" at the same time, or use TRUNCATE ... CASCADE.

[0m22:13:53.757322 [debug] [Thread-1 (]: On seed.dbt_test.customers: ROLLBACK
[0m22:13:53.757526 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cannot truncate a table referenced in a foreign key constraint
DETAIL:  Table "payments" references "orders".
HINT:  Truncate table "payments" at the same time, or use TRUNCATE ... CASCADE.

[0m22:13:53.757707 [debug] [Thread-2 (]: On seed.dbt_test.orders: ROLLBACK
[0m22:13:53.758127 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro truncate_relation
[0m22:13:53.758330 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m22:13:53.758583 [debug] [Thread-2 (]: Postgres adapter: Error running SQL: macro truncate_relation
[0m22:13:53.758820 [debug] [Thread-1 (]: On seed.dbt_test.customers: Close
[0m22:13:53.759005 [debug] [Thread-2 (]: Postgres adapter: Rolling back transaction.
[0m22:13:53.759214 [debug] [Thread-2 (]: On seed.dbt_test.orders: Close
[0m22:13:53.771971 [debug] [Thread-2 (]: Database Error in seed orders (seeds/orders.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "payments" references "orders".
  HINT:  Truncate table "payments" at the same time, or use TRUNCATE ... CASCADE.
[0m22:13:53.772677 [debug] [Thread-1 (]: Database Error in seed customers (seeds/customers.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "orders" references "customers".
  HINT:  Truncate table "orders" at the same time, or use TRUNCATE ... CASCADE.
[0m22:13:53.774122 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fd85a57-40dd-4b91-b2b1-fde33f26d4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d9d30>]}
[0m22:13:53.774642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fd85a57-40dd-4b91-b2b1-fde33f26d4ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104704370>]}
[0m22:13:53.774465 [error] [Thread-2 (]: 2 of 2 ERROR loading seed file raw.orders ...................................... [[31mERROR[0m in 0.07s]
[0m22:13:53.775375 [debug] [Thread-2 (]: Finished running node seed.dbt_test.orders
[0m22:13:53.775659 [debug] [Thread-7 (]: Marking all children of 'seed.dbt_test.orders' to be skipped because of status 'error'.  Reason: Database Error in seed orders (seeds/orders.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "payments" references "orders".
  HINT:  Truncate table "payments" at the same time, or use TRUNCATE ... CASCADE..
[0m22:13:53.775029 [error] [Thread-1 (]: 1 of 2 ERROR loading seed file raw.customers ................................... [[31mERROR[0m in 0.07s]
[0m22:13:53.776320 [debug] [Thread-1 (]: Finished running node seed.dbt_test.customers
[0m22:13:53.776570 [debug] [Thread-7 (]: Marking all children of 'seed.dbt_test.customers' to be skipped because of status 'error'.  Reason: Database Error in seed customers (seeds/customers.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "orders" references "customers".
  HINT:  Truncate table "orders" at the same time, or use TRUNCATE ... CASCADE..
[0m22:13:53.777179 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:53.777329 [debug] [MainThread]: On master: BEGIN
[0m22:13:53.777468 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:13:53.789728 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:13:53.789976 [debug] [MainThread]: On master: COMMIT
[0m22:13:53.790141 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:53.790281 [debug] [MainThread]: On master: COMMIT
[0m22:13:53.790814 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:13:53.791003 [debug] [MainThread]: On master: Close
[0m22:13:53.791237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:53.791381 [debug] [MainThread]: Connection 'seed.dbt_test.customers' was properly closed.
[0m22:13:53.791507 [debug] [MainThread]: Connection 'seed.dbt_test.orders' was properly closed.
[0m22:13:53.791626 [debug] [MainThread]: Connection 'list_dbt_test_staging' was properly closed.
[0m22:13:53.791740 [debug] [MainThread]: Connection 'list_dbt_test_raw' was properly closed.
[0m22:13:53.791891 [info ] [MainThread]: 
[0m22:13:53.792125 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m22:13:53.792527 [debug] [MainThread]: Command end result
[0m22:13:53.808052 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m22:13:53.809061 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m22:13:53.812422 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m22:13:53.812619 [info ] [MainThread]: 
[0m22:13:53.812816 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:13:53.812970 [info ] [MainThread]: 
[0m22:13:53.813154 [error] [MainThread]: [31mFailure in seed orders (seeds/orders.csv)[0m
[0m22:13:53.813330 [error] [MainThread]:   Database Error in seed orders (seeds/orders.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "payments" references "orders".
  HINT:  Truncate table "payments" at the same time, or use TRUNCATE ... CASCADE.
[0m22:13:53.813474 [info ] [MainThread]: 
[0m22:13:53.813635 [error] [MainThread]: [31mFailure in seed customers (seeds/customers.csv)[0m
[0m22:13:53.813797 [error] [MainThread]:   Database Error in seed customers (seeds/customers.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "orders" references "customers".
  HINT:  Truncate table "orders" at the same time, or use TRUNCATE ... CASCADE.
[0m22:13:53.813930 [info ] [MainThread]: 
[0m22:13:53.814084 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m22:13:53.815961 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.3646668, "process_in_blocks": "0", "process_kernel_time": 0.190262, "process_mem_max_rss": "139821056", "process_out_blocks": "0", "process_user_time": 1.619143}
[0m22:13:53.816217 [debug] [MainThread]: Command `dbt seed` failed at 22:13:53.816165 after 1.36 seconds
[0m22:13:53.816414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054807c0>]}
[0m22:13:53.816603 [debug] [MainThread]: Flushing usage events
[0m22:13:54.305941 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:15:30.603960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10437c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051af890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051afb10>]}


============================== 22:15:30.607557 | 526e3b61-eb3a-44d1-9bc6-52c08b559178 ==============================
[0m22:15:30.607557 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:15:30.607922 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'printer_width': '80', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'cache_selected_only': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'quiet': 'False', 'debug': 'False', 'introspect': 'True', 'log_format': 'default', 'partial_parse': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/adil/.dbt', 'indirect_selection': 'eager', 'empty': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'write_json': 'True'}
[0m22:15:30.709453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '526e3b61-eb3a-44d1-9bc6-52c08b559178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045289d0>]}
[0m22:15:30.737058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '526e3b61-eb3a-44d1-9bc6-52c08b559178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105057790>]}
[0m22:15:30.737595 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:15:30.788816 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m22:15:30.873338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:30.873547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:30.899859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '526e3b61-eb3a-44d1-9bc6-52c08b559178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f0750>]}
[0m22:15:30.946631 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m22:15:30.947722 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m22:15:30.961449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '526e3b61-eb3a-44d1-9bc6-52c08b559178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d32f0>]}
[0m22:15:30.961673 [info ] [MainThread]: Found 6 models, 2 seeds, 16 data tests, 3 sources, 460 macros
[0m22:15:30.961850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '526e3b61-eb3a-44d1-9bc6-52c08b559178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10628ce50>]}
[0m22:15:30.962799 [info ] [MainThread]: 
[0m22:15:30.962983 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:30.963121 [info ] [MainThread]: 
[0m22:15:30.963352 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:30.965007 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m22:15:31.008514 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m22:15:31.008719 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m22:15:31.008859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:31.071854 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.063 seconds
[0m22:15:31.072607 [debug] [ThreadPool]: On list_dbt_test: Close
[0m22:15:31.073414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_staging)
[0m22:15:31.076261 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m22:15:31.076507 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_raw'
[0m22:15:31.076671 [debug] [ThreadPool]: On list_dbt_test_staging: BEGIN
[0m22:15:31.076890 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_marts'
[0m22:15:31.077126 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_intermediate'
[0m22:15:31.077882 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_raw"
[0m22:15:31.078268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:31.079003 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m22:15:31.079718 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m22:15:31.079860 [debug] [ThreadPool]: On list_dbt_test_raw: BEGIN
[0m22:15:31.080064 [debug] [ThreadPool]: On list_dbt_test_marts: BEGIN
[0m22:15:31.080201 [debug] [ThreadPool]: On list_dbt_test_intermediate: BEGIN
[0m22:15:31.080332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:31.080471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:31.080603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:31.097133 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m22:15:31.097339 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m22:15:31.097505 [debug] [ThreadPool]: On list_dbt_test_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m22:15:31.097793 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m22:15:31.097976 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_raw"
[0m22:15:31.098142 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m22:15:31.098299 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m22:15:31.098469 [debug] [ThreadPool]: On list_dbt_test_raw: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_raw"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m22:15:31.098630 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m22:15:31.098768 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m22:15:31.098956 [debug] [ThreadPool]: On list_dbt_test_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m22:15:31.099163 [debug] [ThreadPool]: On list_dbt_test_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intermediate'
  
[0m22:15:31.102333 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m22:15:31.103253 [debug] [ThreadPool]: On list_dbt_test_staging: ROLLBACK
[0m22:15:31.103446 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m22:15:31.103597 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m22:15:31.104254 [debug] [ThreadPool]: On list_dbt_test_marts: ROLLBACK
[0m22:15:31.104435 [debug] [ThreadPool]: On list_dbt_test_staging: Close
[0m22:15:31.105065 [debug] [ThreadPool]: On list_dbt_test_raw: ROLLBACK
[0m22:15:31.105230 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m22:15:31.105989 [debug] [ThreadPool]: On list_dbt_test_intermediate: ROLLBACK
[0m22:15:31.106182 [debug] [ThreadPool]: On list_dbt_test_marts: Close
[0m22:15:31.106361 [debug] [ThreadPool]: On list_dbt_test_raw: Close
[0m22:15:31.107084 [debug] [ThreadPool]: On list_dbt_test_intermediate: Close
[0m22:15:31.112156 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:31.112355 [debug] [MainThread]: On master: BEGIN
[0m22:15:31.112493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:31.127800 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m22:15:31.128012 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:31.128213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:15:31.132827 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m22:15:31.133929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '526e3b61-eb3a-44d1-9bc6-52c08b559178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106549bf0>]}
[0m22:15:31.134201 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:31.134730 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:31.134875 [debug] [MainThread]: On master: BEGIN
[0m22:15:31.135708 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:15:31.135890 [debug] [MainThread]: On master: COMMIT
[0m22:15:31.136045 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:31.136187 [debug] [MainThread]: On master: COMMIT
[0m22:15:31.136717 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:31.136884 [debug] [MainThread]: On master: Close
[0m22:15:31.139490 [debug] [Thread-1 (]: Began running node seed.dbt_test.customers
[0m22:15:31.139719 [debug] [Thread-2 (]: Began running node seed.dbt_test.orders
[0m22:15:31.140005 [info ] [Thread-1 (]: 1 of 2 START seed file raw.customers ........................................... [RUN]
[0m22:15:31.140324 [info ] [Thread-2 (]: 2 of 2 START seed file raw.orders .............................................. [RUN]
[0m22:15:31.140592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_staging, now seed.dbt_test.customers)
[0m22:15:31.140964 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_raw, now seed.dbt_test.orders)
[0m22:15:31.141149 [debug] [Thread-1 (]: Began compiling node seed.dbt_test.customers
[0m22:15:31.141352 [debug] [Thread-2 (]: Began compiling node seed.dbt_test.orders
[0m22:15:31.141535 [debug] [Thread-1 (]: Began executing node seed.dbt_test.customers
[0m22:15:31.141700 [debug] [Thread-2 (]: Began executing node seed.dbt_test.orders
[0m22:15:31.164057 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_test.customers"
[0m22:15:31.165072 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_test.orders"
[0m22:15:31.165270 [debug] [Thread-1 (]: On seed.dbt_test.customers: BEGIN
[0m22:15:31.165460 [debug] [Thread-2 (]: On seed.dbt_test.orders: BEGIN
[0m22:15:31.165631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:31.165805 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:31.184592 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m22:15:31.184895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m22:15:31.185119 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_test.orders"
[0m22:15:31.185350 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_test.customers"
[0m22:15:31.185556 [debug] [Thread-2 (]: On seed.dbt_test.orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "seed.dbt_test.orders"} */
truncate table "dbt_test"."raw"."orders"
[0m22:15:31.185781 [debug] [Thread-1 (]: On seed.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "seed.dbt_test.customers"} */
truncate table "dbt_test"."raw"."customers"
[0m22:15:31.187226 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cannot truncate a table referenced in a foreign key constraint
DETAIL:  Table "orders" references "customers".
HINT:  Truncate table "orders" at the same time, or use TRUNCATE ... CASCADE.

[0m22:15:31.224885 [debug] [Thread-1 (]: On seed.dbt_test.customers: ROLLBACK
[0m22:15:31.225200 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cannot truncate a table referenced in a foreign key constraint
DETAIL:  Table "payments" references "orders".
HINT:  Truncate table "payments" at the same time, or use TRUNCATE ... CASCADE.

[0m22:15:31.225478 [debug] [Thread-2 (]: On seed.dbt_test.orders: ROLLBACK
[0m22:15:31.226216 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro truncate_relation
[0m22:15:31.226499 [debug] [Thread-2 (]: Postgres adapter: Error running SQL: macro truncate_relation
[0m22:15:31.226707 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m22:15:31.226917 [debug] [Thread-2 (]: Postgres adapter: Rolling back transaction.
[0m22:15:31.227146 [debug] [Thread-1 (]: On seed.dbt_test.customers: Close
[0m22:15:31.227343 [debug] [Thread-2 (]: On seed.dbt_test.orders: Close
[0m22:15:31.236800 [debug] [Thread-1 (]: Database Error in seed customers (seeds/customers.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "orders" references "customers".
  HINT:  Truncate table "orders" at the same time, or use TRUNCATE ... CASCADE.
[0m22:15:31.239561 [debug] [Thread-2 (]: Database Error in seed orders (seeds/orders.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "payments" references "orders".
  HINT:  Truncate table "payments" at the same time, or use TRUNCATE ... CASCADE.
[0m22:15:31.240321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526e3b61-eb3a-44d1-9bc6-52c08b559178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dbb90>]}
[0m22:15:31.240506 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '526e3b61-eb3a-44d1-9bc6-52c08b559178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632f3e0>]}
[0m22:15:31.240799 [error] [Thread-1 (]: 1 of 2 ERROR loading seed file raw.customers ................................... [[31mERROR[0m in 0.10s]
[0m22:15:31.241162 [debug] [Thread-1 (]: Finished running node seed.dbt_test.customers
[0m22:15:31.241617 [debug] [Thread-7 (]: Marking all children of 'seed.dbt_test.customers' to be skipped because of status 'error'.  Reason: Database Error in seed customers (seeds/customers.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "orders" references "customers".
  HINT:  Truncate table "orders" at the same time, or use TRUNCATE ... CASCADE..
[0m22:15:31.241382 [error] [Thread-2 (]: 2 of 2 ERROR loading seed file raw.orders ...................................... [[31mERROR[0m in 0.10s]
[0m22:15:31.242281 [debug] [Thread-2 (]: Finished running node seed.dbt_test.orders
[0m22:15:31.242525 [debug] [Thread-7 (]: Marking all children of 'seed.dbt_test.orders' to be skipped because of status 'error'.  Reason: Database Error in seed orders (seeds/orders.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "payments" references "orders".
  HINT:  Truncate table "payments" at the same time, or use TRUNCATE ... CASCADE..
[0m22:15:31.243183 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:31.243339 [debug] [MainThread]: On master: BEGIN
[0m22:15:31.243516 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:31.256885 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m22:15:31.257182 [debug] [MainThread]: On master: COMMIT
[0m22:15:31.257387 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:31.257559 [debug] [MainThread]: On master: COMMIT
[0m22:15:31.258084 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:15:31.258251 [debug] [MainThread]: On master: Close
[0m22:15:31.258488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:31.258624 [debug] [MainThread]: Connection 'seed.dbt_test.customers' was properly closed.
[0m22:15:31.258744 [debug] [MainThread]: Connection 'seed.dbt_test.orders' was properly closed.
[0m22:15:31.258861 [debug] [MainThread]: Connection 'list_dbt_test_marts' was properly closed.
[0m22:15:31.258975 [debug] [MainThread]: Connection 'list_dbt_test_intermediate' was properly closed.
[0m22:15:31.259130 [info ] [MainThread]: 
[0m22:15:31.259325 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m22:15:31.259772 [debug] [MainThread]: Command end result
[0m22:15:31.275049 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m22:15:31.276114 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m22:15:31.279476 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m22:15:31.279662 [info ] [MainThread]: 
[0m22:15:31.279863 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:15:31.280018 [info ] [MainThread]: 
[0m22:15:31.280200 [error] [MainThread]: [31mFailure in seed customers (seeds/customers.csv)[0m
[0m22:15:31.280370 [error] [MainThread]:   Database Error in seed customers (seeds/customers.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "orders" references "customers".
  HINT:  Truncate table "orders" at the same time, or use TRUNCATE ... CASCADE.
[0m22:15:31.280510 [info ] [MainThread]: 
[0m22:15:31.280667 [error] [MainThread]: [31mFailure in seed orders (seeds/orders.csv)[0m
[0m22:15:31.280825 [error] [MainThread]:   Database Error in seed orders (seeds/orders.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "payments" references "orders".
  HINT:  Truncate table "payments" at the same time, or use TRUNCATE ... CASCADE.
[0m22:15:31.280957 [info ] [MainThread]: 
[0m22:15:31.281106 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m22:15:31.282931 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.7334337, "process_in_blocks": "0", "process_kernel_time": 0.188916, "process_mem_max_rss": "129368064", "process_out_blocks": "0", "process_user_time": 1.133895}
[0m22:15:31.283179 [debug] [MainThread]: Command `dbt seed` failed at 22:15:31.283135 after 0.73 seconds
[0m22:15:31.283380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c1bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106716570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b9850>]}
[0m22:15:31.283568 [debug] [MainThread]: Flushing usage events
[0m22:15:31.738636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:17:07.133185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104380590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051af890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051afb10>]}


============================== 22:17:07.136569 | e9a5c773-378c-4d89-a875-2b68e660d917 ==============================
[0m22:17:07.136569 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:17:07.136900 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'profiles_dir': '/Users/adil/.dbt', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'invocation_command': 'dbt seed', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'printer_width': '80', 'debug': 'False', 'log_format': 'default', 'write_json': 'True'}
[0m22:17:07.240960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9a5c773-378c-4d89-a875-2b68e660d917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045289d0>]}
[0m22:17:07.268715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9a5c773-378c-4d89-a875-2b68e660d917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105057790>]}
[0m22:17:07.269450 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:17:07.317841 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m22:17:07.401246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:17:07.401552 [debug] [MainThread]: Partial parsing: added file: dbt_test://seeds/payments.csv
[0m22:17:07.508992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9a5c773-378c-4d89-a875-2b68e660d917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f7d50>]}
[0m22:17:07.554641 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m22:17:07.555780 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m22:17:07.570525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9a5c773-378c-4d89-a875-2b68e660d917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630fe30>]}
[0m22:17:07.570758 [info ] [MainThread]: Found 6 models, 3 seeds, 16 data tests, 3 sources, 460 macros
[0m22:17:07.570939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9a5c773-378c-4d89-a875-2b68e660d917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106290e50>]}
[0m22:17:07.571935 [info ] [MainThread]: 
[0m22:17:07.572117 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:17:07.572256 [info ] [MainThread]: 
[0m22:17:07.572475 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:17:07.574187 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m22:17:07.645490 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m22:17:07.645713 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m22:17:07.645859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:07.702989 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.057 seconds
[0m22:17:07.703834 [debug] [ThreadPool]: On list_dbt_test: Close
[0m22:17:07.704801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_raw)
[0m22:17:07.707920 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_raw"
[0m22:17:07.708173 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_staging'
[0m22:17:07.708337 [debug] [ThreadPool]: On list_dbt_test_raw: BEGIN
[0m22:17:07.708589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_marts'
[0m22:17:07.709781 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m22:17:07.710014 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_intermediate'
[0m22:17:07.710215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:07.711044 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m22:17:07.711211 [debug] [ThreadPool]: On list_dbt_test_staging: BEGIN
[0m22:17:07.711946 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m22:17:07.712198 [debug] [ThreadPool]: On list_dbt_test_marts: BEGIN
[0m22:17:07.712357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:07.712521 [debug] [ThreadPool]: On list_dbt_test_intermediate: BEGIN
[0m22:17:07.712666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:07.712904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:07.731432 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m22:17:07.731700 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m22:17:07.731854 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m22:17:07.732010 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m22:17:07.732162 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m22:17:07.732336 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m22:17:07.732532 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_raw"
[0m22:17:07.732683 [debug] [ThreadPool]: On list_dbt_test_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intermediate'
  
[0m22:17:07.732827 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m22:17:07.732965 [debug] [ThreadPool]: On list_dbt_test_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m22:17:07.733121 [debug] [ThreadPool]: On list_dbt_test_raw: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_raw"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m22:17:07.733323 [debug] [ThreadPool]: On list_dbt_test_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m22:17:07.738951 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m22:17:07.739138 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m22:17:07.739286 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m22:17:07.739412 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m22:17:07.740036 [debug] [ThreadPool]: On list_dbt_test_staging: ROLLBACK
[0m22:17:07.740618 [debug] [ThreadPool]: On list_dbt_test_marts: ROLLBACK
[0m22:17:07.741157 [debug] [ThreadPool]: On list_dbt_test_raw: ROLLBACK
[0m22:17:07.741650 [debug] [ThreadPool]: On list_dbt_test_intermediate: ROLLBACK
[0m22:17:07.742338 [debug] [ThreadPool]: On list_dbt_test_raw: Close
[0m22:17:07.742489 [debug] [ThreadPool]: On list_dbt_test_intermediate: Close
[0m22:17:07.742633 [debug] [ThreadPool]: On list_dbt_test_marts: Close
[0m22:17:07.742843 [debug] [ThreadPool]: On list_dbt_test_staging: Close
[0m22:17:07.748482 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:07.748682 [debug] [MainThread]: On master: BEGIN
[0m22:17:07.748828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:17:07.761763 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m22:17:07.761939 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:07.762129 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:17:07.766615 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m22:17:07.767297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9a5c773-378c-4d89-a875-2b68e660d917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643fad0>]}
[0m22:17:07.767549 [debug] [MainThread]: On master: ROLLBACK
[0m22:17:07.768051 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:07.768222 [debug] [MainThread]: On master: BEGIN
[0m22:17:07.769064 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:17:07.769244 [debug] [MainThread]: On master: COMMIT
[0m22:17:07.769395 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:07.769530 [debug] [MainThread]: On master: COMMIT
[0m22:17:07.769982 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:17:07.770134 [debug] [MainThread]: On master: Close
[0m22:17:07.772206 [debug] [Thread-2 (]: Began running node seed.dbt_test.orders
[0m22:17:07.772405 [debug] [Thread-3 (]: Began running node seed.dbt_test.payments
[0m22:17:07.772583 [debug] [Thread-1 (]: Began running node seed.dbt_test.customers
[0m22:17:07.772826 [info ] [Thread-2 (]: 2 of 3 START seed file raw.orders .............................................. [RUN]
[0m22:17:07.773061 [info ] [Thread-3 (]: 3 of 3 START seed file raw.payments ............................................ [RUN]
[0m22:17:07.773555 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_staging, now seed.dbt_test.orders)
[0m22:17:07.773320 [info ] [Thread-1 (]: 1 of 3 START seed file raw.customers ........................................... [RUN]
[0m22:17:07.773801 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_marts, now seed.dbt_test.payments)
[0m22:17:07.773977 [debug] [Thread-2 (]: Began compiling node seed.dbt_test.orders
[0m22:17:07.774150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_raw, now seed.dbt_test.customers)
[0m22:17:07.774314 [debug] [Thread-3 (]: Began compiling node seed.dbt_test.payments
[0m22:17:07.774490 [debug] [Thread-2 (]: Began executing node seed.dbt_test.orders
[0m22:17:07.774661 [debug] [Thread-1 (]: Began compiling node seed.dbt_test.customers
[0m22:17:07.774833 [debug] [Thread-3 (]: Began executing node seed.dbt_test.payments
[0m22:17:07.782909 [debug] [Thread-1 (]: Began executing node seed.dbt_test.customers
[0m22:17:07.793402 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_test.orders"
[0m22:17:07.793610 [debug] [Thread-2 (]: On seed.dbt_test.orders: BEGIN
[0m22:17:07.793772 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:17:07.794900 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_test.payments"
[0m22:17:07.796279 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_test.customers"
[0m22:17:07.796507 [debug] [Thread-3 (]: On seed.dbt_test.payments: BEGIN
[0m22:17:07.796708 [debug] [Thread-1 (]: On seed.dbt_test.customers: BEGIN
[0m22:17:07.796892 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:17:07.797092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:07.809515 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m22:17:07.809738 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_test.orders"
[0m22:17:07.809915 [debug] [Thread-2 (]: On seed.dbt_test.orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "seed.dbt_test.orders"} */
truncate table "dbt_test"."raw"."orders"
[0m22:17:07.810118 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m22:17:07.810357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m22:17:07.810574 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_test.payments"
[0m22:17:07.810765 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_test.customers"
[0m22:17:07.810952 [debug] [Thread-3 (]: On seed.dbt_test.payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "seed.dbt_test.payments"} */
truncate table "dbt_test"."raw"."payments"
[0m22:17:07.811124 [debug] [Thread-1 (]: On seed.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "seed.dbt_test.customers"} */
truncate table "dbt_test"."raw"."customers"
[0m22:17:07.812838 [debug] [Thread-2 (]: Postgres adapter: Postgres error: cannot truncate a table referenced in a foreign key constraint
DETAIL:  Table "payments" references "orders".
HINT:  Truncate table "payments" at the same time, or use TRUNCATE ... CASCADE.

[0m22:17:07.813048 [debug] [Thread-2 (]: On seed.dbt_test.orders: ROLLBACK
[0m22:17:07.813264 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cannot truncate a table referenced in a foreign key constraint
DETAIL:  Table "orders" references "customers".
HINT:  Truncate table "orders" at the same time, or use TRUNCATE ... CASCADE.

[0m22:17:07.813440 [debug] [Thread-1 (]: On seed.dbt_test.customers: ROLLBACK
[0m22:17:07.814236 [debug] [Thread-2 (]: Postgres adapter: Error running SQL: macro truncate_relation
[0m22:17:07.814408 [debug] [Thread-2 (]: Postgres adapter: Rolling back transaction.
[0m22:17:07.814600 [debug] [Thread-2 (]: On seed.dbt_test.orders: Close
[0m22:17:07.815772 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro truncate_relation
[0m22:17:07.815996 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m22:17:07.816196 [debug] [Thread-1 (]: On seed.dbt_test.customers: Close
[0m22:17:07.820415 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.009 seconds
[0m22:17:07.828671 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_test.payments"
[0m22:17:07.828911 [debug] [Thread-3 (]: On seed.dbt_test.payments: 
          insert into "dbt_test"."raw"."payments" ("id", "order_id", "payment_method", "amount", "paid_at") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m22:17:07.834316 [debug] [Thread-3 (]: SQL status: INSERT 0 5 in 0.005 seconds
[0m22:17:07.834862 [debug] [Thread-1 (]: Database Error in seed customers (seeds/customers.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "orders" references "customers".
  HINT:  Truncate table "orders" at the same time, or use TRUNCATE ... CASCADE.
[0m22:17:07.835371 [debug] [Thread-2 (]: Database Error in seed orders (seeds/orders.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "payments" references "orders".
  HINT:  Truncate table "payments" at the same time, or use TRUNCATE ... CASCADE.
[0m22:17:07.838114 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_test.payments"
[0m22:17:07.839650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9a5c773-378c-4d89-a875-2b68e660d917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678a210>]}
[0m22:17:07.839839 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9a5c773-378c-4d89-a875-2b68e660d917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ecb50>]}
[0m22:17:07.840122 [error] [Thread-1 (]: 1 of 3 ERROR loading seed file raw.customers ................................... [[31mERROR[0m in 0.06s]
[0m22:17:07.847827 [debug] [Thread-3 (]: On seed.dbt_test.payments: COMMIT
[0m22:17:07.848120 [debug] [Thread-1 (]: Finished running node seed.dbt_test.customers
[0m22:17:07.845834 [error] [Thread-2 (]: 2 of 3 ERROR loading seed file raw.orders ...................................... [[31mERROR[0m in 0.07s]
[0m22:17:07.848365 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_test.payments"
[0m22:17:07.848639 [debug] [Thread-7 (]: Marking all children of 'seed.dbt_test.customers' to be skipped because of status 'error'.  Reason: Database Error in seed customers (seeds/customers.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "orders" references "customers".
  HINT:  Truncate table "orders" at the same time, or use TRUNCATE ... CASCADE..
[0m22:17:07.848923 [debug] [Thread-2 (]: Finished running node seed.dbt_test.orders
[0m22:17:07.849117 [debug] [Thread-3 (]: On seed.dbt_test.payments: COMMIT
[0m22:17:07.849700 [debug] [Thread-7 (]: Marking all children of 'seed.dbt_test.orders' to be skipped because of status 'error'.  Reason: Database Error in seed orders (seeds/orders.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "payments" references "orders".
  HINT:  Truncate table "payments" at the same time, or use TRUNCATE ... CASCADE..
[0m22:17:07.852600 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m22:17:07.853510 [debug] [Thread-3 (]: On seed.dbt_test.payments: Close
[0m22:17:07.853795 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9a5c773-378c-4d89-a875-2b68e660d917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a84f430>]}
[0m22:17:07.854049 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file raw.payments ........................................ [[32mINSERT 5[0m in 0.08s]
[0m22:17:07.854305 [debug] [Thread-3 (]: Finished running node seed.dbt_test.payments
[0m22:17:07.854912 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:07.855057 [debug] [MainThread]: On master: BEGIN
[0m22:17:07.855191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:17:07.866231 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m22:17:07.866438 [debug] [MainThread]: On master: COMMIT
[0m22:17:07.866584 [debug] [MainThread]: Using postgres connection "master"
[0m22:17:07.866717 [debug] [MainThread]: On master: COMMIT
[0m22:17:07.867234 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:17:07.867384 [debug] [MainThread]: On master: Close
[0m22:17:07.867592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:07.867723 [debug] [MainThread]: Connection 'seed.dbt_test.customers' was properly closed.
[0m22:17:07.867844 [debug] [MainThread]: Connection 'seed.dbt_test.orders' was properly closed.
[0m22:17:07.867958 [debug] [MainThread]: Connection 'seed.dbt_test.payments' was properly closed.
[0m22:17:07.868072 [debug] [MainThread]: Connection 'list_dbt_test_intermediate' was properly closed.
[0m22:17:07.868217 [info ] [MainThread]: 
[0m22:17:07.868405 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m22:17:07.868972 [debug] [MainThread]: Command end result
[0m22:17:07.883086 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m22:17:07.884222 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m22:17:07.887971 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m22:17:07.888147 [info ] [MainThread]: 
[0m22:17:07.888339 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:17:07.888488 [info ] [MainThread]: 
[0m22:17:07.888670 [error] [MainThread]: [31mFailure in seed customers (seeds/customers.csv)[0m
[0m22:17:07.888839 [error] [MainThread]:   Database Error in seed customers (seeds/customers.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "orders" references "customers".
  HINT:  Truncate table "orders" at the same time, or use TRUNCATE ... CASCADE.
[0m22:17:07.888978 [info ] [MainThread]: 
[0m22:17:07.889135 [error] [MainThread]: [31mFailure in seed orders (seeds/orders.csv)[0m
[0m22:17:07.889291 [error] [MainThread]:   Database Error in seed orders (seeds/orders.csv)
  cannot truncate a table referenced in a foreign key constraint
  DETAIL:  Table "payments" references "orders".
  HINT:  Truncate table "payments" at the same time, or use TRUNCATE ... CASCADE.
[0m22:17:07.889423 [info ] [MainThread]: 
[0m22:17:07.889577 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=3
[0m22:17:07.891214 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.7964738, "process_in_blocks": "0", "process_kernel_time": 0.192646, "process_mem_max_rss": "132431872", "process_out_blocks": "0", "process_user_time": 1.187137}
[0m22:17:07.891419 [debug] [MainThread]: Command `dbt seed` failed at 22:17:07.891382 after 0.80 seconds
[0m22:17:07.891607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061eb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052347c0>]}
[0m22:17:07.891781 [debug] [MainThread]: Flushing usage events
[0m22:17:08.392474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:04.747522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e18590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d4b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d4bb10>]}


============================== 22:18:04.750962 | fed6567b-c8d0-4e7d-bab8-13ee504db4db ==============================
[0m22:18:04.750962 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:18:04.751320 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'target_path': 'None', 'invocation_command': 'dbt seed', 'fail_fast': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'quiet': 'False', 'empty': 'None', 'introspect': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '/Users/adil/.dbt', 'log_cache_events': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_format': 'default', 'debug': 'False'}
[0m22:18:04.855132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed6567b-c8d0-4e7d-bab8-13ee504db4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213c49d0>]}
[0m22:18:04.885362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fed6567b-c8d0-4e7d-bab8-13ee504db4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122af3790>]}
[0m22:18:04.886165 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:18:04.939667 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m22:18:05.027229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:05.027494 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:05.055314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fed6567b-c8d0-4e7d-bab8-13ee504db4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c8c750>]}
[0m22:18:05.104948 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m22:18:05.106490 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m22:18:05.120825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fed6567b-c8d0-4e7d-bab8-13ee504db4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c6f2f0>]}
[0m22:18:05.121096 [info ] [MainThread]: Found 6 models, 3 seeds, 16 data tests, 3 sources, 460 macros
[0m22:18:05.121311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed6567b-c8d0-4e7d-bab8-13ee504db4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e1c3d0>]}
[0m22:18:05.122397 [info ] [MainThread]: 
[0m22:18:05.122592 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:18:05.122740 [info ] [MainThread]: 
[0m22:18:05.122991 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:18:05.124898 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m22:18:05.166028 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m22:18:05.166282 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m22:18:05.166446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:05.211300 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.045 seconds
[0m22:18:05.212131 [debug] [ThreadPool]: On list_dbt_test: Close
[0m22:18:05.212602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now create_dbt_test_raw)
[0m22:18:05.212890 [debug] [ThreadPool]: Creating schema "database: "dbt_test"
schema: "raw"
"
[0m22:18:05.215526 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_raw"
[0m22:18:05.215712 [debug] [ThreadPool]: On create_dbt_test_raw: BEGIN
[0m22:18:05.215853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:05.227097 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m22:18:05.227305 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_raw"
[0m22:18:05.227457 [debug] [ThreadPool]: On create_dbt_test_raw: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "create_dbt_test_raw"} */
create schema if not exists "raw"
[0m22:18:05.228608 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m22:18:05.229165 [debug] [ThreadPool]: On create_dbt_test_raw: COMMIT
[0m22:18:05.229358 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_raw"
[0m22:18:05.229502 [debug] [ThreadPool]: On create_dbt_test_raw: COMMIT
[0m22:18:05.230320 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m22:18:05.230534 [debug] [ThreadPool]: On create_dbt_test_raw: Close
[0m22:18:05.231431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_test_raw, now list_dbt_test_marts)
[0m22:18:05.234282 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m22:18:05.234560 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_intermediate'
[0m22:18:05.234713 [debug] [ThreadPool]: On list_dbt_test_marts: BEGIN
[0m22:18:05.235259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_raw'
[0m22:18:05.235483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_staging'
[0m22:18:05.236296 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m22:18:05.236489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:05.237264 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_raw"
[0m22:18:05.238188 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m22:18:05.238347 [debug] [ThreadPool]: On list_dbt_test_intermediate: BEGIN
[0m22:18:05.238566 [debug] [ThreadPool]: On list_dbt_test_raw: BEGIN
[0m22:18:05.238719 [debug] [ThreadPool]: On list_dbt_test_staging: BEGIN
[0m22:18:05.238884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:05.239058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:05.239202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:05.257490 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m22:18:05.257823 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m22:18:05.258022 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m22:18:05.258213 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_raw"
[0m22:18:05.258387 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m22:18:05.258564 [debug] [ThreadPool]: On list_dbt_test_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m22:18:05.258726 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m22:18:05.258925 [debug] [ThreadPool]: On list_dbt_test_raw: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_raw"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m22:18:05.259126 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m22:18:05.259434 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m22:18:05.259809 [debug] [ThreadPool]: On list_dbt_test_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m22:18:05.260039 [debug] [ThreadPool]: On list_dbt_test_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intermediate'
  
[0m22:18:05.263934 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m22:18:05.264138 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m22:18:05.264854 [debug] [ThreadPool]: On list_dbt_test_intermediate: ROLLBACK
[0m22:18:05.265520 [debug] [ThreadPool]: On list_dbt_test_marts: ROLLBACK
[0m22:18:05.265704 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m22:18:05.266364 [debug] [ThreadPool]: On list_dbt_test_staging: ROLLBACK
[0m22:18:05.266544 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m22:18:05.267130 [debug] [ThreadPool]: On list_dbt_test_raw: ROLLBACK
[0m22:18:05.267386 [debug] [ThreadPool]: On list_dbt_test_staging: Close
[0m22:18:05.267552 [debug] [ThreadPool]: On list_dbt_test_marts: Close
[0m22:18:05.267690 [debug] [ThreadPool]: On list_dbt_test_intermediate: Close
[0m22:18:05.268490 [debug] [ThreadPool]: On list_dbt_test_raw: Close
[0m22:18:05.271231 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:05.271469 [debug] [MainThread]: On master: BEGIN
[0m22:18:05.271637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:05.283647 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:18:05.283882 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:05.284082 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:18:05.287770 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m22:18:05.288450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed6567b-c8d0-4e7d-bab8-13ee504db4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1240ee5b0>]}
[0m22:18:05.288699 [debug] [MainThread]: On master: ROLLBACK
[0m22:18:05.289177 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:05.289357 [debug] [MainThread]: On master: BEGIN
[0m22:18:05.290009 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:18:05.290158 [debug] [MainThread]: On master: COMMIT
[0m22:18:05.290296 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:05.290422 [debug] [MainThread]: On master: COMMIT
[0m22:18:05.290807 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:18:05.290967 [debug] [MainThread]: On master: Close
[0m22:18:05.292466 [debug] [Thread-3 (]: Began running node seed.dbt_test.payments
[0m22:18:05.292658 [debug] [Thread-1 (]: Began running node seed.dbt_test.customers
[0m22:18:05.292822 [debug] [Thread-2 (]: Began running node seed.dbt_test.orders
[0m22:18:05.293068 [info ] [Thread-3 (]: 3 of 3 START seed file raw.payments ............................................ [RUN]
[0m22:18:05.293292 [info ] [Thread-1 (]: 1 of 3 START seed file raw.customers ........................................... [RUN]
[0m22:18:05.293773 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_raw, now seed.dbt_test.payments)
[0m22:18:05.293508 [info ] [Thread-2 (]: 2 of 3 START seed file raw.orders .............................................. [RUN]
[0m22:18:05.294018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_marts, now seed.dbt_test.customers)
[0m22:18:05.294200 [debug] [Thread-3 (]: Began compiling node seed.dbt_test.payments
[0m22:18:05.294380 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_intermediate, now seed.dbt_test.orders)
[0m22:18:05.294544 [debug] [Thread-1 (]: Began compiling node seed.dbt_test.customers
[0m22:18:05.294727 [debug] [Thread-3 (]: Began executing node seed.dbt_test.payments
[0m22:18:05.294887 [debug] [Thread-2 (]: Began compiling node seed.dbt_test.orders
[0m22:18:05.295055 [debug] [Thread-1 (]: Began executing node seed.dbt_test.customers
[0m22:18:05.305585 [debug] [Thread-2 (]: Began executing node seed.dbt_test.orders
[0m22:18:05.349340 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_test.customers"
[0m22:18:05.349904 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_test.payments"
[0m22:18:05.350111 [debug] [Thread-1 (]: On seed.dbt_test.customers: BEGIN
[0m22:18:05.350355 [debug] [Thread-3 (]: On seed.dbt_test.payments: BEGIN
[0m22:18:05.351008 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_test.orders"
[0m22:18:05.351195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:05.351377 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:18:05.351547 [debug] [Thread-2 (]: On seed.dbt_test.orders: BEGIN
[0m22:18:05.351858 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:18:05.366577 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m22:18:05.366830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m22:18:05.367034 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_test.orders"
[0m22:18:05.367205 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m22:18:05.367381 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_test.customers"
[0m22:18:05.367558 [debug] [Thread-2 (]: On seed.dbt_test.orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "seed.dbt_test.orders"} */

    create table "dbt_test"."raw"."orders" ("id" integer,"user_id" integer,"order_date" timestamp without time zone,"status" text,"total_amount" integer)
  
[0m22:18:05.367736 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_test.payments"
[0m22:18:05.367906 [debug] [Thread-1 (]: On seed.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "seed.dbt_test.customers"} */

    create table "dbt_test"."raw"."customers" ("id" integer,"first_name" text,"last_name" text,"email" text,"created_at" timestamp without time zone)
  
[0m22:18:05.368121 [debug] [Thread-3 (]: On seed.dbt_test.payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "seed.dbt_test.payments"} */

    create table "dbt_test"."raw"."payments" ("id" integer,"order_id" integer,"payment_method" text,"amount" integer,"paid_at" timestamp without time zone)
  
[0m22:18:05.374329 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.006 seconds
[0m22:18:05.379929 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.012 seconds
[0m22:18:05.383079 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_test.orders"
[0m22:18:05.383280 [debug] [Thread-3 (]: SQL status: CREATE TABLE in 0.015 seconds
[0m22:18:05.384790 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_test.customers"
[0m22:18:05.385029 [debug] [Thread-2 (]: On seed.dbt_test.orders: 
          insert into "dbt_test"."raw"."orders" ("id", "user_id", "order_date", "status", "total_amount") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m22:18:05.386278 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_test.payments"
[0m22:18:05.386479 [debug] [Thread-1 (]: On seed.dbt_test.customers: 
          insert into "dbt_test"."raw"."customers" ("id", "first_name", "last_name", "email", "created_at") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m22:18:05.386750 [debug] [Thread-3 (]: On seed.dbt_test.payments: 
          insert into "dbt_test"."raw"."payments" ("id", "order_id", "payment_method", "amount", "paid_at") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m22:18:05.387896 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.001 seconds
[0m22:18:05.388086 [debug] [Thread-3 (]: SQL status: INSERT 0 5 in 0.001 seconds
[0m22:18:05.388262 [debug] [Thread-2 (]: SQL status: INSERT 0 5 in 0.002 seconds
[0m22:18:05.391529 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_test.customers"
[0m22:18:05.391855 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_test.payments"
[0m22:18:05.392134 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_test.orders"
[0m22:18:05.402252 [debug] [Thread-3 (]: On seed.dbt_test.payments: COMMIT
[0m22:18:05.402472 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_test.payments"
[0m22:18:05.403607 [debug] [Thread-1 (]: On seed.dbt_test.customers: COMMIT
[0m22:18:05.404317 [debug] [Thread-2 (]: On seed.dbt_test.orders: COMMIT
[0m22:18:05.404491 [debug] [Thread-3 (]: On seed.dbt_test.payments: COMMIT
[0m22:18:05.404674 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_test.customers"
[0m22:18:05.404878 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_test.orders"
[0m22:18:05.405108 [debug] [Thread-1 (]: On seed.dbt_test.customers: COMMIT
[0m22:18:05.405271 [debug] [Thread-2 (]: On seed.dbt_test.orders: COMMIT
[0m22:18:05.406079 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:18:05.406993 [debug] [Thread-3 (]: On seed.dbt_test.payments: Close
[0m22:18:05.407188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:18:05.407360 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m22:18:05.407696 [debug] [Thread-1 (]: On seed.dbt_test.customers: Close
[0m22:18:05.408323 [debug] [Thread-2 (]: On seed.dbt_test.orders: Close
[0m22:18:05.409249 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed6567b-c8d0-4e7d-bab8-13ee504db4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123eabdd0>]}
[0m22:18:05.409527 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file raw.payments ........................................ [[32mINSERT 5[0m in 0.11s]
[0m22:18:05.409816 [debug] [Thread-3 (]: Finished running node seed.dbt_test.payments
[0m22:18:05.409989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed6567b-c8d0-4e7d-bab8-13ee504db4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ecbb70>]}
[0m22:18:05.410210 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file raw.customers ....................................... [[32mINSERT 5[0m in 0.11s]
[0m22:18:05.410403 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed6567b-c8d0-4e7d-bab8-13ee504db4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1241da710>]}
[0m22:18:05.410720 [debug] [Thread-1 (]: Finished running node seed.dbt_test.customers
[0m22:18:05.410966 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file raw.orders .......................................... [[32mINSERT 5[0m in 0.11s]
[0m22:18:05.411354 [debug] [Thread-2 (]: Finished running node seed.dbt_test.orders
[0m22:18:05.412184 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:05.412334 [debug] [MainThread]: On master: BEGIN
[0m22:18:05.412465 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:18:05.424374 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:18:05.424631 [debug] [MainThread]: On master: COMMIT
[0m22:18:05.424802 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:05.424940 [debug] [MainThread]: On master: COMMIT
[0m22:18:05.425459 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:18:05.425607 [debug] [MainThread]: On master: Close
[0m22:18:05.425823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:05.425953 [debug] [MainThread]: Connection 'seed.dbt_test.customers' was properly closed.
[0m22:18:05.426074 [debug] [MainThread]: Connection 'seed.dbt_test.orders' was properly closed.
[0m22:18:05.426188 [debug] [MainThread]: Connection 'seed.dbt_test.payments' was properly closed.
[0m22:18:05.426303 [debug] [MainThread]: Connection 'list_dbt_test_staging' was properly closed.
[0m22:18:05.426457 [info ] [MainThread]: 
[0m22:18:05.426658 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m22:18:05.427152 [debug] [MainThread]: Command end result
[0m22:18:05.441113 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m22:18:05.442483 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m22:18:05.445889 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m22:18:05.446079 [info ] [MainThread]: 
[0m22:18:05.446281 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:18:05.446432 [info ] [MainThread]: 
[0m22:18:05.446593 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m22:18:05.448284 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.74219304, "process_in_blocks": "0", "process_kernel_time": 0.191618, "process_mem_max_rss": "129384448", "process_out_blocks": "0", "process_user_time": 1.185074}
[0m22:18:05.448515 [debug] [MainThread]: Command `dbt seed` succeeded at 22:18:05.448473 after 0.74 seconds
[0m22:18:05.448705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123d4d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235593d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122dc87c0>]}
[0m22:18:05.448891 [debug] [MainThread]: Flushing usage events
[0m22:18:05.886690 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:13.241122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b60590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498fb10>]}


============================== 22:18:13.243786 | 279f767d-343b-44a6-a42a-630e28edb39c ==============================
[0m22:18:13.243786 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:18:13.244100 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt seed', 'empty': 'None', 'target_path': 'None', 'use_colors': 'True', 'introspect': 'True', 'no_print': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/adil/.dbt', 'fail_fast': 'False', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs'}
[0m22:18:13.324773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '279f767d-343b-44a6-a42a-630e28edb39c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d0c9d0>]}
[0m22:18:13.352104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '279f767d-343b-44a6-a42a-630e28edb39c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483b790>]}
[0m22:18:13.352678 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:18:13.399426 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m22:18:13.479376 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:13.479578 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:13.505526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '279f767d-343b-44a6-a42a-630e28edb39c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d4750>]}
[0m22:18:13.551033 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m22:18:13.551954 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m22:18:13.563775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '279f767d-343b-44a6-a42a-630e28edb39c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058b72f0>]}
[0m22:18:13.564005 [info ] [MainThread]: Found 6 models, 3 seeds, 16 data tests, 3 sources, 460 macros
[0m22:18:13.564178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '279f767d-343b-44a6-a42a-630e28edb39c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a643d0>]}
[0m22:18:13.565143 [info ] [MainThread]: 
[0m22:18:13.565323 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:18:13.565459 [info ] [MainThread]: 
[0m22:18:13.565691 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:18:13.567401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m22:18:13.592117 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m22:18:13.592371 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m22:18:13.592532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:13.625819 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.033 seconds
[0m22:18:13.626627 [debug] [ThreadPool]: On list_dbt_test: Close
[0m22:18:13.627576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_raw)
[0m22:18:13.627826 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_staging'
[0m22:18:13.630779 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_raw"
[0m22:18:13.631150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_marts'
[0m22:18:13.632081 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m22:18:13.632341 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_intermediate'
[0m22:18:13.632795 [debug] [ThreadPool]: On list_dbt_test_raw: BEGIN
[0m22:18:13.633643 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m22:18:13.633804 [debug] [ThreadPool]: On list_dbt_test_staging: BEGIN
[0m22:18:13.634678 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m22:18:13.634884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:13.635081 [debug] [ThreadPool]: On list_dbt_test_marts: BEGIN
[0m22:18:13.635233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:13.635394 [debug] [ThreadPool]: On list_dbt_test_intermediate: BEGIN
[0m22:18:13.635603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:13.635823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:13.651526 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m22:18:13.651725 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m22:18:13.651894 [debug] [ThreadPool]: On list_dbt_test_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m22:18:13.652084 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m22:18:13.652286 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m22:18:13.652496 [debug] [ThreadPool]: On list_dbt_test_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intermediate'
  
[0m22:18:13.652967 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m22:18:13.653117 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_raw"
[0m22:18:13.653270 [debug] [ThreadPool]: On list_dbt_test_raw: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_raw"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m22:18:13.653616 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m22:18:13.653793 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m22:18:13.654018 [debug] [ThreadPool]: On list_dbt_test_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m22:18:13.657441 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m22:18:13.657596 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m22:18:13.658274 [debug] [ThreadPool]: On list_dbt_test_intermediate: ROLLBACK
[0m22:18:13.658881 [debug] [ThreadPool]: On list_dbt_test_marts: ROLLBACK
[0m22:18:13.659040 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m22:18:13.659173 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m22:18:13.659832 [debug] [ThreadPool]: On list_dbt_test_raw: ROLLBACK
[0m22:18:13.660377 [debug] [ThreadPool]: On list_dbt_test_staging: ROLLBACK
[0m22:18:13.660523 [debug] [ThreadPool]: On list_dbt_test_marts: Close
[0m22:18:13.660673 [debug] [ThreadPool]: On list_dbt_test_intermediate: Close
[0m22:18:13.661260 [debug] [ThreadPool]: On list_dbt_test_staging: Close
[0m22:18:13.661413 [debug] [ThreadPool]: On list_dbt_test_raw: Close
[0m22:18:13.666438 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:13.666656 [debug] [MainThread]: On master: BEGIN
[0m22:18:13.666813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:13.678011 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m22:18:13.678189 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:13.678360 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:18:13.682124 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m22:18:13.683118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '279f767d-343b-44a6-a42a-630e28edb39c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d35b20>]}
[0m22:18:13.683346 [debug] [MainThread]: On master: ROLLBACK
[0m22:18:13.683909 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:13.684064 [debug] [MainThread]: On master: BEGIN
[0m22:18:13.684889 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:18:13.685032 [debug] [MainThread]: On master: COMMIT
[0m22:18:13.685162 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:13.685281 [debug] [MainThread]: On master: COMMIT
[0m22:18:13.685708 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:18:13.685856 [debug] [MainThread]: On master: Close
[0m22:18:13.687304 [debug] [Thread-3 (]: Began running node seed.dbt_test.payments
[0m22:18:13.687492 [debug] [Thread-1 (]: Began running node seed.dbt_test.customers
[0m22:18:13.687656 [debug] [Thread-2 (]: Began running node seed.dbt_test.orders
[0m22:18:13.687916 [info ] [Thread-3 (]: 3 of 3 START seed file raw.payments ............................................ [RUN]
[0m22:18:13.688140 [info ] [Thread-1 (]: 1 of 3 START seed file raw.customers ........................................... [RUN]
[0m22:18:13.688588 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_marts, now seed.dbt_test.payments)
[0m22:18:13.688371 [info ] [Thread-2 (]: 2 of 3 START seed file raw.orders .............................................. [RUN]
[0m22:18:13.688800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_raw, now seed.dbt_test.customers)
[0m22:18:13.688973 [debug] [Thread-3 (]: Began compiling node seed.dbt_test.payments
[0m22:18:13.689141 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_staging, now seed.dbt_test.orders)
[0m22:18:13.689302 [debug] [Thread-1 (]: Began compiling node seed.dbt_test.customers
[0m22:18:13.689476 [debug] [Thread-3 (]: Began executing node seed.dbt_test.payments
[0m22:18:13.689636 [debug] [Thread-2 (]: Began compiling node seed.dbt_test.orders
[0m22:18:13.689798 [debug] [Thread-1 (]: Began executing node seed.dbt_test.customers
[0m22:18:13.697985 [debug] [Thread-2 (]: Began executing node seed.dbt_test.orders
[0m22:18:13.709337 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_test.payments"
[0m22:18:13.709932 [debug] [Thread-3 (]: On seed.dbt_test.payments: BEGIN
[0m22:18:13.710145 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:18:13.740654 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_test.customers"
[0m22:18:13.741201 [debug] [Thread-1 (]: On seed.dbt_test.customers: BEGIN
[0m22:18:13.742214 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_test.orders"
[0m22:18:13.742423 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m22:18:13.742601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:13.742812 [debug] [Thread-2 (]: On seed.dbt_test.orders: BEGIN
[0m22:18:13.743007 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_test.payments"
[0m22:18:13.743256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:18:13.743464 [debug] [Thread-3 (]: On seed.dbt_test.payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "seed.dbt_test.payments"} */
truncate table "dbt_test"."raw"."payments"
[0m22:18:13.747533 [debug] [Thread-3 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m22:18:13.756145 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_test.payments"
[0m22:18:13.756371 [debug] [Thread-3 (]: On seed.dbt_test.payments: 
          insert into "dbt_test"."raw"."payments" ("id", "order_id", "payment_method", "amount", "paid_at") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m22:18:13.757977 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m22:18:13.758189 [debug] [Thread-3 (]: SQL status: INSERT 0 5 in 0.002 seconds
[0m22:18:13.758346 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_test.orders"
[0m22:18:13.758499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m22:18:13.761180 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_test.payments"
[0m22:18:13.761374 [debug] [Thread-2 (]: On seed.dbt_test.orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "seed.dbt_test.orders"} */
truncate table "dbt_test"."raw"."orders"
[0m22:18:13.761547 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_test.customers"
[0m22:18:13.761821 [debug] [Thread-1 (]: On seed.dbt_test.customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "seed.dbt_test.customers"} */
truncate table "dbt_test"."raw"."customers"
[0m22:18:13.769444 [debug] [Thread-3 (]: On seed.dbt_test.payments: COMMIT
[0m22:18:13.769664 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.008 seconds
[0m22:18:13.769848 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.008 seconds
[0m22:18:13.770031 [debug] [Thread-3 (]: Using postgres connection "seed.dbt_test.payments"
[0m22:18:13.771516 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_test.customers"
[0m22:18:13.772762 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_test.orders"
[0m22:18:13.772933 [debug] [Thread-3 (]: On seed.dbt_test.payments: COMMIT
[0m22:18:13.773116 [debug] [Thread-1 (]: On seed.dbt_test.customers: 
          insert into "dbt_test"."raw"."customers" ("id", "first_name", "last_name", "email", "created_at") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m22:18:13.773301 [debug] [Thread-2 (]: On seed.dbt_test.orders: 
          insert into "dbt_test"."raw"."orders" ("id", "user_id", "order_date", "status", "total_amount") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
[0m22:18:13.774498 [debug] [Thread-2 (]: SQL status: INSERT 0 5 in 0.001 seconds
[0m22:18:13.774706 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.001 seconds
[0m22:18:13.775054 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_test.orders"
[0m22:18:13.775259 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m22:18:13.775542 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_test.customers"
[0m22:18:13.776531 [debug] [Thread-3 (]: On seed.dbt_test.payments: Close
[0m22:18:13.777992 [debug] [Thread-2 (]: On seed.dbt_test.orders: COMMIT
[0m22:18:13.778603 [debug] [Thread-1 (]: On seed.dbt_test.customers: COMMIT
[0m22:18:13.778806 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_test.orders"
[0m22:18:13.778986 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_test.customers"
[0m22:18:13.779174 [debug] [Thread-2 (]: On seed.dbt_test.orders: COMMIT
[0m22:18:13.779336 [debug] [Thread-1 (]: On seed.dbt_test.customers: COMMIT
[0m22:18:13.779504 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '279f767d-343b-44a6-a42a-630e28edb39c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105acba10>]}
[0m22:18:13.779791 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file raw.payments ........................................ [[32mINSERT 5[0m in 0.09s]
[0m22:18:13.780068 [debug] [Thread-3 (]: Finished running node seed.dbt_test.payments
[0m22:18:13.780734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:18:13.781091 [debug] [Thread-1 (]: On seed.dbt_test.customers: Close
[0m22:18:13.781264 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m22:18:13.781586 [debug] [Thread-2 (]: On seed.dbt_test.orders: Close
[0m22:18:13.781830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '279f767d-343b-44a6-a42a-630e28edb39c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b13e30>]}
[0m22:18:13.782119 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '279f767d-343b-44a6-a42a-630e28edb39c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f589b0>]}
[0m22:18:13.782322 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file raw.customers ....................................... [[32mINSERT 5[0m in 0.09s]
[0m22:18:13.782772 [debug] [Thread-1 (]: Finished running node seed.dbt_test.customers
[0m22:18:13.782515 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file raw.orders .......................................... [[32mINSERT 5[0m in 0.09s]
[0m22:18:13.783087 [debug] [Thread-2 (]: Finished running node seed.dbt_test.orders
[0m22:18:13.783642 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:13.783780 [debug] [MainThread]: On master: BEGIN
[0m22:18:13.783908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:18:13.794786 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m22:18:13.795012 [debug] [MainThread]: On master: COMMIT
[0m22:18:13.795153 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:13.795285 [debug] [MainThread]: On master: COMMIT
[0m22:18:13.795737 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:18:13.795915 [debug] [MainThread]: On master: Close
[0m22:18:13.796143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:13.796305 [debug] [MainThread]: Connection 'seed.dbt_test.customers' was properly closed.
[0m22:18:13.796424 [debug] [MainThread]: Connection 'seed.dbt_test.orders' was properly closed.
[0m22:18:13.796537 [debug] [MainThread]: Connection 'seed.dbt_test.payments' was properly closed.
[0m22:18:13.796645 [debug] [MainThread]: Connection 'list_dbt_test_intermediate' was properly closed.
[0m22:18:13.796792 [info ] [MainThread]: 
[0m22:18:13.796942 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m22:18:13.797367 [debug] [MainThread]: Command end result
[0m22:18:13.810555 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m22:18:13.811966 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m22:18:13.815150 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m22:18:13.815313 [info ] [MainThread]: 
[0m22:18:13.815501 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:18:13.815643 [info ] [MainThread]: 
[0m22:18:13.815797 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m22:18:13.817391 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.6114392, "process_in_blocks": "0", "process_kernel_time": 0.142703, "process_mem_max_rss": "129105920", "process_out_blocks": "0", "process_user_time": 1.071551}
[0m22:18:13.817596 [debug] [MainThread]: Command `dbt seed` succeeded at 22:18:13.817559 after 0.61 seconds
[0m22:18:13.817753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059998d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d56dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a147c0>]}
[0m22:18:13.817913 [debug] [MainThread]: Flushing usage events
[0m22:18:14.184433 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:24.113778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108218590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d4b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d4bb10>]}


============================== 22:18:24.116768 | 9db8c65a-8e8a-46ea-8d3e-9faf8701b2f8 ==============================
[0m22:18:24.116768 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:18:24.117098 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'printer_width': '80', 'empty': 'False', 'static_parser': 'True', 'version_check': 'True', 'log_path': '/Users/adil/repos/airflow-test/dbt_test/logs', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/adil/.dbt', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'no_print': 'None', 'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'quiet': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m22:18:24.217223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9db8c65a-8e8a-46ea-8d3e-9faf8701b2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c49d0>]}
[0m22:18:24.247788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9db8c65a-8e8a-46ea-8d3e-9faf8701b2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109af3790>]}
[0m22:18:24.248539 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:18:24.301183 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m22:18:24.384912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:24.385160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:24.414759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9db8c65a-8e8a-46ea-8d3e-9faf8701b2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae58750>]}
[0m22:18:24.462748 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m22:18:24.464081 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m22:18:24.476246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9db8c65a-8e8a-46ea-8d3e-9faf8701b2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d72f30>]}
[0m22:18:24.476483 [info ] [MainThread]: Found 6 models, 3 seeds, 16 data tests, 3 sources, 460 macros
[0m22:18:24.476656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db8c65a-8e8a-46ea-8d3e-9faf8701b2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9ecf0>]}
[0m22:18:24.477704 [info ] [MainThread]: 
[0m22:18:24.477904 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:18:24.478043 [info ] [MainThread]: 
[0m22:18:24.478291 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:18:24.480128 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m22:18:24.485935 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m22:18:24.487133 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test'
[0m22:18:24.507246 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m22:18:24.507454 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m22:18:24.507634 [debug] [ThreadPool]: Using postgres connection "list_dbt_test"
[0m22:18:24.507791 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m22:18:24.507949 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m22:18:24.508099 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test"} */

    select distinct nspname from pg_namespace
  
[0m22:18:24.508245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:24.508380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:24.508507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:24.561082 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.053 seconds
[0m22:18:24.561341 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.053 seconds
[0m22:18:24.562093 [debug] [ThreadPool]: On list_dbt_test: Close
[0m22:18:24.562282 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.054 seconds
[0m22:18:24.562844 [debug] [ThreadPool]: On list_dbt_test: Close
[0m22:18:24.563469 [debug] [ThreadPool]: On list_dbt_test: Close
[0m22:18:24.563953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now create_dbt_test_staging)
[0m22:18:24.564181 [debug] [ThreadPool]: Creating schema "database: "dbt_test"
schema: "staging"
"
[0m22:18:24.566757 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_staging"
[0m22:18:24.566937 [debug] [ThreadPool]: On create_dbt_test_staging: BEGIN
[0m22:18:24.567073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:24.582593 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m22:18:24.582794 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_staging"
[0m22:18:24.582937 [debug] [ThreadPool]: On create_dbt_test_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "create_dbt_test_staging"} */
create schema if not exists "staging"
[0m22:18:24.583945 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m22:18:24.584466 [debug] [ThreadPool]: On create_dbt_test_staging: COMMIT
[0m22:18:24.584623 [debug] [ThreadPool]: Using postgres connection "create_dbt_test_staging"
[0m22:18:24.584754 [debug] [ThreadPool]: On create_dbt_test_staging: COMMIT
[0m22:18:24.585564 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m22:18:24.585706 [debug] [ThreadPool]: On create_dbt_test_staging: Close
[0m22:18:24.586726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_staging)
[0m22:18:24.586998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_raw)
[0m22:18:24.589825 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m22:18:24.590080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_test_staging, now list_dbt_test_intermediate)
[0m22:18:24.591255 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_raw"
[0m22:18:24.591506 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_test_marts'
[0m22:18:24.591652 [debug] [ThreadPool]: On list_dbt_test_staging: BEGIN
[0m22:18:24.592437 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m22:18:24.592597 [debug] [ThreadPool]: On list_dbt_test_raw: BEGIN
[0m22:18:24.595007 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m22:18:24.595166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:24.595326 [debug] [ThreadPool]: On list_dbt_test_intermediate: BEGIN
[0m22:18:24.595475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:24.595618 [debug] [ThreadPool]: On list_dbt_test_marts: BEGIN
[0m22:18:24.595804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:24.595974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:24.610563 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m22:18:24.610796 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_staging"
[0m22:18:24.610970 [debug] [ThreadPool]: On list_dbt_test_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_staging"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m22:18:24.611449 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m22:18:24.611590 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_marts"
[0m22:18:24.611743 [debug] [ThreadPool]: On list_dbt_test_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_marts"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'
  
[0m22:18:24.612566 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m22:18:24.612750 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_intermediate"
[0m22:18:24.612915 [debug] [ThreadPool]: On list_dbt_test_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_intermediate"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intermediate'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intermediate'
  
[0m22:18:24.613453 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m22:18:24.613629 [debug] [ThreadPool]: Using postgres connection "list_dbt_test_raw"
[0m22:18:24.613794 [debug] [ThreadPool]: On list_dbt_test_raw: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "list_dbt_test_raw"} */
select
      'dbt_test' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'dbt_test' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'dbt_test' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m22:18:24.615002 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m22:18:24.615829 [debug] [ThreadPool]: On list_dbt_test_staging: ROLLBACK
[0m22:18:24.616434 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m22:18:24.617020 [debug] [ThreadPool]: On list_dbt_test_intermediate: ROLLBACK
[0m22:18:24.617198 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m22:18:24.617786 [debug] [ThreadPool]: On list_dbt_test_raw: ROLLBACK
[0m22:18:24.617965 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m22:18:24.618128 [debug] [ThreadPool]: On list_dbt_test_staging: Close
[0m22:18:24.618265 [debug] [ThreadPool]: On list_dbt_test_intermediate: Close
[0m22:18:24.618909 [debug] [ThreadPool]: On list_dbt_test_marts: ROLLBACK
[0m22:18:24.619078 [debug] [ThreadPool]: On list_dbt_test_raw: Close
[0m22:18:24.621410 [debug] [ThreadPool]: On list_dbt_test_marts: Close
[0m22:18:24.624172 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:24.624347 [debug] [MainThread]: On master: BEGIN
[0m22:18:24.624486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:24.636378 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:18:24.636563 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:24.636749 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:18:24.640190 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m22:18:24.640859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db8c65a-8e8a-46ea-8d3e-9faf8701b2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2e68f0>]}
[0m22:18:24.641098 [debug] [MainThread]: On master: ROLLBACK
[0m22:18:24.641555 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:24.641690 [debug] [MainThread]: On master: BEGIN
[0m22:18:24.642345 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:18:24.642478 [debug] [MainThread]: On master: COMMIT
[0m22:18:24.642606 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:24.642727 [debug] [MainThread]: On master: COMMIT
[0m22:18:24.643131 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:18:24.643263 [debug] [MainThread]: On master: Close
[0m22:18:24.644795 [debug] [Thread-2 (]: Began running node model.dbt_test.stg_orders
[0m22:18:24.645011 [debug] [Thread-1 (]: Began running node model.dbt_test.stg_customers
[0m22:18:24.645200 [debug] [Thread-3 (]: Began running node model.dbt_test.stg_payments
[0m22:18:24.645487 [info ] [Thread-2 (]: 2 of 6 START sql view model staging.stg_orders ................................. [RUN]
[0m22:18:24.645726 [info ] [Thread-1 (]: 1 of 6 START sql view model staging.stg_customers .............................. [RUN]
[0m22:18:24.646167 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_dbt_test_raw, now model.dbt_test.stg_orders)
[0m22:18:24.645925 [info ] [Thread-3 (]: 3 of 6 START sql view model staging.stg_payments ............................... [RUN]
[0m22:18:24.646428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_staging, now model.dbt_test.stg_customers)
[0m22:18:24.646632 [debug] [Thread-2 (]: Began compiling node model.dbt_test.stg_orders
[0m22:18:24.646819 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_dbt_test_intermediate, now model.dbt_test.stg_payments)
[0m22:18:24.647000 [debug] [Thread-1 (]: Began compiling node model.dbt_test.stg_customers
[0m22:18:24.682369 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.stg_orders"
[0m22:18:24.682642 [debug] [Thread-3 (]: Began compiling node model.dbt_test.stg_payments
[0m22:18:24.683987 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_test.stg_customers"
[0m22:18:24.685426 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.stg_payments"
[0m22:18:24.685758 [debug] [Thread-2 (]: Began executing node model.dbt_test.stg_orders
[0m22:18:24.696873 [debug] [Thread-3 (]: Began executing node model.dbt_test.stg_payments
[0m22:18:24.702991 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.stg_orders"
[0m22:18:24.703182 [debug] [Thread-1 (]: Began executing node model.dbt_test.stg_customers
[0m22:18:24.704636 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.stg_payments"
[0m22:18:24.705967 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_test.stg_customers"
[0m22:18:24.706276 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m22:18:24.706471 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: BEGIN
[0m22:18:24.706633 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:18:24.706809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m22:18:24.707051 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: BEGIN
[0m22:18:24.707243 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m22:18:24.707404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:24.707573 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: BEGIN
[0m22:18:24.707776 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:18:24.719707 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m22:18:24.719918 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m22:18:24.720100 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m22:18:24.720273 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m22:18:24.720445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m22:18:24.720626 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */

  create view "dbt_test"."staging"."stg_orders__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."orders"
),
casted as (
    select
        id           as order_id,
        user_id      as customer_id,
        order_date::timestamp as order_timestamp,
        lower(status) as status,
        total_amount::numeric(10,2) as total_amount
    from source
)
select * from casted
  );
[0m22:18:24.720839 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m22:18:24.721052 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */

  create view "dbt_test"."staging"."stg_customers__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."customers"
),
renamed as (
    select
        id                as customer_id,
        lower(trim(first_name)) as first_name,
        lower(trim(last_name))  as last_name,
        lower(trim(email))      as email,
        created_at
    from source
)
select * from renamed
  );
[0m22:18:24.721285 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */

  create view "dbt_test"."staging"."stg_payments__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "dbt_test"."raw"."payments"
),
casted as (
    select
        id           as payment_id,
        order_id,
        lower(payment_method) as payment_method,
        amount::numeric(10,2) as amount,
        paid_at::timestamp    as paid_at
    from source
)
select * from casted
  );
[0m22:18:24.724375 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:18:24.724568 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:18:24.727735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m22:18:24.727938 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:18:24.729206 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m22:18:24.729385 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
alter table "dbt_test"."staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:18:24.730543 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m22:18:24.730715 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
alter table "dbt_test"."staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:18:24.730906 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
alter table "dbt_test"."staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m22:18:24.731392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:18:24.736797 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:18:24.736972 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:18:24.739611 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: COMMIT
[0m22:18:24.740183 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: COMMIT
[0m22:18:24.740733 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: COMMIT
[0m22:18:24.740929 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m22:18:24.741086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m22:18:24.741235 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m22:18:24.741383 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: COMMIT
[0m22:18:24.741545 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: COMMIT
[0m22:18:24.741693 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: COMMIT
[0m22:18:24.742814 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:18:24.743056 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:18:24.745824 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."staging"."stg_orders__dbt_backup"
[0m22:18:24.745999 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m22:18:24.747066 [debug] [Thread-1 (]: Applying DROP to: "dbt_test"."staging"."stg_customers__dbt_backup"
[0m22:18:24.749340 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.stg_orders"
[0m22:18:24.750251 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."staging"."stg_payments__dbt_backup"
[0m22:18:24.750500 [debug] [Thread-1 (]: Using postgres connection "model.dbt_test.stg_customers"
[0m22:18:24.750679 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_orders"} */
drop view if exists "dbt_test"."staging"."stg_orders__dbt_backup" cascade
[0m22:18:24.750919 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.stg_payments"
[0m22:18:24.751090 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_customers"} */
drop view if exists "dbt_test"."staging"."stg_customers__dbt_backup" cascade
[0m22:18:24.751275 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.stg_payments"} */
drop view if exists "dbt_test"."staging"."stg_payments__dbt_backup" cascade
[0m22:18:24.751701 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:18:24.751868 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:18:24.753030 [debug] [Thread-2 (]: On model.dbt_test.stg_orders: Close
[0m22:18:24.753202 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:18:24.753779 [debug] [Thread-1 (]: On model.dbt_test.stg_customers: Close
[0m22:18:24.754449 [debug] [Thread-3 (]: On model.dbt_test.stg_payments: Close
[0m22:18:24.755700 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db8c65a-8e8a-46ea-8d3e-9faf8701b2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4f0410>]}
[0m22:18:24.755964 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db8c65a-8e8a-46ea-8d3e-9faf8701b2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c108520>]}
[0m22:18:24.756260 [info ] [Thread-2 (]: 2 of 6 OK created sql view model staging.stg_orders ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m22:18:24.756565 [info ] [Thread-3 (]: 3 of 6 OK created sql view model staging.stg_payments .......................... [[32mCREATE VIEW[0m in 0.11s]
[0m22:18:24.756736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db8c65a-8e8a-46ea-8d3e-9faf8701b2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108348370>]}
[0m22:18:24.757015 [debug] [Thread-2 (]: Finished running node model.dbt_test.stg_orders
[0m22:18:24.757290 [debug] [Thread-3 (]: Finished running node model.dbt_test.stg_payments
[0m22:18:24.757566 [info ] [Thread-1 (]: 1 of 6 OK created sql view model staging.stg_customers ......................... [[32mCREATE VIEW[0m in 0.11s]
[0m22:18:24.758032 [debug] [Thread-1 (]: Finished running node model.dbt_test.stg_customers
[0m22:18:24.758271 [debug] [Thread-4 (]: Began running node model.dbt_test.int_order_payments
[0m22:18:24.758479 [info ] [Thread-4 (]: 4 of 6 START sql view model intermediate.int_order_payments .................... [RUN]
[0m22:18:24.758679 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_dbt_test_marts, now model.dbt_test.int_order_payments)
[0m22:18:24.758861 [debug] [Thread-4 (]: Began compiling node model.dbt_test.int_order_payments
[0m22:18:24.760395 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_test.int_order_payments"
[0m22:18:24.760587 [debug] [Thread-2 (]: Began running node model.dbt_test.dim_customers
[0m22:18:24.760823 [info ] [Thread-2 (]: 5 of 6 START sql table model marts.dim_customers ............................... [RUN]
[0m22:18:24.761018 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_test.stg_orders, now model.dbt_test.dim_customers)
[0m22:18:24.761239 [debug] [Thread-2 (]: Began compiling node model.dbt_test.dim_customers
[0m22:18:24.762889 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_test.dim_customers"
[0m22:18:24.763136 [debug] [Thread-4 (]: Began executing node model.dbt_test.int_order_payments
[0m22:18:24.764460 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_test.int_order_payments"
[0m22:18:24.764715 [debug] [Thread-2 (]: Began executing node model.dbt_test.dim_customers
[0m22:18:24.775880 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_test.dim_customers"
[0m22:18:24.776112 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m22:18:24.776313 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: BEGIN
[0m22:18:24.776507 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:18:24.776778 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m22:18:24.776940 [debug] [Thread-2 (]: On model.dbt_test.dim_customers: BEGIN
[0m22:18:24.777085 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:18:24.789070 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m22:18:24.789317 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m22:18:24.789494 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m22:18:24.789653 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m22:18:24.789836 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.int_order_payments"} */

  create view "dbt_test"."intermediate"."int_order_payments__dbt_tmp"
    
    
  as (
    

with payments as (
    select
        order_id,
        sum(amount) as total_paid,
        count(*)    as payment_count
    from "dbt_test"."staging"."stg_payments"
    group by 1
)

select
    o.order_id,
    o.customer_id,
    o.order_timestamp,
    o.status,
    o.total_amount,
    coalesce(p.total_paid, 0)   as total_paid,
    coalesce(p.payment_count, 0) as payment_count,
    (o.total_amount - coalesce(p.total_paid, 0)) as outstanding_amount
from "dbt_test"."staging"."stg_orders" o
left join payments p on o.order_id = p.order_id
  );
[0m22:18:24.790017 [debug] [Thread-2 (]: On model.dbt_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.dim_customers"} */

  
    

  create  table "dbt_test"."marts"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

select
    c.customer_id,
    initcap(c.first_name) as first_name,
    initcap(c.last_name)  as last_name,
    c.email,
    c.created_at
from "dbt_test"."staging"."stg_customers" c
  );
  
[0m22:18:24.794278 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:18:24.795819 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m22:18:24.796015 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.006 seconds
[0m22:18:24.796188 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.int_order_payments"} */
alter table "dbt_test"."intermediate"."int_order_payments__dbt_tmp" rename to "int_order_payments"
[0m22:18:24.799641 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m22:18:24.799889 [debug] [Thread-2 (]: On model.dbt_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.dim_customers"} */
alter table "dbt_test"."marts"."dim_customers" rename to "dim_customers__dbt_backup"
[0m22:18:24.800435 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:18:24.800620 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:18:24.801236 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: COMMIT
[0m22:18:24.802539 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m22:18:24.802738 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m22:18:24.802949 [debug] [Thread-2 (]: On model.dbt_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.dim_customers"} */
alter table "dbt_test"."marts"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m22:18:24.803169 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: COMMIT
[0m22:18:24.804350 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:18:24.806040 [debug] [Thread-2 (]: On model.dbt_test.dim_customers: COMMIT
[0m22:18:24.806238 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:18:24.806418 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m22:18:24.807568 [debug] [Thread-4 (]: Applying DROP to: "dbt_test"."intermediate"."int_order_payments__dbt_backup"
[0m22:18:24.807757 [debug] [Thread-2 (]: On model.dbt_test.dim_customers: COMMIT
[0m22:18:24.808014 [debug] [Thread-4 (]: Using postgres connection "model.dbt_test.int_order_payments"
[0m22:18:24.808249 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.int_order_payments"} */
drop view if exists "dbt_test"."intermediate"."int_order_payments__dbt_backup" cascade
[0m22:18:24.808752 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:18:24.808930 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:18:24.809593 [debug] [Thread-4 (]: On model.dbt_test.int_order_payments: Close
[0m22:18:24.810572 [debug] [Thread-2 (]: Applying DROP to: "dbt_test"."marts"."dim_customers__dbt_backup"
[0m22:18:24.810867 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db8c65a-8e8a-46ea-8d3e-9faf8701b2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3acc50>]}
[0m22:18:24.812182 [debug] [Thread-2 (]: Using postgres connection "model.dbt_test.dim_customers"
[0m22:18:24.812677 [debug] [Thread-2 (]: On model.dbt_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.dim_customers"} */
drop table if exists "dbt_test"."marts"."dim_customers__dbt_backup" cascade
[0m22:18:24.812513 [info ] [Thread-4 (]: 4 of 6 OK created sql view model intermediate.int_order_payments ............... [[32mCREATE VIEW[0m in 0.05s]
[0m22:18:24.813001 [debug] [Thread-4 (]: Finished running node model.dbt_test.int_order_payments
[0m22:18:24.813353 [debug] [Thread-3 (]: Began running node model.dbt_test.fct_orders
[0m22:18:24.813569 [info ] [Thread-3 (]: 6 of 6 START sql table model marts.fct_orders .................................. [RUN]
[0m22:18:24.813868 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_test.stg_payments, now model.dbt_test.fct_orders)
[0m22:18:24.814048 [debug] [Thread-3 (]: Began compiling node model.dbt_test.fct_orders
[0m22:18:24.815608 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_test.fct_orders"
[0m22:18:24.815816 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:18:24.816579 [debug] [Thread-2 (]: On model.dbt_test.dim_customers: Close
[0m22:18:24.816877 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db8c65a-8e8a-46ea-8d3e-9faf8701b2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4ffaf0>]}
[0m22:18:24.817177 [info ] [Thread-2 (]: 5 of 6 OK created sql table model marts.dim_customers .......................... [[32mSELECT 5[0m in 0.06s]
[0m22:18:24.817495 [debug] [Thread-2 (]: Finished running node model.dbt_test.dim_customers
[0m22:18:24.817673 [debug] [Thread-3 (]: Began executing node model.dbt_test.fct_orders
[0m22:18:24.819567 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_test.fct_orders"
[0m22:18:24.820056 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m22:18:24.820265 [debug] [Thread-3 (]: On model.dbt_test.fct_orders: BEGIN
[0m22:18:24.820431 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:18:24.832756 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m22:18:24.833001 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m22:18:24.833173 [debug] [Thread-3 (]: On model.dbt_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.fct_orders"} */

  
    

  create  table "dbt_test"."marts"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    

select
    i.order_id,
    i.customer_id,
    i.order_timestamp,
    i.status,
    i.total_amount,
    i.total_paid,
    i.payment_count,
    i.outstanding_amount,
    case
        when i.outstanding_amount = 0 and i.total_amount > 0 then true
        else false
    end as is_fully_paid
from "dbt_test"."intermediate"."int_order_payments" i
  );
  
[0m22:18:24.839019 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.006 seconds
[0m22:18:24.840617 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m22:18:24.840797 [debug] [Thread-3 (]: On model.dbt_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.fct_orders"} */
alter table "dbt_test"."marts"."fct_orders" rename to "fct_orders__dbt_backup"
[0m22:18:24.841425 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:18:24.842935 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m22:18:24.843109 [debug] [Thread-3 (]: On model.dbt_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.fct_orders"} */
alter table "dbt_test"."marts"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m22:18:24.843737 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:18:24.844387 [debug] [Thread-3 (]: On model.dbt_test.fct_orders: COMMIT
[0m22:18:24.844590 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m22:18:24.844814 [debug] [Thread-3 (]: On model.dbt_test.fct_orders: COMMIT
[0m22:18:24.845683 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:18:24.846686 [debug] [Thread-3 (]: Applying DROP to: "dbt_test"."marts"."fct_orders__dbt_backup"
[0m22:18:24.846942 [debug] [Thread-3 (]: Using postgres connection "model.dbt_test.fct_orders"
[0m22:18:24.847104 [debug] [Thread-3 (]: On model.dbt_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "dbt_test", "target_name": "dev", "node_id": "model.dbt_test.fct_orders"} */
drop table if exists "dbt_test"."marts"."fct_orders__dbt_backup" cascade
[0m22:18:24.848613 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:18:24.849219 [debug] [Thread-3 (]: On model.dbt_test.fct_orders: Close
[0m22:18:24.849483 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db8c65a-8e8a-46ea-8d3e-9faf8701b2f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c362f30>]}
[0m22:18:24.849787 [info ] [Thread-3 (]: 6 of 6 OK created sql table model marts.fct_orders ............................. [[32mSELECT 5[0m in 0.04s]
[0m22:18:24.850046 [debug] [Thread-3 (]: Finished running node model.dbt_test.fct_orders
[0m22:18:24.850653 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:24.850814 [debug] [MainThread]: On master: BEGIN
[0m22:18:24.850949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:18:24.861708 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m22:18:24.861934 [debug] [MainThread]: On master: COMMIT
[0m22:18:24.862094 [debug] [MainThread]: Using postgres connection "master"
[0m22:18:24.862224 [debug] [MainThread]: On master: COMMIT
[0m22:18:24.862649 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:18:24.862791 [debug] [MainThread]: On master: Close
[0m22:18:24.862992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:24.863119 [debug] [MainThread]: Connection 'model.dbt_test.stg_customers' was properly closed.
[0m22:18:24.863241 [debug] [MainThread]: Connection 'model.dbt_test.dim_customers' was properly closed.
[0m22:18:24.863357 [debug] [MainThread]: Connection 'model.dbt_test.fct_orders' was properly closed.
[0m22:18:24.863504 [debug] [MainThread]: Connection 'model.dbt_test.int_order_payments' was properly closed.
[0m22:18:24.863729 [info ] [MainThread]: 
[0m22:18:24.863901 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m22:18:24.864528 [debug] [MainThread]: Command end result
[0m22:18:24.880405 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/adil/repos/airflow-test/dbt_test/target/manifest.json
[0m22:18:24.881531 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/adil/repos/airflow-test/dbt_test/target/semantic_manifest.json
[0m22:18:24.884540 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/adil/repos/airflow-test/dbt_test/target/run_results.json
[0m22:18:24.884707 [info ] [MainThread]: 
[0m22:18:24.884888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:18:24.885032 [info ] [MainThread]: 
[0m22:18:24.885188 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m22:18:24.886886 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.80885077, "process_in_blocks": "0", "process_kernel_time": 0.165936, "process_mem_max_rss": "128909312", "process_out_blocks": "0", "process_user_time": 1.196265}
[0m22:18:24.887131 [debug] [MainThread]: Command `dbt run` succeeded at 22:18:24.887085 after 0.81 seconds
[0m22:18:24.887318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c08e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b41910>]}
[0m22:18:24.887503 [debug] [MainThread]: Flushing usage events
[0m22:18:25.388224 [debug] [MainThread]: An error was encountered while trying to flush usage events
